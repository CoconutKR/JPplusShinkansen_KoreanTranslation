# 1 "JPplusShinkansen.pnml"
/*---HEADER--*/

//Define the GRF
# 1 "src/header.pnml" 1
 grf {
	grfid:					"KR03";
	name:					string(STR_GRF_NAME);
	desc:					string(STR_GRF_DESC);
	version:				6;
	min_compatible_version: 6;
		//japanset3 removal
		param 4 {
			 param_japansetdisable {
					name: string(STR_PARAM_NAME_JAPANSETDISABLE);
					desc: string(STR_PARAM_DESC_JAPANSETDISABLE);
					type: bool;
					bit:  0;
					def_value: 0;
			 }
		}
		//replacement Shinkansen tracks
		param 6 {
			 param_tracks {
					name: string(STR_PARAM_NAME_TRACKS);
					desc: string(STR_PARAM_DESC_TRACKS);
					type: bool;
					bit:  0;
					def_value: 0;
			 }
		}
		//track fences
		param 3 {
			 param_fences {
					name: string(STR_PARAM_NAME_FENCES);
					desc: string(STR_PARAM_DESC_FENCES);
					type: bool;
					bit:  0;
					def_value: 0;
			 }
		}
		//basecosts
		param 0 {
				param_basecostbuy {
						type: int;
						name: string(STR_PARAM_NAME_BASECOSTMODBUY);
						desc: string(STR_PARAM_DESC_BASECOSTMODBUY);
						min_value: 0;
						max_value: 2;
						def_value: 1;
						names: {
												0: string(STR_PARAM_LOW);
												1: string(STR_PARAM_NORMAL);
												2: string(STR_PARAM_HIGH);
						};
				}
		}
		//runningcosts
		param 1 {
				param_basecostrun {
						type: int;
						name: string(STR_PARAM_NAME_BASECOSTMODRUN);
						desc: string(STR_PARAM_DESC_BASECOSTMODRUN);
						min_value: 0;
						max_value: 4;
						def_value: 2;
						names: {
												0: string(STR_PARAM_VLOW);
												1: string(STR_PARAM_LOW);
												2: string(STR_PARAM_NORMAL);
												3: string(STR_PARAM_HIGH);
												4: string(STR_PARAM_VHIGH);
						};
				}
		}
		//pax capacity
		param 2 {
				param_basecapacity {
						type: int;
						name: string(STR_PARAM_NAME_BASECAPACITY);
						desc: string(STR_PARAM_DESC_BASECAPACITY);
						min_value: 0;
						max_value: 2;
						def_value: 1;
						names: {
												0: string(STR_PARAM_REAL);
												1: string(STR_PARAM_LONGADJ);
												2: string(STR_PARAM_DOUBLE);

												//4: string(STR_PARAM_REAL);
						};
				}
		}
		//cargo decay
		param 5 {
			 param_cargodecay {
						type: int;
						name: string(STR_PARAM_NAME_DECAY);
						desc: string(STR_PARAM_DESC_DECAY);
						min_value: 0;
						max_value: 2;
						def_value: 0;
						names: {
												0: string(STR_PARAM_NORMAL);
												1: string(STR_PARAM_LOW);
												2: string(STR_PARAM_VLOW);
				};
			 
		}
		
		
	}
}

// Cargo table - Passengers only
cargotable {
	PASS,
}
# 1 "JPplusShinkansen.pnml" 4

// Templates
# 1 "src/template.pnml" 1
// Begin template

/* Dummy Template */

template template_dummy (x, y) {
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
}

/* Purchase Templates */

template template_purchase (x, y) {
		[]
	 	[]
	 	[]
	 	[]
	 	[]
	 	[]
    	[x, y, 75, 15, -28, -10]
		[]
}

template tmpl_purchase_dh (x, y) {
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
        [x, y, 76, 15, -14, -10]
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
}
template tmpl_purchase_dh_32bpp (x, y) {
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
        [x, y, 75, 15, -14, -10]
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
}

/* EMU Templates */

// STANDARD

template template_12_standard(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y,		8,		36,		-3,			-18]
    [ x+16,		y,		30,		29,		-18,		-19]
    [ x+54,		y,		48,		16,		-24,		-12]
    [ x+110,	y,		30,		29,		-10,		-19]
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+164,	y,		30,		29,		-18,		-19]
    [ x+202,	y,		48,		16,		-24,		-12]
    [ x+258,	y,		30,		29,		-10,		-19]
}

template template_12_reversed(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+164,	y,		30,		29,		-18,		-19]
    [ x+202,	y,		48,		16,		-24,		-12]
    [ x+258,	y,		30,		29,		-10,		-19]
    [ x,		y,		8,		36,		-3,			-18]
    [ x+16,		y,		30,		29,		-18,		-19]
    [ x+54,		y,		48,		16,		-24,		-12]
    [ x+110,	y,		30,		29,		-10,		-19]
}

template template_8_standard(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y,		8,		36,		-3,			-18]
    [ x+20,		y,		22,		27,		-15,		-19]
    [ x+62,		y,		32,		16,		-16,		-12]
    [ x+114,	y,		22,		27,		-08,		-20]
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+168,	y,		22,		27,		-15,		-19]
    [ x+210,	y,		32,		16,		-16,		-12]
    [ x+262,	y,		22,		27,		-08,		-20]
}

template template_8_reversed(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+168,	y,		22,		27,		-15,		-19]
    [ x+210,	y,		32,		16,		-16,		-12]
    [ x+262,	y,		22,		27,		-08,		-20]
    [ x,		y,		8,		36,		-3,			-18]
    [ x+20,		y,		22,		27,		-15,		-19]
    [ x+62,		y,		32,		16,		-16,		-12]
    [ x+114,	y,		22,		27,		-08,		-20]
}

/* TRACKS */

// Overlay
template japan_rails_overlay() {
    //left_x, upper_y, width, height, offset_x, offset_y
    [   0,    200,       40,    21,     -19,         5]
    [  48,    200,       40,    21,     -19,         5]
    [  96,    200,       40,     7,     -19,         4]
    [ 144,    200,       40,     7,     -19,        20]
    [ 192,    200,       12,    19,      11,         6]
    [ 224,    200,       12,    19,     -21,         6]
	//Slopes
    [ 256,    200,       64,    39,     -31,        -8]
    [ 336,    200,       64,    23,     -31,         0]
	[ 416,    200,       64,    23,     -31,         0]
    [ 496,    200,       64,    39,     -31,        -8]
}

// Underlay
template japan_rails_underlay() {
    //left_x, upper_y, width, height, offset_x, offset_y
    [   0,    300,       64,    31,     -31,         0]
    [  80,    300,       64,    31,     -31,         0]
    [ 160,    300,       64,    31,     -31,         0]
    [ 240,    300,       64,    31,     -31,         0]
    [ 320,    300,       64,    31,     -31,         0]
    [ 400,    300,       64,    31,     -31,         0]
	//Slopes
    [ 0,      400,       64,    39,     -31,        -8]
    [ 80,     400,       64,    23,     -31,         0]
	[ 160,    400,       64,    23,     -31,         0]
    [ 240,    400,       64,    39,     -31,        -8]
	//Crossings
	[ 320,   400,       64,    31,     -31,         0]
	[   0,   500,       64,    31,     -31,         0]
    [  80,   500,       64,    31,     -31,         0]
    [ 160,   500,       64,    31,     -31,         0]
    [ 240,   500,       64,    31,     -31,         0]
    [ 320,   500,       64,    31,     -31,         0]
}

// Depots
template japan_rails_depot() {
	//left_x, upper_y, width, height, offset_x, offset_y
	[  0,  0, 16, 11,  17,   4]
	[ 32,  0, 64, 45,  -9, -29]
	[112,  0, 16, 11, -31,   4]
	[144,  0, 64, 45, -53, -29]
	[224,  0, 64, 45, -53, -29]
	[304,  0, 64, 45,  -9, -29]
}

template japan_rails_depot_snow() {
	//left_x, upper_y, width, height, offset_x, offset_y
	[  0,  100, 16, 11,  17,   4, WHITE]
	[ 32,  100, 64, 45,  -9, -29, WHITE]
	[112,  100, 16, 11, -31,   4, WHITE]
	[144,  100, 64, 45, -53, -29, WHITE]
	[224,  100, 64, 45, -53, -29, WHITE]
	[304,  100, 64, 45,  -9, -29, WHITE]
}

// Bridges
template japan_rails_bridge() {
	//left_x, upper_y, width, height, offset_x, offset_y
	[   0,    700,       64,    31,       -31,        0]
	[  80,    700,       64,    31,       -31,        0]
	//Slopes
	[ 160,    700,       64,    39,       -31,       -8]
	[ 240,    700,       64,    23,       -31,        0]
	[ 320,    700,       64,    23,       -31,        0]
	[ 400,    700,       64,    39,       -31,       -8]
}

//Tunnel
template japan_rails_tunnel() {
	//left_x, upper_y, width, height, offset_x, offset_y
    [   0,    600,       64,    39,       -31,        -8]
    [  80,    600,       64,    23,       -31,        -8]
    [  160,   600,       64,    23,       -31,        -8]
    [  240,   600,       64,    39,       -31,        -8]
}

template japan_rails_tunnel_overlay() {
	//left_x, upper_y, width, height, offset_x, offset_y
    [ 320, 		600,       64,    39,       -31,        -38]
    [ 400,    	600,       64,    31,       -31,        -38]
    [ 480,   	600,       64,    31,       -31,        -38]
    [ 560,   	600,       64,    39,       -31,        -38]
}

// Catenary Poles
template japan_rails_pylons_brown() {
	[      0,       100,     10,     19,       -8, 	 -19]
	[     16,       100,     9,     21,        0, 		 -21]
	[     32,       100,     10,     19,        0, 	 -19]
	[     48,       100,     9,     21,       -7, 		 -21]
	[     64,       100,     3,      18,        0,  	 -19]
	[     80,       100,     3,      21,        0,  	 -21]
	[     96,       100,     10,     19, 	     -2,  	 -17]
	[    112,       100,     10,     19,       -7, 		 -15]
}

template japan_rails_pylons_blue() {
	[      0,       0,      10,     19,       -8, 	 -19]
	[     16,       0,      9,     21,        0, 		 -21]
	[     32,       0,      10,     19,        0, 	 -19]
	[     48,       0,      9,     21,       -7, 		 -21]
	[     64,       0,      3,      18,        0,  	 -19]
	[     80,       0,      3,      21,        0,  	 -21]
	[     96,       0,      10,     19, 	     -2,  	 -17]
	[    112,       0,      10,     19,       -7, 		 -15]
}

// Catenary Wires
template japan_rails_wires() {
	[0,		0,  	32, 20, -29, -6]
	[48,	0,  	32, 20,  -1, -6]
	[96,	0,  	32,  5,  -1, -6]
	[144,	0,  	1,  20,   0, -7]
	[160,	0,  	32, 28, -29, -6]
	[208,	0,  	32, 13,  -1,  2]
	[256,	0,  	32, 13, -29,  2]
	[304,	0,  	32, 28,  -1, -6]
	[352,	0, 		32, 19, -29, -5]
	[400,	0, 		32, 19,  -1, -5]
	[448,	0, 		32,  5,  -1, -6]
	[496,	0, 		1,  20,   0, -7]
	[512,	0, 		32, 27, -29, -5]
	[560,	0, 		32, 12,  -1,  3]
	[608,	0, 		32, 12, -29,  3]
	[656,	0, 		32, 27,  -1, -5]
	[704,	0, 		32, 20, -29, -6]
	[0, 	50, 	32,	20,  -1, -6]
	[48, 	50, 	32,  5,  -1, -6]
	[96, 	50, 	1,  20,   0, -7]
	[112, 	50, 	32, 28, -29, -6]
	[160, 	50, 	32, 13,  -1,  2]
	[208, 	50, 	32,	13, -29,  2]
	[256, 	50, 	32, 28,  -1, -6]
	[304, 	50, 	16, 11, -29,  3]
	[336, 	50, 	16, 12,  -1, -6]
	[368, 	50, 	16, 12, -13, -6]
	[400, 	50, 	16, 11,  15,  3]
}

// Fences

template japan_rails_fences() {
	[0,		0, 		33, 22,	-31, -6]
	[48,	0, 		33, 22,	0, -6]
	[96,	0, 		2,  38,	0, 	-22]
	[112,	0, 		65,  6,	-31, -6]
	[192,	0, 		33, 14,	-31, -6]
	[240, 	0, 		33, 14,	0, 	-6]
	[288,	0, 		33, 30,	-31, -14]
	[336, 	0, 		33, 30,	0, -14]
}

template japan_rails_fences_empty() {
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
	[1, 1, 1, 1, 0, 0]
}

// GUI

template japan_rails_gui_ttd() {
	[0,		0, 		20, 20,	0, 	0]
	[32,	0, 		20, 20,	0, 	0]
	[64,	0, 		20, 20,	0, 	0]
	[96,	0, 		20, 20,	0, 	0]
	[128,	0, 		20, 20,	0, 	0]
	[160, 	0, 		20, 20,	0, 	0]
	[192, 	0, 		20, 20,	0, 	0]
	[224, 	0, 		20, 20,	0, 	0]
	[256, 	0, 		38, 30, -4, 15]
	[304, 	0, 		72, 44, -16,-8]
	[384, 	0, 		44,	34, -21, -2]
	[448, 	0, 		72, 44, -16, -36]
	[528, 	0, 		56, 43, 0,  0]
	[592, 	0, 		32, 32, 0,  0]
	[640, 	0, 		32, 32, 0,  0]
	[688, 	0, 		32, 32, 0,  0]
}

template japan_rails_gui_gfx() {
	[0,		0, 		20, 20,	0, 	0]
	[32,	0, 		20, 20,	0, 	0]
	[64,	0, 		20, 20,	0, 	0]
	[96,	0, 		20, 20,	0, 	0]
	[128,	0, 		20, 20,	0, 	0]
	[160, 	0, 		20, 20,	0, 	0]
	[192, 	0, 		20, 20,	0, 	0]
	[224, 	0, 		20, 20,	0, 	0]
	[256, 	0, 		20, 29, 0,  0]
	[304, 	0, 		26, 28, 0,  0]
	[384, 	0, 		27,	26, 0,  0]
	[448, 	0, 		26, 28, 0,  0]
	[528, 	0, 		26, 28, 0,  0]
	[592, 	0, 		32, 32, 0,  0]
	[640, 	0, 		27, 30, 0,  0]
	[688, 	0, 		29, 28, 0,  0]
}

// End template
# 1 "JPplusShinkansen.pnml" 4

//Helpers
# 1 "src/basecosts.pnml" 1
basecost {
		 PR_BUILD_VEHICLE : param_basecostbuy -1;
		 PR_BUILD_VEHICLE_WAGON: param_basecostbuy +3;
		 PR_RUNNING: param_basecostrun +1; //3
}
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/tracks.pnml" 1
// Begin Tracks

// Shinkansen Tracks

// Overlay
spriteset(ss_norm_overlay_shin_01,	"src/gfx/tracks/shin_01.png") {japan_rails_overlay()}
spriteset(ss_snow_overlay_shin_01,	"src/gfx/tracks/shin_01_snow.png") {japan_rails_overlay()}
spriteset(ss_norm_overlay_shin_02,	"src/gfx/tracks/shin_02.png") {japan_rails_overlay()}
spriteset(ss_snow_overlay_shin_02,	"src/gfx/tracks/shin_02_snow.png") {japan_rails_overlay()}

switch(FEAT_RAILTYPES, SELF, sw_overlay_shin_01, terrain_type) {
	TILETYPE_SNOW: ss_snow_overlay_shin_01;
	ss_norm_overlay_shin_01;
}

switch(FEAT_RAILTYPES, SELF, sw_overlay_shin_02, terrain_type) {
	TILETYPE_SNOW: ss_snow_overlay_shin_02;
	ss_norm_overlay_shin_02;
}

// Underlay
spriteset(ss_norm_underlay_shin_01,	"src/gfx/tracks/shin_01.png") {japan_rails_underlay()}
spriteset(ss_snow_underlay_shin_01,	"src/gfx/tracks/shin_01_snow.png") {japan_rails_underlay()}
spriteset(ss_norm_underlay_shin_02,	"src/gfx/tracks/shin_02.png") {japan_rails_underlay()}
spriteset(ss_snow_underlay_shin_02,	"src/gfx/tracks/shin_02_snow.png") {japan_rails_underlay()}

switch(FEAT_RAILTYPES, SELF, sw_underlay_shin_01, terrain_type) {
	TILETYPE_SNOW: ss_snow_underlay_shin_01;
	ss_norm_underlay_shin_01;
}

switch(FEAT_RAILTYPES, SELF, sw_underlay_shin_02, terrain_type) {
	TILETYPE_SNOW: ss_snow_underlay_shin_02;
	ss_norm_underlay_shin_02;
}


// Depot
spriteset(ss_depot_shin_01_norm, 	"src/gfx/tracks/depots_shin_01.png") {japan_rails_depot()}	
spriteset(ss_depot_shin_01_snow, 	"src/gfx/tracks/depots_shin_01.png") {japan_rails_depot_snow()}	
spriteset(ss_depot_shin_02_norm, 	"src/gfx/tracks/depots_shin_02.png") {japan_rails_depot()}
spriteset(ss_depot_shin_02_snow, 	"src/gfx/tracks/depots_shin_02.png") {japan_rails_depot_snow()}		

switch(FEAT_RAILTYPES, SELF, sw_depot_shin_01, terrain_type) {
	TILETYPE_SNOW: ss_depot_shin_01_snow;
	ss_depot_shin_01_norm;
}

switch(FEAT_RAILTYPES, SELF, sw_depot_shin_02, terrain_type) {
	TILETYPE_SNOW: ss_depot_shin_02_snow;
	ss_depot_shin_02_norm;
}

// Bridges
spriteset(ss_norm_bridge_shin_01,	"src/gfx/tracks/shin_01.png") {japan_rails_bridge()}
spriteset(ss_norm_bridge_shin_02,	"src/gfx/tracks/shin_02.png") {japan_rails_bridge()}

// Tunnels
spriteset(ss_shin_norm_tunnel,	"src/gfx/tracks/shin_01.png") {japan_rails_tunnel()}
spriteset(ss_shin_snow_tunnel,	"src/gfx/tracks/shin_01_snow.png") {japan_rails_tunnel()}
spriteset(ss_shin_norm_tunnel_overlay,	"src/gfx/tracks/shin_01.png") {japan_rails_tunnel_overlay()}
spriteset(ss_shin_snow_tunnel_overlay,	"src/gfx/tracks/shin_01_snow.png") {japan_rails_tunnel_overlay()}

switch(FEAT_RAILTYPES, SELF, sw_tunnel, terrain_type) {
	TILETYPE_SNOW: ss_shin_snow_tunnel;
	ss_shin_norm_tunnel;
}

switch(FEAT_RAILTYPES, SELF, sw_tunnel_overlay, terrain_type) {
	TILETYPE_SNOW: ss_shin_snow_tunnel_overlay;
	ss_shin_norm_tunnel_overlay;
}

// Catenary
spriteset(ss_wires, 				"src/gfx/tracks/catwire.png") {japan_rails_wires()}
spriteset(ss_poles, 				"src/gfx/tracks/catpoles.png") {japan_rails_pylons_blue()}	

// Fences
spriteset(ss_fences, 				"src/gfx/tracks/fences.png") {japan_rails_fences()}
spriteset(ss_fences_empty, 			"src/gfx/tracks/fences.png") {japan_rails_fences_empty()}

switch(FEAT_RAILTYPES, SELF, sw_fences, param_fences) {
    0: ss_fences;
	1: ss_fences_empty;
}

// GUI
spriteset(ss_shin_01_gui_ttd,	"src/gfx/tracks/shin_01.png") {japan_rails_gui_ttd()}
spriteset(ss_shin_02_gui_ttd,	"src/gfx/tracks/shin_02.png") {japan_rails_gui_ttd()}

if (param_japansetdisable == 1 && param_tracks == 1 ){

/*
    item(FEAT_RAILTYPES) {
    property {
        label: "SAEE";
        compatible_railtype_list: ["DABN", "DABE", "ELRL", "SUBE", "SACE", "SAEE", "SBEE", "SAB3", "SUB3", "RAIL", "SAAN"];
        powered_railtype_list:    ["DABE", "ELRL", "SUBE", "SACE", "SAEE", "SBEE"];                 

    }
}

    item(FEAT_RAILTYPES) {
    property {
        label: "SBEE";
        compatible_railtype_list: ["DABN", "DABE", "ELRL", "SUBE", "SACE", "SAEE", "SBEE", "SAB3", "SUB3", "RAIL", "SAAN"];
        powered_railtype_list:    ["DABE", "ELRL", "SUBE", "SACE", "SAEE", "SBEE"];       
        speed_limit: 0 km/h;

    }
}
*/
item(FEAT_RAILTYPES) {
    property {
        label: "ELRL";
        compatible_railtype_list: ["HSSN", "MDSN", "DABN", "DABE", "RAIL", "ELRL", "SACE", "SAEE", "SBEE", "SUBE", "SAB3", "SUB3", "SAAN"];
        powered_railtype_list:    ["HSSN", "MDSN", "DABE", "ELRL", "SACE", "SAEE", "SBEE", "SUBE"]; 

    }
}

item(FEAT_RAILTYPES) {
    property {
        label:                      "HSSN";								
        name:                       string(STR_NAME_HSSN);
        menu_text:                  string(STR_MENU_HSSN);
        build_window_caption:       string(STR_CAPT_HSSN);
		toolbar_caption:			string(STR_TOOL_HSSN);
        autoreplace_text:           string(STR_AUTO_HSSN);
        new_engine_text:            string(STR_NEWE_HSSN);
        compatible_railtype_list: 	["HSSN", "MDSN", "SAEE", "SBEE", "SAAE", "SABN", "RAIL", "SBCN", "SADN", "SBCE", "SADE", "ELRL", "SAC3", "SACZ", "SUCE", "SUC3"];
		powered_railtype_list:    	["HSSN", "MDSN", "SAEE", "SBEE", "SAAE", "SBCE", "SADE", "ELRL", "SACZ", "SUCE"];       
		speed_limit: 				241 km/h;
		railtype_flags: 			bitmask(RAILTYPE_FLAG_CATENARY,RAILTYPE_FLAG_NO_LEVEL_CROSSING,RAILTYPE_FLAG_DISALLOW_90DEG);
		introduction_date: 			date(1964,1,1);
		construction_cost: 			750;
		maintenance_cost:  			60;

    }
	graphics {
		track_overlay: 				sw_overlay_shin_01;
		underlay:					sw_underlay_shin_01;
		tunnels:					sw_tunnel;
		tunnel_overlay:				sw_tunnel_overlay;
		bridge_surfaces: 			ss_norm_bridge_shin_01;
		depots:						sw_depot_shin_01;
		//level_crossings:  		switch_dg_crossing; 			// No Level Crossing Allowed  
		fences:						sw_fences;
		gui:						ss_shin_01_gui_ttd;
		catenary_wire:				ss_wires;
		catenary_pylons:			ss_poles;
	}
}

item(FEAT_RAILTYPES) {
    property {
        label:                      "MDSN";								
        name:                       string(STR_NAME_MDSN);
        menu_text:                  string(STR_MENU_MDSN);
        build_window_caption:       string(STR_CAPT_MDSN);
		toolbar_caption:			string(STR_TOOL_MDSN);
        autoreplace_text:           string(STR_AUTO_MDSN);
        new_engine_text:            string(STR_NEWE_MDSN);
        compatible_railtype_list: 	["HSSN", "MDSN", "SAEE", "SBEE", "SAAE", "SABN", "RAIL", "SBCN", "SADN", "SBCE", "SADE", "ELRL", "SAC3", "SACZ", "SUCE", "SUC3"];
		powered_railtype_list:    	["HSSN", "MDSN", "SAEE", "SBEE", "SAAE", "SBCE", "SADE", "ELRL", "SACZ", "SUCE"];       
		speed_limit: 				0 km/h;
		railtype_flags: 			bitmask(RAILTYPE_FLAG_CATENARY,RAILTYPE_FLAG_NO_LEVEL_CROSSING,RAILTYPE_FLAG_DISALLOW_90DEG);
		introduction_date: 			date(1990,1,1);
		construction_cost: 			1250;
		maintenance_cost:  			100;

    }
	graphics {
		track_overlay: 				sw_overlay_shin_02;
		underlay:					sw_underlay_shin_02;
		tunnels:					sw_tunnel;
		tunnel_overlay:				sw_tunnel_overlay;
		bridge_surfaces: 			ss_norm_bridge_shin_02;
		depots:						sw_depot_shin_02;
		//level_crossings:  		switch_dg_crossing; 			// No Level Crossing Allowed  
		fences:						sw_fences;
		gui:						ss_shin_02_gui_ttd;
		catenary_wire:				ss_wires;
		catenary_pylons:			ss_poles;
	}
}

}
// End Tracks
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/railtypetable.pnml" 1
// Begin railtypetable

// https://newgrf-specs.tt-wiki.net/wiki/TracktypeLabels
/*
railtypetable {
	RAIL,
	ELRL,
	SHINKANSEN: [
		SADE, 		// JapanSet Tracks - International Mode - Highspeed line
		SAEE, 		// JapanSet Tracks - Japanese Mode - Shinkansen highspeed
		SBEE, 		// JapanSet Tracks - Japanese Mode - Modern Shinkansen highspeed
		SUBE,		// JapanSet Tracks - Japanese Mode - Urban Standard Guage (Electrified)
		SDAE, 		// U&ReRMM 2 - High-Speed Line
		SEAE,		// U&ReRMM 2 - Modern High-Speed Line
		SFAE,		// U&ReRMM 2 - Very High-Speed Line
		SHAE,		// SUKTS - Very High Speed
		ELRL],		// Backup	
		
	MINI_SHINKANSEN: [
		SACE,		// JapanSet Tracks - Modern Standard Guage (Electrified)
		SADE, 		// JapanSet Tracks - International Mode - Highspeed line
		SAEE, 		// JapanSet Tracks - Japanese Mode - Shinkansen highspeed
		SBEE, 		// JapanSet Tracks - Japanese Mode - Modern Shinkansen highspeed
		SUBE,		// JapanSet Tracks - Japanese Mode - Urban Standard Guage (Electrified)
		SDAE, 		// U&ReRMM 2 - High-Speed Line
		SEAE,		// U&ReRMM 2 - Modern High-Speed Line
		SFAE,		// U&ReRMM 2 - Very High-Speed Line
		SHAE,		// SUKTS - Very High Speed
		ELRL],		// Backup		
}
*/

railtypetable {
	RAIL,
	ELRL,
	SHINKANSEN: [SAAE, ELRL],
	MINI_SHINKANSEN: [SAAE, ELRL],
}

// End railtypetable
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/functions.pnml" 1
/* Begin Functions */

switch (FEAT_TRAINS, PARENT, func_is_reversed, vehicle_is_reversed) {return;}

switch (FEAT_TRAINS, SELF, sw_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

/* Which IDs can attach */
switch(FEAT_TRAINS, SELF, sw_full_jreast_attach_vehid, [
    vehicle_type_id == series_200 ||
    vehicle_type_id == series_e1 || 
    vehicle_type_id == series_e2 || 
    vehicle_type_id == series_e4 ||
    vehicle_type_id == series_e5 ||
    vehicle_type_id == series_e7
    ]) {0: return string(JR_EAST_ONLY_FULL);}

switch(FEAT_TRAINS, SELF, sw_full_notjreast_attach_vehid, [
    vehicle_type_id == series_0 || 
    vehicle_type_id == series_100 || 
    vehicle_type_id == series_300 ||
    vehicle_type_id == series_500 ||
    vehicle_type_id == series_700 ||
    vehicle_type_id == series_n700 ||
    vehicle_type_id == series_n700_kyushu
    ]) {0: return string(NON_JR_EAST_ONLY_FULL);}

/*	CARGO DECAY	*/
if (param_cargodecay == 0) {
	param_decay_express = 256;
}
if (param_cargodecay == 1) {
	param_decay_express = 384;
}
if (param_cargodecay >= 2) {
	param_decay_express = 512;
}

/*	LOADING SPEEDS	*/
if (param_basecapacity == 0) {
	param_loading_1D = 8;       // 1 door //
	param_loading_2D = 4;      // 2 doors //
}
if (param_basecapacity == 1) {
	param_loading_1D = 8;       // 1 door //
	param_loading_2D = 4;      // 2 doors //
}
if (param_basecapacity == 2) {
	param_loading_1D = 8;       // 1 door //
	param_loading_2D = 4;      // 2 doors //
}

/* LENGTHS */

// Standard 2-8-2 Length
    switch (FEAT_TRAINS, SELF, sw_length_2_8_2, position_in_articulated_veh % 3) {
        1: return 8;
        return 2;
    }

// 1-1-8-2
    switch(FEAT_TRAINS, SELF, sw_length_1_1_8_2, position_in_articulated_veh % 4) {
        2: return 8;
        3: return 2;
        return 1;
    }

// 1-1-7-1-1-1
    switch(FEAT_TRAINS, SELF, sw_length_1_1_7_1_1_1, position_in_articulated_veh % 6 ) {
        2: return 7;
        return 1;
    }

// 1-1-8-1-1
    switch(FEAT_TRAINS, SELF, sw_length_1_1_8_1_1, position_in_articulated_veh %5 ) {
        2: return 8;
        return 1;
    }

/* End Functions */ 
# 1 "JPplusShinkansen.pnml" 4

//IDs
# 1 "src/vehicleid.pnml" 1

// Assign IDs
item(FEAT_TRAINS, mu_car_ms, 1111) {}
item(FEAT_TRAINS, series_0, 123) {}
item(FEAT_TRAINS, series_100, 124) {}
item(FEAT_TRAINS, series_200, 200) {}
item(FEAT_TRAINS, series_300, 300) {}
item(FEAT_TRAINS, series_400, 400) {}
item(FEAT_TRAINS, series_500, 500) {}
item(FEAT_TRAINS, series_700, 700) {}
item(FEAT_TRAINS, series_n700, 777) {}
item(FEAT_TRAINS, series_n700_kyushu, 778) {}
item(FEAT_TRAINS, series_800, 800) {}
item(FEAT_TRAINS, series_e1, 1551) {}
item(FEAT_TRAINS, series_e2, 1552) {}
item(FEAT_TRAINS, series_e3, 2003) {}
item(FEAT_TRAINS, series_e4, 2004) {} 
item(FEAT_TRAINS, series_e5, 2005) {} 
item(FEAT_TRAINS, series_e6, 2006) {}
item(FEAT_TRAINS, series_e5e6, 2056) {}
item(FEAT_TRAINS, series_e7, 2007) {}
item(FEAT_TRAINS, series_e8, 2008) {}

// Sort the Order in the Purchase Menu below
sort(FEAT_TRAINS, [

/* Not JR East */
123,      // 0 Series Shinkansen
124,    // 100 Series Shinkansen
300,    // 300 Series Shinkansen
500,    // 500 Series Shinkansen
700,    // 700 Series Shinkansen
777,    // N700 Series Shinkansen
778,    // N700 Series Shinkansen - Kyushu
800,    // 800 Series Shinkansen

/* JR East */
200,    // 200 Series Shinkansen
400,    // 400 Series Shinkansen
1551,     // E1 Series Shinkansen (Max)
1552,     // E2 Series Shinkansen
2003,   // E3 Series Shinkansen
2004,   // E4 Series Shinkansen (Max)
2005,   // E5 Series Shinkansen
2006,   // E6 Series Shinkansen
2056,   // E5 & E6 Series Shinkansen
2007,   // E7/W7 Series Shinkansen
2008,   // E8 Series Shinkansen

/*MU Cars*/
mu_car_ms,
]);
# 1 "JPplusShinkansen.pnml" 4

// Dummy
# 1 "src/dummy.pnml" 1
 // begin dummy

 // https://www.tt-forums.net/viewtopic.php?f=68&t=53511

spriteset (dummy_sprites, "src/gfx/dummy/empty.png")
{
  [0, 0, 2, 2, 0, 0, CROP]
}

 // end dummy
# 1 "JPplusShinkansen.pnml" 4
// Mucar
# 1 "src/mucar.pnml" 1
// Begin mucar

/*---GFX: Spritesets---*/
spriteset (set_mu_car_purchase,	    "src/gfx/dummy/mucarbuy.png") 	{template_purchase (0, 0)}
spriteset (set_mu_car_base,       	"src/gfx/dummy/mucar.png")     	{template_8_standard(1,1)}


item(FEAT_TRAINS, mu_car_ms) {
    /* Define properties first, make sure to set all of them */
    property {
        name:                         string(MUCAR);
        introduction_date:            date(1800,1,1);
        climates_available:           ALL_CLIMATES;
        model_life:                   VEHICLE_NEVER_EXPIRES;
        vehicle_life:                 60;
        loading_speed:                0;
        cost_factor:                  189;
        running_cost_factor:          6;
        speed:                        0 km/h;
        power:                        0 hp;
        cargo_capacity:               1;
        weight:                       0 ton;
        tractive_effort_coefficient:  0.3;
        air_drag_coefficient:         0;
        reliability_decay:            20;
        refittable_cargo_classes:     bitmask(CC_PASSENGERS);
        cargo_age_period:             185;
        refit_cost:                   0;
        track_type:                   MINI_SHINKANSEN;
        ai_special_flag:              AI_FLAG_PASSENGER;
        running_cost_base:            RUNNING_COST_DIESEL;
        engine_class:                 ENGINE_CLASS_STEAM;
        visual_effect_and_powered:    visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
        sprite_id:                    SPRITE_ID_NEW_TRAIN;
        dual_headed:                  0;
        length:                       8;
        extra_power_per_wagon:        0;
        bitmask_vehicle_info:         0;
    }
    /* Define graphics and callbacks
     * Setting all callbacks is not needed, only define what is used */
    graphics {
		  purchase:                     set_mu_car_purchase;
      additional_text:			        return string(MUCAR_DESC);
      set_mu_car_base;
    }

}

// End mucar
# 1 "JPplusShinkansen.pnml" 4

//Final Settings
# 1 "src/grfintegration.pnml" 1
// Begin grfintegration

//set depot vehicle width to 32px to avoid overlap
train_width_32_px = 1;
//align train properly in depot window
traininfo_y_offset = 2;

// TTD check //
if (ttd_platform != PLATFORM_OPENTTD || openttd_version < version_openttd(1, 2, 0, 22723)) {
	error(FATAL, REQUIRES_OPENTTD, string(GRF_OTTDVER));
}

// 8bpp //
if (ttd_platform != PLATFORM_OPENTTD || openttd_version < version_openttd(1, 2, 0, 22723)) {
	error(FATAL, string(GRF_OTTDVER));
}

// Warn if "JapanSet3: Trains isn't optimal" //
/*
if (((grf_current_status("SZ\0D\00") == 0) && (grf_current_status("DP\30\00") == 0)) || ((grf_future_status("SZ\0D\00") == 0) && (grf_future_status("DP\30\00") == 0)) || ((grf_order_behind("SZ\0D\00") == 0) && (grf_order_behind("DP\30\00") == 0))) {
	error( WARNING, string(GRF_JAPANSET));
}

if (grf_order_behind("BS\42\13") == 0) {
	error(FATAL, string(GRF_JPPLUSSET));
}

if (((grf_order_behind("EN\21\01") == 0) && (grf_order_behind("BS\07\20") != 0)) || ((grf_future_status("EN\21\01") == 0) && (grf_future_status("BS\07\20") == 0)) || ((grf_current_status("EN\21\01") != 0) && (grf_current_status("BS\07\20") == 0))) {
	error(WARNING, string(GRF_NATSSET));
}

if (grf_order_behind("SZ\0D\00") == 0) {
	error(WARNING, string(GRF_JAPANSETTRAINS));
}

if (grf_order_behind("JD\A1\E1") == 0) {
	error(WARNING, string(GRF_JAPANSECRETORDER));
}
*/
// End grfintegration
# 1 "JPplusShinkansen.pnml" 4

/*---NON-JR EAST TRAINS---*/
# 1 "src/trains/0_series/0_series_fixed.pnml" 1
/* Begin 0 Series */

# 1 "src/trains/0_series/0_series_subtypes.pnml" 1
/* 0 Series CARGO SUBTYPE MENU */

    // From 2002 onwards - introduction of Kodama Livery
    switch(FEAT_TRAINS, SELF, sw_0_series_2002_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
	    1: return string(LV_0_SERIES_ORIGINAL_16CAR);
        2: return string(LV_0_SERIES_NOSE_12CAR);
        3: return string(LV_0_SERIES_ORIGINAL_08CAR);
        4: return string(LV_0_SERIES_KODAMA_16CAR);
        5: return string(LV_0_SERIES_KODAMA_08CAR);
        return CB_RESULT_NO_TEXT;
        }
    
    // From 1964 to 2002
    switch(FEAT_TRAINS, SELF, sw_0_series_1964_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
	    1: return string(LV_0_SERIES_ORIGINAL_16CAR);
        2: return string(LV_0_SERIES_NOSE_12CAR);
        3: return string(LV_0_SERIES_ORIGINAL_08CAR);
        return CB_RESULT_NO_TEXT;
        }

    // Cargo Subtype List
    switch(FEAT_TRAINS, SELF, sw_0_series_year_dep_subtype_text, current_year) {
        0..2001: sw_0_series_1964_subtype_text;
        sw_0_series_2002_subtype_text;
    }
# 1 "src/trains/0_series/0_series_fixed.pnml" 3
# 1 "src/trains/0_series/0_series_gfx.pnml" 1
/* Begin 0 Series Graphics*/

    /* Purchase Menu */
    spriteset (ss_0_series_buy_original_livery,	        	        "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
    spriteset (ss_0_series_buy_kodama_livery,	        	        "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
    spriteset (ss_0_series_buy_original_1987,	        	        "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

    alternative_sprites(ss_0_series_buy_original_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/purchase_original.png") {template_purchase(0, 0)}
    alternative_sprites(ss_0_series_buy_kodama_livery,     	        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/purchase_kodama.png") {template_purchase(0, 0)}
    alternative_sprites(ss_0_series_buy_original_1987,              ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/purchase_original_v2.png") {template_purchase(0, 0)}

    /* EMU Parts */

    /* "CAB" */
    spriteset(ss_0_series_cab_original_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_cab_rev_original_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_cab_kodama_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_cab_rev_kodama_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_cab_nose_livery,             		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_cab_rev_nose_livery,    		            "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 0 Series Original Strip Livery
    alternative_sprites(ss_0_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_standard(1,1)}
    alternative_sprites(ss_0_series_cab_rev_original_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_reversed(1,41)}		

    // 0 Series Kodama Strip Livery
    alternative_sprites(ss_0_series_cab_kodama_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_standard(1,1)}
    alternative_sprites(ss_0_series_cab_rev_kodama_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_reversed(1,41)}	

    // 0 Series Nose Livery
    alternative_sprites(ss_0_series_cab_nose_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_standard(1,1)}
    alternative_sprites(ss_0_series_cab_rev_nose_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_reversed(1,41)}

    /* COACH */
    spriteset(ss_0_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_coach_kodama_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_coach_rev_kodama_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_coach_nose_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_coach_rev_nose_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 0 Series Original Strip Livery
    alternative_sprites(ss_0_series_coach_original_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_standard(1,121)}
    alternative_sprites(ss_0_series_coach_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_reversed(1,121)}

    // 0 Series Kodama Strip Livery
    alternative_sprites(ss_0_series_coach_kodama_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_standard(1,121)}
    alternative_sprites(ss_0_series_coach_rev_kodama_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_reversed(1,121)}	

    // 0 Series Nose Livery
    alternative_sprites(ss_0_series_coach_nose_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_standard(1,121)}
    alternative_sprites(ss_0_series_coach_rev_nose_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_reversed(1,121)}

    // PANTO COACH
    spriteset(ss_0_series_panto_original_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_panto_rev_original_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_panto_kodama_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_panto_rev_kodama_livery, 		            "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_panto_nose_livery,          		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_0_series_panto_rev_nose_livery, 		            "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 0 Series Original Strip Livery
    alternative_sprites(ss_0_series_panto_original_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_standard(1,81)}
    alternative_sprites(ss_0_series_panto_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_reversed(1,81)}	

    // 0 Series Kodama Strip Livery
    alternative_sprites(ss_0_series_panto_kodama_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_standard(1,81)}
    alternative_sprites(ss_0_series_panto_rev_kodama_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_reversed(1,81)}	

    // 0 Series Nose Livery
    alternative_sprites(ss_0_series_panto_nose_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_standard(1,81)}
    alternative_sprites(ss_0_series_panto_rev_nose_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_reversed(1,81)}	

/* End 0 series Graphics */
# 1 "src/trains/0_series/0_series_fixed.pnml" 3
# 1 "src/trains/0_series/0_series_liveries.pnml" 1
/* 0 Series LIVERIES */

    // CAB

    switch(FEAT_TRAINS, SELF, sw_0_series_cab_year_dep_livery, build_year) {
        0..2001: ss_0_series_cab_original_livery;
        2002..9999: ss_0_series_cab_kodama_livery;
        ss_0_series_cab_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_cab, cargo_subtype) {
        1: ss_0_series_cab_original_livery;
        2: ss_0_series_cab_nose_livery;
        3: ss_0_series_cab_original_livery;
        4: ss_0_series_cab_kodama_livery;
        5: ss_0_series_cab_kodama_livery;
        sw_0_series_cab_year_dep_livery;
    }

    // CAB REVERSED

    switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev_year_dep_livery, build_year) {
        0..2001: ss_0_series_cab_rev_original_livery;
        2002..9999: ss_0_series_cab_rev_kodama_livery;
        ss_0_series_cab_rev_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev, cargo_subtype) {
        1: ss_0_series_cab_rev_original_livery;
        2: ss_0_series_cab_rev_nose_livery;
        3: ss_0_series_cab_rev_original_livery;
        4: ss_0_series_cab_rev_kodama_livery;
        5: ss_0_series_cab_rev_kodama_livery;
        sw_0_series_cab_rev_year_dep_livery;
    }

    // COACH

    switch(FEAT_TRAINS, SELF, sw_0_series_coach_year_dep_livery, build_year) {
        0..2001: ss_0_series_coach_original_livery;
        2002..9999: ss_0_series_coach_kodama_livery;
        ss_0_series_coach_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_coach, cargo_subtype) {
        1: ss_0_series_coach_original_livery;
        2: ss_0_series_coach_nose_livery;
        3: ss_0_series_coach_original_livery;
        4: ss_0_series_coach_kodama_livery;
        5: ss_0_series_coach_kodama_livery;
        sw_0_series_coach_year_dep_livery;
    }

    // COACH REVERSED

    switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev_year_dep_livery, build_year) {
        0..2001: ss_0_series_coach_rev_original_livery;
        2002..9999: ss_0_series_coach_rev_kodama_livery;
        ss_0_series_coach_rev_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev, cargo_subtype) {
        1: ss_0_series_coach_rev_original_livery;
        2: ss_0_series_coach_rev_nose_livery;
        3: ss_0_series_coach_rev_original_livery;
        4: ss_0_series_coach_rev_kodama_livery;
        5: ss_0_series_coach_rev_kodama_livery;
        sw_0_series_coach_rev_year_dep_livery;
    }

    // PANTO

    switch(FEAT_TRAINS, SELF, sw_0_series_panto_year_dep_livery, build_year) {
        0..2001: ss_0_series_panto_original_livery;
        2002..9999: ss_0_series_panto_kodama_livery;
        ss_0_series_panto_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_panto, cargo_subtype) {
        1: ss_0_series_panto_original_livery;
        2: ss_0_series_panto_nose_livery;
        3: ss_0_series_panto_original_livery;
        4: ss_0_series_panto_kodama_livery;
        5: ss_0_series_panto_kodama_livery;
        sw_0_series_panto_year_dep_livery;
    }

    // PANTO REVERSED

    switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev_year_dep_livery, build_year) {
        0..2001: ss_0_series_panto_rev_original_livery;
        2002..9999: ss_0_series_panto_rev_kodama_livery;
        ss_0_series_panto_rev_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev, cargo_subtype) {
        1: ss_0_series_panto_rev_original_livery;
        2: ss_0_series_panto_rev_nose_livery;
        3: ss_0_series_panto_rev_original_livery;
        4: ss_0_series_panto_rev_kodama_livery;
        5: ss_0_series_panto_rev_kodama_livery;
        sw_0_series_panto_rev_year_dep_livery;
    }

    // PURCHASE MENU

    switch(FEAT_TRAINS, SELF, sw_0_series_year_dep_purchase, current_year) {
        0..1986: ss_0_series_buy_original_livery;       // JNR
        1987..2002: ss_0_series_buy_original_1987;      // JR West & JR Central
        ss_0_series_buy_kodama_livery;                  // JR West
    }

/* End 0 series LIVERIES*/
# 1 "src/trains/0_series/0_series_fixed.pnml" 3
# 1 "src/trains/0_series/0_series_stats.pnml" 1
/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_0_series_number_of_cars, cargo_subtype) {
            2: return 12;
            3: return 8;
            5: return 8;     
            return 16;       
        }

    switch(FEAT_TRAINS, SELF, sw_0_series_number_of_motor_cars, cargo_subtype) {
            2: return 12;           // All cars motorised
            3: return 8;            // All cars motorised
            5: return 8;            // All cars motorised   
            return 16;              // All cars motorised
        }

/* LENGTH*/
    switch(FEAT_TRAINS, SELF, sw_0_series_length, cargo_subtype) {
        2: sw_length_1_1_8_2;       // Nose Set
        3: sw_length_1_1_7_1_1_1;   // 8-car set
        5: sw_length_1_1_7_1_1_1;   // 8-car set  
        sw_length_2_8_2;            // All other 16-length sets
    }

/* RUNNING COSTS */
    running_cost_0_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_0_series_running_costs, current_speed) {
        0: running_cost_0_series / 10 * sw_0_series_number_of_cars();           // Stopped
        1..15: running_cost_0_series / 4 * sw_0_series_number_of_cars(); 	    // Moving below ~33.5 mph
        running_cost_0_series * sw_0_series_number_of_cars(); 				    // Track speed
    }

/* WEIGHT */  
    weight_0_series = 61;           // 61t per JPS
    
/* POWER */
    power_per_motor_0_series = 248; // in hp (185 kW)
    
/* SPEED */
    switch (FEAT_TRAINS, SELF, sw_0_series_speed, current_year) {
	    0..1986: return 210;                        // Until 1986, Speed = 210 km/h
	    return 220;                                 // After 1986, Speed = 220 km/h
    }

/* CARGO CAPACITY 

    16-car JPS  1248/1560/1872/2184
    12-car JPS  936/1170/1404/1638
    8-car  JPS  624/780/986/1092

        16-car  12-car 
    IRL 1340    ?        
    RW  1344    1008               
    LS  2016    1488             
    DC  2688    2016      

*/

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_0_series_param_cargo_capacity_16car, param_basecapacity) {
        0: return 28;       // 1x Real World Capacity
        2: return 56;       // 2x Double Real World Capacity
        return 42;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_0_series_param_cargo_capacity_12car, param_basecapacity) {
        0: return 21;       // 1x Real World Capacity
        2: return 42;       // 2x Double Real World Capacity
        return 31;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_0_series_param_cargo_capacity_08car, param_basecapacity) {
        0: return 14;       // 1x Real World Capacity
        2: return 28;       // 2x Double Real World Capacity
        return 21;          // 1.5x Long Sprite Adjusted Capacity 
    }


    switch(FEAT_TRAINS, SELF, sw_0_series_cargo_capacity, cargo_subtype) {
        2: sw_0_series_param_cargo_capacity_12car;
        3: sw_0_series_param_cargo_capacity_08car;
        5: sw_0_series_param_cargo_capacity_08car;
        sw_0_series_param_cargo_capacity_16car;
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_0_series_param_loading_speed_16car, param_basecapacity) {
        0: return 28 / param_loading_2D;        // 1x Real World Capacity
        2: return 56 / param_loading_2D;        // 2x Double Real World Capacity
        return 42 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_0_series_param_loading_speed_12car, param_basecapacity) {
        0: return 21 / param_loading_2D;        // 1x Real World Capacity
        2: return 42 / param_loading_2D;        // 2x Double Real World Capacity
        return 31 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_0_series_param_loading_speed_08car, param_basecapacity) {
        0: return 14 / param_loading_2D;        // 1x Real World Capacity
        2: return 28 / param_loading_2D;        // 2x Double Real World Capacity
        return 21 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_loading_speed, cargo_subtype) {
        2: sw_0_series_param_loading_speed_12car; 
        3: sw_0_series_param_loading_speed_08car;
        5: sw_0_series_param_loading_speed_08car;
        sw_0_series_param_loading_speed_16car;
    }

/* REFIT COST */

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_minus4, cargo_subtype) {
        4: return -16+16;
        return -8+16;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_minus3, cargo_subtype) {
        3: return -8+16;
        4: return -16+16;
        return -8+12;
    }
    
    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_minus2, cargo_subtype) {
        2: return -12+16;
        3: return -8+16;
        4: return -16+12;
        return -8+8;
    }
    
    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_minus1, cargo_subtype) {
        1: return -16+16;
        2: return -12+16;
        3: return -8+12;
        4: return -16+8;
        return -8+16;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_plus1, cargo_subtype) {
        0: return -16+16;
        1: return -16+12;
        2: return -12+8;
        3: return -8+16;   
        return -16+8;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_plus2, cargo_subtype) {
        0: return -16+12;      
        1: return -16+8;
        2: return -12+16;
        return -8+8;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_plus3, cargo_subtype) {
        0: return -16+8;
        1: return -16+16;
        return -12+8;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost_plus4, cargo_subtype) {
        0: return -16+16;
        return -16+8;
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
	    -5:             0;  
        -4:             sw_0_series_refit_cost_minus4;
        -3:             sw_0_series_refit_cost_minus3; 
        -2:				sw_0_series_refit_cost_minus2;
	    -1:				sw_0_series_refit_cost_minus1;
	    0:				0;
	    1:				sw_0_series_refit_cost_plus1;
	    2:				sw_0_series_refit_cost_plus2;
        3:              sw_0_series_refit_cost_plus3;
        4:              sw_0_series_refit_cost_plus4;
        5:              -16+8;  
	    return CB_FAILED;
    }
# 1 "src/trains/0_series/0_series_fixed.pnml" 3
# 1 "src/trains/0_series/0_series_formation.pnml" 1
/* 0 Series REVERSERS */

    // Coach-Panto
    switch (FEAT_TRAINS, PARENT, sw_0_series_reverser_C_P, vehicle_is_reversed) {
	    0: sw_0_series_coach;
	    sw_0_series_panto_rev;
    }
    // Panto - Coach
    switch (FEAT_TRAINS, PARENT, sw_0_series_reverser_P_C, vehicle_is_reversed) {
	    0: sw_0_series_panto;
	    sw_0_series_coach_rev;
    }

/* PUT TOGETHER THE EMU*/

/* 16-car sent */
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_16car, position_in_articulated_veh) {
                                    // 16-car   
    1:  sw_0_series_cab; 	        // Car 1    	
	4:  sw_0_series_reverser_P_C;	// Car 2	
	7:  sw_0_series_reverser_C_P;   // Car 3    
	10: sw_0_series_reverser_P_C;   // Car 4    
    13: sw_0_series_reverser_C_P;   // Car 5    
    16: sw_0_series_reverser_P_C;   // Car 6   
    19: sw_0_series_reverser_C_P;   // Car 7    
	22: sw_0_series_reverser_P_C;   // Car 8    
    25: sw_0_series_reverser_C_P;   // Car 9    
    28: sw_0_series_reverser_P_C;   // Car 10   
    31: sw_0_series_reverser_C_P;   // Car 11   
    34: sw_0_series_reverser_P_C;   // Car 12   
    37: sw_0_series_reverser_C_P;   // Car 13   
    40: sw_0_series_reverser_P_C;   // Car 14   
    43: sw_0_series_reverser_C_P;   // Car 15   
    46: sw_0_series_cab_rev;           // Car 16   
	dummy_sprites;
}

// For 12-car set
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_12car, position_in_articulated_veh) {
                                    // 12-car
    2:  sw_0_series_cab; 	        // Car 1	
	6:  sw_0_series_reverser_P_C;   // Car 2
    10: sw_0_series_reverser_C_P;   // Car 3
    14: sw_0_series_reverser_P_C;   // Car 4 
    18: sw_0_series_reverser_C_P;   // Car 5
    22: sw_0_series_reverser_P_C;   // Car 6
    26: sw_0_series_reverser_C_P;   // Car 7
    30: sw_0_series_reverser_P_C;   // Car 8
    34: sw_0_series_reverser_C_P;   // Car 9
    38: sw_0_series_reverser_P_C;   // Car 10
    42: sw_0_series_reverser_C_P;   // Car 11
    46: sw_0_series_cab_rev;        // Car 12
	dummy_sprites;
}

// For 8-car set
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_08car, position_in_articulated_veh) {
                                    // 8-car
    2:  sw_0_series_cab; 	        // Car 1	
	8:  sw_0_series_reverser_P_C;   // Car 2
    14: sw_0_series_reverser_C_P;   // Car 3
    20: sw_0_series_reverser_P_C;   // Car 4 
    26: sw_0_series_reverser_C_P;   // Car 5
    32: sw_0_series_reverser_P_C;   // Car 6
    38: sw_0_series_reverser_C_P;   // Car 7
    44: sw_0_series_cab_rev;        // Car 8
	dummy_sprites;
}

/* Choose which Graphics based on which Cargo Subtype */
switch(FEAT_TRAINS, SELF, sw_0_series_graphics, cargo_subtype) {
    2: sw_0_series_graphics_12car;
    3: sw_0_series_graphics_08car;
    5: sw_0_series_graphics_08car;
    sw_0_series_graphics_16car;
}

/* Assemble an 48 part articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_0_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_0;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/0_series/0_series_fixed.pnml" 3
    
item(FEAT_TRAINS, series_0) {
	property {
		/* Menu */
        name: 							string(STR_NAME_0_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1964,10,01);           // Date of launch
		model_life:                     2008 - 1964;		        // Until 2008
		vehicle_life:                   30;							// Same as JapanSet
        track_type:                     SHINKANSEN;
		/* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;                         // Changed by callback						
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
        power:                          8050 kW;	                // Changed by callback				
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_0_SERIES);
        cargo_subtype_text:             sw_0_series_year_dep_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
        /* Graphics */
        default:                        sw_0_series_graphics;
		purchase:                       sw_0_series_year_dep_purchase;
		articulated_part:               sw_0_series_articulated_part;
        visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
        length:                         sw_0_series_length;
        weight:                         weight_0_series * sw_0_series_number_of_cars();
        power:                          power_per_motor_0_series * 4 * sw_0_series_number_of_motor_cars();
        speed:							sw_0_series_speed;
		cargo_capacity:                 sw_0_series_cargo_capacity;
		loading_speed:					sw_0_series_loading_speed;
		cargo_age_period:				param_decay_express;
        cost_factor:                    500;
        refit_cost:                     sw_0_series_refit_cost;
		running_cost_factor:            sw_0_series_running_costs;
		purchase_running_cost_factor:   running_cost_0_series * sw_0_series_number_of_cars();
	}
}

/* End 0 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/n700_series/n700_series_fixed.pnml" 1
/* Begin N700 Series */

# 1 "src/trains/n700_series/n700_series_subtypes.pnml" 1
/* N700 CARGO SUBTYPE MENU*/

    // Original N700 Series launched 2007
    switch(FEAT_TRAINS, SELF, sw_n700_series_subtype_text_2007, cargo_subtype) {
	    0: return string(LV_YEAR_DEP_LIVERY);           // Year Dependent Livery
        1: return string(LV_N700_SERIES_N700);          // 16 Car Original
        return CB_RESULT_NO_TEXT;
        }

    // Post 2011 subtype text
    switch(FEAT_TRAINS, SELF, sw_n700_series_subtype_text_2011, cargo_subtype) {
	    0: return string(LV_YEAR_DEP_LIVERY);           // Year Dependent Livery
        1: return string(LV_N700_SERIES_N700);          // 16 Car Original
        2: return string(LV_N700_SERIES_N700_08CAR);    // 8 Car Original
        return CB_RESULT_NO_TEXT;
        }

    // Post 2013 subtype text - N700A
    switch(FEAT_TRAINS, SELF, sw_n700_series_subtype_text_2013, cargo_subtype) {
	    0: return string(LV_YEAR_DEP_LIVERY);           // Year Dependent Livery
        1: return string(LV_N700_SERIES_N700);          // 16 Car Original
        2: return string(LV_N700_SERIES_N700_08CAR);    // 8 Car Original
        3: return string(LV_N700_SERIES_N700A);         // 16 Car N700A
        return CB_RESULT_NO_TEXT;
        }

    // Post 2020 subtype text - N700S
    switch(FEAT_TRAINS, SELF, sw_n700_series_subtype_text_2020, cargo_subtype) {
	    0: return string(LV_YEAR_DEP_LIVERY);           // Year Dependent Livery
        1: return string(LV_N700_SERIES_N700);          // 16 Car Original
        2: return string(LV_N700_SERIES_N700_08CAR);    // 8 Car Original
        3: return string(LV_N700_SERIES_N700A);         // 16 Car N700A
        4: return string(LV_N700_SERIES_N700S);         // 16 Car N700S    
        return CB_RESULT_NO_TEXT;
        }

    switch(FEAT_TRAINS, SELF, sw_n700_series_subtype_text, current_year) {
        0..2010:    sw_n700_series_subtype_text_2007;
        2011..2012: sw_n700_series_subtype_text_2011;
        2013..2019: sw_n700_series_subtype_text_2013;
        sw_n700_series_subtype_text_2020;
        }

/* N700 KYUSHU CARGO SUBTYPE MENU*/

    // Post 2011 subtype text
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_subtype_text_2011, cargo_subtype) {
	    0: return string(LV_YEAR_DEP_LIVERY);           // Year Dependent Livery
        1: return string(LV_N700_SERIES_KYUSHU);        // 16 Car Original
        return CB_RESULT_NO_TEXT;
        }

    // Post 2023 subtype text
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_subtype_text_2023, cargo_subtype) {
	    0: return string(LV_YEAR_DEP_LIVERY);           // Year Dependent Livery
        1: return string(LV_N700_SERIES_KYUSHU);        // 8 Car Kyushu Livery
        2: return string(LV_N700_SERIES_KANOME);        // 6 Car Kanome Livery
        return CB_RESULT_NO_TEXT;
        }        

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_subtype_text, current_year) {
        0..2022: sw_n700_series_kyushu_subtype_text_2011;
        sw_n700_series_kyushu_subtype_text_2023;
        }
# 1 "src/trains/n700_series/n700_series_fixed.pnml" 3
# 1 "src/trains/n700_series/n700_series_gfx.pnml" 1
/* Begin N700 Series GRAPHICS */

    /* Purchase Menu */
    spriteset (ss_n700_series_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_n700_series_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/n700_series/buy_n700.png") {template_purchase(0, 0)}

    spriteset (ss_n700a_series_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_n700a_series_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/n700_series/buy_n700a.png") {template_purchase(0, 0)}

    spriteset (ss_n700s_series_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_n700s_series_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/n700_series/buy_n700s.png") {template_purchase(0, 0)}

    spriteset (ss_n700_series_kyushu_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_n700_series_kyushu_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/n700_series/buy_kyushu.png") {template_purchase(0, 0)}

    spriteset (ss_n700_series_kamome_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_n700_series_kamome_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/n700_series/buy_kamome.png") {template_purchase(0, 0)}

    /* EMU Parts */

    /* "CAB" */
    spriteset(ss_n700_series_cab_n700_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_rev_n700_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_n700a_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_rev_n700a_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_n700s_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_rev_n700s_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_kyushu_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_rev_kyushu_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_kamome_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_cab_rev_kamome_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // N700 Series Livery
    alternative_sprites(ss_n700_series_cab_n700_livery,             ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700.png") {template_12_standard(1,1)}
    alternative_sprites(ss_n700_series_cab_rev_n700_livery,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700.png") {template_12_reversed(1,41)}		

    // N700A Series Livery
    alternative_sprites(ss_n700_series_cab_n700a_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700a.png") {template_12_standard(1,1)}
    alternative_sprites(ss_n700_series_cab_rev_n700a_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700a.png") {template_12_reversed(1,41)}

    // N700S Series Livery
    alternative_sprites(ss_n700_series_cab_n700s_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700s.png") {template_12_standard(1,1)}
    alternative_sprites(ss_n700_series_cab_rev_n700s_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700s.png") {template_12_reversed(1,41)}

    // N700 Series Kyushu Strip Livery
    alternative_sprites(ss_n700_series_cab_kyushu_livery,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kyushu.png") {template_12_standard(1,1)}
    alternative_sprites(ss_n700_series_cab_rev_kyushu_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kyushu.png") {template_12_reversed(1,41)}

    // N700 Series kamome Livery
    alternative_sprites(ss_n700_series_cab_kamome_livery,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kamome.png") {template_12_standard(1,1)}
    alternative_sprites(ss_n700_series_cab_rev_kamome_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kamome.png") {template_12_reversed(1,41)}

    /* COACH */
    spriteset(ss_n700_series_coach_n700_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_rev_n700_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_n700a_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_rev_n700a_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_n700s_livery,             	    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_rev_n700s_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_kyushu_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_rev_kyushu_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_kamome_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_coach_rev_kamome_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // N700 Series Livery
    alternative_sprites(ss_n700_series_coach_n700_livery,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700.png") {template_12_standard(1,121)}
    alternative_sprites(ss_n700_series_coach_rev_n700_livery,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700.png") {template_12_reversed(1,121)}

    // N700A Series Livery
    alternative_sprites(ss_n700_series_coach_n700a_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700a.png") {template_12_standard(1,121)}
    alternative_sprites(ss_n700_series_coach_rev_n700a_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700a.png") {template_12_reversed(1,121)}

    // N700S Series Livery
    alternative_sprites(ss_n700_series_coach_n700s_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700s.png") {template_12_standard(1,121)}
    alternative_sprites(ss_n700_series_coach_rev_n700s_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/n700s.png") {template_12_reversed(1,121)}

    // N700 Series Kyushu Strip Livery
    alternative_sprites(ss_n700_series_coach_kyushu_livery,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kyushu.png") {template_12_standard(1,121)}
    alternative_sprites(ss_n700_series_coach_rev_kyushu_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kyushu.png") {template_12_reversed(1,121)}	

    // N700 Series kamome Livery
    alternative_sprites(ss_n700_series_coach_kamome_livery,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kamome.png") {template_12_standard(1,121)}
    alternative_sprites(ss_n700_series_coach_rev_kamome_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kamome.png") {template_12_reversed(1,121)}

    /* PANTO */
    spriteset(ss_n700_series_panto_n700_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_rev_n700_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_n700a_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_rev_n700a_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_n700s_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_rev_n700s_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_kyushu_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_rev_kyushu_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_kamome_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_n700_series_panto_rev_kamome_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // N700 Series Livery
    alternative_sprites(ss_n700_series_panto_n700_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/n700_series/n700.png") {template_12_standard(1,81)}
    alternative_sprites(ss_n700_series_panto_rev_n700_livery,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/n700_series/n700.png") {template_12_reversed(1,81)}
    
    // N700A Series Livery
    alternative_sprites(ss_n700_series_panto_n700a_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/n700_series/n700a.png") {template_12_standard(1,81)}
    alternative_sprites(ss_n700_series_panto_rev_n700a_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/n700_series/n700a.png") {template_12_reversed(1,81)}

    // N700S Series Livery
    alternative_sprites(ss_n700_series_panto_n700s_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/n700_series/n700s.png") {template_12_standard(1,81)}
    alternative_sprites(ss_n700_series_panto_rev_n700s_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/n700_series/n700s.png") {template_12_reversed(1,81)}

    // N700 Series Kyushu Strip Livery
    alternative_sprites(ss_n700_series_panto_kyushu_livery,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kyushu.png") {template_12_standard(1,81)}
    alternative_sprites(ss_n700_series_panto_rev_kyushu_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kyushu.png") {template_12_reversed(1,81)}

    // N700 Series kamome Livery
    alternative_sprites(ss_n700_series_panto_kamome_livery,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kamome.png") {template_12_standard(1,81)}
    alternative_sprites(ss_n700_series_panto_rev_kamome_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/n700_series/kamome.png") {template_12_reversed(1,81)}	

/* End N700 series GRAPHICS */
# 1 "src/trains/n700_series/n700_series_fixed.pnml" 3
# 1 "src/trains/n700_series/n700_series_liveries.pnml" 1
/* N700 Liveries */
    
    // PURCHASE MENU

    switch(FEAT_TRAINS, SELF, sw_n700_series_year_dep_purchase, current_year) {
    0..2012: ss_n700_series_buy;                            // N700 
    2013..2019: ss_n700a_series_buy;                        // N700A
    ss_n700s_series_buy;                                    // N700S
    }

    // CAB

    // Year Dependent Livery - Cab
    switch(FEAT_TRAINS, SELF, sw_n700_series_cab_year_dep_livery, build_year) {
        0..2012: ss_n700_series_cab_n700_livery;            // N700
        2013..2019: ss_n700_series_cab_n700a_livery;        // N700A
        ss_n700_series_cab_n700s_livery;                    // N700S
    }
    // Year Dependent Livery - Cab Reversed
    switch(FEAT_TRAINS, SELF, sw_n700_series_cab_rev_year_dep_livery, build_year) {
        0..2012: ss_n700_series_cab_rev_n700_livery;
        2013..2019: ss_n700_series_cab_rev_n700a_livery;
        ss_n700_series_cab_rev_n700s_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_cab, cargo_subtype) {
        1: ss_n700_series_cab_n700_livery;                  // N700
        2: ss_n700_series_cab_n700_livery;                  // N700
        3: ss_n700_series_cab_n700a_livery;                 // N700A
        4: ss_n700_series_cab_n700s_livery;                 // N700S
        sw_n700_series_cab_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_cab_rev, cargo_subtype) {
        1: ss_n700_series_cab_rev_n700_livery;              // N700
        2: ss_n700_series_cab_rev_n700_livery;              // N700
        3: ss_n700_series_cab_rev_n700a_livery;             // N700A
        4: ss_n700_series_cab_rev_n700s_livery;             // N700S
        sw_n700_series_cab_rev_year_dep_livery;
    }

    // COACH

    // Year Dependent Livery - Coach
    switch(FEAT_TRAINS, SELF, sw_n700_series_coach_year_dep_livery, build_year) {
        0..2012: ss_n700_series_coach_n700_livery;          // N700
        2013..2019: ss_n700_series_coach_n700a_livery;      // N700A
        ss_n700_series_coach_n700s_livery;                  // N700S
    }
    // Year Dependent Livery - Coach Reversed
    switch(FEAT_TRAINS, SELF, sw_n700_series_coach_rev_year_dep_livery, build_year) {
        0..2012: ss_n700_series_coach_rev_n700_livery;
        2013..2019: ss_n700_series_coach_rev_n700a_livery;
        ss_n700_series_coach_rev_n700s_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_coach, cargo_subtype) {
        1: ss_n700_series_coach_n700_livery;                // N700
        2: ss_n700_series_coach_n700_livery;                // N700
        3: ss_n700_series_coach_n700a_livery;               // N700A
        4: ss_n700_series_coach_n700s_livery;               // N700S
        sw_n700_series_coach_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_coach_rev, cargo_subtype) {
        1: ss_n700_series_coach_rev_n700_livery;            // N700
        2: ss_n700_series_coach_rev_n700_livery;            // N700
        3: ss_n700_series_coach_rev_n700a_livery;           // N700A
        4: ss_n700_series_coach_rev_n700s_livery;           // N700S
        sw_n700_series_coach_rev_year_dep_livery;
    }

    // PANTO

    // Year Dependent Livery - Panto
    switch(FEAT_TRAINS, SELF, sw_n700_series_panto_year_dep_livery, build_year) {
        0..2012: ss_n700_series_panto_n700_livery;          // N700
        2013..2019: ss_n700_series_panto_n700a_livery;      // N700A
        ss_n700_series_panto_n700s_livery;                  // N700S
    }
    // Year Dependent Livery - Panto Reversed
    switch(FEAT_TRAINS, SELF, sw_n700_series_panto_rev_year_dep_livery, build_year) {
        0..2012: ss_n700_series_panto_rev_n700_livery;
        2013..2019: ss_n700_series_panto_rev_n700a_livery;
        ss_n700_series_panto_rev_n700s_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_panto, cargo_subtype) {
        1: ss_n700_series_panto_n700_livery;                // N700
        2: ss_n700_series_panto_n700_livery;                // N700
        3: ss_n700_series_panto_n700a_livery;               // N700A
        4: ss_n700_series_panto_n700s_livery;               // N700S
        sw_n700_series_panto_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_panto_rev, cargo_subtype) {
        1: ss_n700_series_panto_rev_n700_livery;            // N700
        2: ss_n700_series_panto_rev_n700_livery;            // N700
        3: ss_n700_series_panto_rev_n700a_livery;           // N700A
        4: ss_n700_series_panto_rev_n700s_livery;           // N700S
        sw_n700_series_panto_rev_year_dep_livery;
    }

/* End N700 Liveries */

/* N700 Kyushu Liveries */

    // PURCHASE MENU

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_year_dep_purchase, current_year) {
    0..2022: ss_n700_series_kyushu_buy;                     // N700 Kyushu
    ss_n700_series_kamome_buy;                              // N700S kamome
    }
    
    // CAB

    // Year Dependent Livery - Cab
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_cab_year_dep_livery, build_year) {
        0..2022: ss_n700_series_cab_kyushu_livery;          // N700 Kyushu
        ss_n700_series_cab_kamome_livery;                   // N700S kamome
    }
    // Year Dependent Livery - Cab Reversed
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_cab_rev_year_dep_livery, build_year) {
        0..2022: ss_n700_series_cab_rev_kyushu_livery;      // N700 Kyushu
        ss_n700_series_cab_rev_kamome_livery;               // N700S kamome
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_kyushu_cab, cargo_subtype) {
        1: ss_n700_series_cab_kyushu_livery;                // N700 Kyushu Livery
        2: ss_n700_series_cab_kamome_livery;                // N700S kamome Livery 
        sw_n700_series_kyushu_cab_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_kyushu_cab_rev, cargo_subtype) {
        1: ss_n700_series_cab_rev_kyushu_livery;                // N700 Kyushu Livery
        2: ss_n700_series_cab_rev_kamome_livery;                // N700S kamome Livery 
        sw_n700_series_kyushu_cab_rev_year_dep_livery;
    }


    // COACH

    // Year Dependent Livery - Coach
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_coach_year_dep_livery, build_year) {
        0..2022: ss_n700_series_coach_kyushu_livery;        // N700 Kyushu
        ss_n700_series_coach_kamome_livery;                 // N700S kamome
    }
    // Year Dependent Livery - Coach Reversed
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_coach_rev_year_dep_livery, build_year) {
        0..2022: ss_n700_series_coach_rev_kyushu_livery;    // N700 Kyushu
        ss_n700_series_coach_rev_kamome_livery;             // N700S kamome
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_kyushu_coach, cargo_subtype) {
        1: ss_n700_series_coach_kyushu_livery;              // N700 Kyushu Livery
        2: ss_n700_series_coach_kamome_livery;              // N700S kamome Livery 
        sw_n700_series_kyushu_coach_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_kyushu_coach_rev, cargo_subtype) {
        1: ss_n700_series_coach_rev_kyushu_livery;          // N700 Kyushu Livery
        2: ss_n700_series_coach_rev_kamome_livery;          // N700S kamome Livery 
        sw_n700_series_kyushu_coach_rev_year_dep_livery;
    }

    // PANTO

    // Year Dependent Livery - Panto
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_panto_year_dep_livery, build_year) {
        0..2022: ss_n700_series_panto_kyushu_livery;        // N700 Kyushu
        ss_n700_series_panto_kamome_livery;                 // N700S kamome
    }
    // Year Dependent Livery - Panto Reversed
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_panto_rev_year_dep_livery, build_year) {
        0..2022: ss_n700_series_panto_rev_kyushu_livery;    // N700 Kyushu
        ss_n700_series_panto_rev_kamome_livery;             // N700S kamome
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_kyushu_panto, cargo_subtype) {
        1: ss_n700_series_panto_kyushu_livery;              // N700 Kyushu Livery
        2: ss_n700_series_panto_kamome_livery;              // N700S kamome Livery 
        sw_n700_series_kyushu_panto_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_n700_series_kyushu_panto_rev, cargo_subtype) {
        1: ss_n700_series_panto_rev_kyushu_livery;          // N700 Kyushu Livery
        2: ss_n700_series_panto_rev_kamome_livery;          // N700S kamome Livery 
        sw_n700_series_kyushu_panto_rev_year_dep_livery;
    }

/* End N700 Kyushu Liveries */
# 1 "src/trains/n700_series/n700_series_fixed.pnml" 3
# 1 "src/trains/n700_series/n700_series_stats.pnml" 1
/* N700 STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_n700_series_number_of_cars, cargo_subtype) {
            2: return 8;     
            return 16;       
        }

    switch(FEAT_TRAINS, SELF, sw_n700_series_number_of_motor_cars, cargo_subtype) {
            2: return 8;        // All motorised  
            return 14;          // 14M 2T
        }

/* LENGTH */
    switch (FEAT_TRAINS, SELF, sw_n700_series_length, cargo_subtype) {
        2: sw_length_1_1_7_1_1_1;
        sw_length_2_8_2;      
        
    }

/* CARGO CAPACITY

    JPS 1248/1560/1872/2184
    JPS 624/780/936/1092

        16-car  8-car
    IRL 1323    546
    RW  1344    576  
    LS  2016    864
    DC  2688    1152

    */

    // round(IRL capacity/48)
    switch(FEAT_TRAINS, SELF, sw_n700_series_param_cargo_capacity_16car, param_basecapacity) {
        0: return 28;       // 1x Real World Capacity
        2: return 56;       // 2x Double Real World Capacity
        return 42;          // 1.5x Long Sprite Adjusted Capacity 
    }
    // round(IRL capacity/48)
    switch(FEAT_TRAINS, SELF, sw_n700_series_param_cargo_capacity_08car, param_basecapacity) {
        0: return 12;       // 1x Real World Capacity
        2: return 24;       // 2x Double Real World Capacity
        return 18;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // Capacity for each length    
    switch(FEAT_TRAINS, SELF, sw_n700_series_cargo_capacity, cargo_subtype) {
        2: sw_n700_series_param_cargo_capacity_08car;       // Length 8 (6.0 tiles)
        sw_n700_series_param_cargo_capacity_16car;          // Length 16 (12.0 tiles)
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_n700_series_loading_speed_16car, param_basecapacity) {
        0: return 28 / param_loading_2D;        // 1x Real World Capacity
        2: return 56 / param_loading_2D;        // 2x Double Real World Capacity
        return 42 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_n700_series_loading_speed_08car, param_basecapacity) {
        0: return 12 / param_loading_2D;        // 1x Real World Capacity
        2: return 24 / param_loading_2D;        // 2x Double Real World Capacity
        return 18 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_n700_series_loading_speed, cargo_subtype) {
        1: sw_n700_series_loading_speed_08car;
        sw_n700_series_loading_speed_16car;
    }

/* WEIGHT */
    weight_n700_series = 44;           // 44t per JPS

    // Not a lot of available weight info for the N700S, other than talk of weight savings from the engines - therefore slight reduction
    switch(FEAT_TRAINS, SELF, sw_n700_series_weight_year_dep, build_year) {
        0..2019: return weight_n700_series * sw_n700_series_number_of_cars();       // N700 and N700A
        return (weight_n700_series - 1) * sw_n700_series_number_of_cars();          // N700S
    }
    
    switch(FEAT_TRAINS, SELF, sw_n700_series_weight, cargo_subtype) {
        0: sw_n700_series_weight_year_dep;                                          // Year Dependent Weight
        4: return (weight_n700_series - 1) * sw_n700_series_number_of_cars();       // N700S, slightly ligther
        return weight_n700_series * sw_n700_series_number_of_cars();                // Weight of a 16 car N700 as stated on Wikipedia
    }

/* POWER */
    power_per_motor_n700_series = 409;          // in hp (or 305 kW)

/* SPEED */

    switch(FEAT_TRAINS, SELF, sw_n700_series_speed_year_dep, build_year) {
        0..2019: return 300;                    // N700 and N700A
        return 360;                             // N700S
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_speed, cargo_subtype) {
        0: sw_n700_series_speed_year_dep;       // Year Dependent
        4: return 360;                          // N700S    
        return 300;                             // All others      
        
    }

/* RUNNING COSTS */
    running_cost_n700_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_running_costs, current_speed) {
        0: running_cost_n700_series / 10 * sw_n700_series_number_of_cars();         // Stopped
        1..15: running_cost_n700_series / 4 * sw_n700_series_number_of_cars();      // Moving below ~33.5 mph
        running_cost_n700_series * sw_n700_series_number_of_cars(); 				// Track speed
    }

/* REFIT COST */

    switch(FEAT_TRAINS, SELF, sw_n700_series_refit_cost_minus2, cargo_subtype) {
        2: return -8+16;        // Currently 'N700 8-car', Cost to move elsewhere
        4: return -16+8;        // Currently 'N700S 16-car', Refund to move to 'N700 8-car'    
        return 0;       
    }
    
    switch(FEAT_TRAINS, SELF, sw_n700_series_refit_cost_minus1, cargo_subtype) {
        2: return -8+16;        // Currently 'N700 8-car', Cost to move elsewhere
        3: return -16+8;        // Currently 'N700A 16-car', Refund to move to 'N700 8-car'   
        return 0;               // Otherwise, moving to another 16-car 
    }
  
    switch(FEAT_TRAINS, SELF, sw_n700_series_refit_cost_plus1, cargo_subtype) {
        1: return -16+8;        // Currently 'N700 16-car', Refund to move to 'N700 8-car'
        2: return -8+16;        // Currently 'N700 8-car', Cost to move elsewhere               
        return 0;               // Otherwise, moving to another 16-car 
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_refit_cost_plus2, cargo_subtype) {
        0: return -16+8;        // Currently 'Year Dep', Refund to move to 'N700 8-car'
        2: return -8+16;        // Currently 'N700 8-car', Cost to move elsewhere                
        return 0;               // Otherwise, moving to another 16-car 
    }


    switch(FEAT_TRAINS, SELF, sw_n700_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
        -4:				0;
        -3:				0;
        -2:				sw_n700_series_refit_cost_minus2;
	    -1:				sw_n700_series_refit_cost_minus1;
	    0:				0;
	    1:				sw_n700_series_refit_cost_plus1;
	    2:				sw_n700_series_refit_cost_plus2;
        3:              0;
        4:              0;
	    return CB_FAILED;
    }

/* End N700 STATS */

/* N700 Kyushu STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_number_of_cars_year_dep, build_year) {
        0..2022: return 8;      // 8-car Kyushu
        return 6;               // 6-car Kanome
    }
    
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_number_of_cars, cargo_subtype) {
            1: return 8;
            2: return 6;     
            sw_n700_series_kyushu_number_of_cars_year_dep;       
        }

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_number_of_motor_cars_year_dep, build_year) {
        0..2022: return 8;      // 8-car Kyushu
        return 6;               // 6-car Kanome
    }
        
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_number_of_motor_cars, cargo_subtype) {
            1: return 8;
            2: return 6;     
            sw_n700_series_kyushu_number_of_motor_cars_year_dep; 
        }

/* LENGTH */
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_length_year_dep, build_year) {
        0..2022: sw_length_2_8_2;                           // N700 Kyushu
        sw_length_1_1_8_2;                                  // N700S Koname
    }

    switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_length, cargo_subtype) {
        1: sw_length_2_8_2;      
        2: sw_length_1_1_8_2;
        sw_n700_series_kyushu_length_year_dep;
    }

/* CARGO CAPACITY

    JPS 624/780/936/1092
    JPS 

        8-car   6-car
    IRL 546     ?     
    RW  576     432     
    LS  864     648       
    DC  1152    864       

    */

    // round(IRL capacity/24)
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_param_cargo_capacity_08car, param_basecapacity) {
        0: return 24;       // 1x Real World Capacity
        2: return 48;       // 2x Double Real World Capacity
        return 36;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // round(IRL capacity/24)
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_param_cargo_capacity_06car, param_basecapacity) {
        0: return 18;       // 1x Real World Capacity
        2: return 36;       // 2x Double Real World Capacity
        return 27;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // Capacity for each length    
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_cargo_capacity_year_dep, build_year) {
        0..2022: sw_n700_series_kyushu_param_cargo_capacity_08car;  // N700 Kyushu                    
        sw_n700_series_kyushu_param_cargo_capacity_06car;           // N700S Koname
    }
    
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_cargo_capacity, cargo_subtype) {
        1: sw_n700_series_kyushu_param_cargo_capacity_08car;        // Length 8 (6.0 tiles)
        2: sw_n700_series_kyushu_param_cargo_capacity_06car;        // Length 6 (4.5 tiles)
        sw_n700_series_kyushu_cargo_capacity_year_dep;              // Year Dependent
    }

/* LOADING SPEED */

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_loading_speed_08car, param_basecapacity) {
        0: return 24 / param_loading_2D;        // 1x Real World Capacity
        2: return 48 / param_loading_2D;        // 2x Double Real World Capacity
        return 36 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 6 car
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_loading_speed_06car, param_basecapacity) {
        0: return 18 / param_loading_2D;        // 1x Real World Capacity
        2: return 36 / param_loading_2D;        // 2x Double Real World Capacity
        return 27 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_loading_speed_year_dep, build_year) {
        0..2022: sw_n700_series_kyushu_loading_speed_08car;     // N700 Kyushu                    
        sw_n700_series_kyushu_loading_speed_06car;              // N700S Koname
    }

    switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_loading_speed, cargo_subtype) {
        1: sw_n700_series_kyushu_loading_speed_08car;
        2: sw_n700_series_kyushu_loading_speed_06car;
        sw_n700_series_kyushu_loading_speed_year_dep;
    }

/* WEIGHT */
    weight_n700_series_kyushu = 44;           // 44t per JPS

    // Not a lot of available weight info for the N700S, other than talk of weight savings from the engines - therefore slight reduction
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_weight_year_dep, build_year) {
        0..2022: return weight_n700_series_kyushu * sw_n700_series_kyushu_number_of_cars();       // N700 and N700A
        return (weight_n700_series_kyushu - 1) * sw_n700_series_kyushu_number_of_cars();          // N700S
    }
    
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_weight, cargo_subtype) {
        0: sw_n700_series_kyushu_weight_year_dep;                                   // Year Dependent Weight
        2: return (weight_n700_series - 1) * sw_n700_series_number_of_cars();       // N700S Kanome
        return weight_n700_series * sw_n700_series_number_of_cars();                // N700 Kyushu
    }

/* POWER */
    power_per_motor_n700_series_kyushu = 409;               // in hp (or 305 kW)

/* COST FACTOR */
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_cost_factor_year_dep, build_year) {
        0..2022: return 277;                                // N700 Kyushu
        return 208;                                         // N700S Koname
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_cost_factor, cargo_subtype) {
        1: return 277;                                      // N700 Kyushu
        2: return 208;                                      // N700S Koname                                  
        sw_n700_series_kyushu_cost_factor_year_dep;         // Year Dependent                                         
    }

/* RUNNING COSTS */
    running_cost_n700_series_kyushu = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_running_costs, current_speed) {
        0: running_cost_n700_series_kyushu / 10 * sw_n700_series_kyushu_number_of_cars();         // Stopped
        1..15: running_cost_n700_series_kyushu / 4 * sw_n700_series_kyushu_number_of_cars();      // Moving below ~33.5 mph
        running_cost_n700_series_kyushu * sw_n700_series_kyushu_number_of_cars(); 				// Track speed
    }

/* REFIT COST */

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_refit_cost_minus1, cargo_subtype) {
        2: return 4;        // Currently 'N700 Kanome', Cost to move to 'N700 Kyushu'
        return 0;           // Otherwise, nil
    }
  
    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_refit_cost_plus1, cargo_subtype) {
        1: return -3;       // Currently 'N700 Kyushu', Refund to move to 'N700 Koname'          
        return 0;           // Otherwise, nil
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_refit_cost_plus2, cargo_subtype) {
        0: return -3;       // Currently 'Year Dep', Refund to move to 'N700 8-car'             
        return 0;           // Otherwise, nil
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
        -2:				4;
	    -1:				sw_n700_series_kyushu_refit_cost_minus1;
	    0:				0;
	    1:				sw_n700_series_kyushu_refit_cost_plus1;
	    2:				sw_n700_series_kyushu_refit_cost_plus2;
	    return CB_FAILED;
    }

/* End N700 Kyushu STATS */
# 1 "src/trains/n700_series/n700_series_fixed.pnml" 3
# 1 "src/trains/n700_series/n700_series_formation.pnml" 1
/* N700 REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_n700_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_n700_series_coach;
	    ss_n700_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_n700_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_n700_series_panto;
	    ss_n700_series_panto_rev;
    }

/* N700 PUT TOGETHER THE EMU*/

    /* Select the correct part of the train */
    switch (FEAT_TRAINS, SELF, sw_n700_series_graphics_16car, position_in_articulated_veh) {					
	    1:  ss_n700_series_cab; 	             // Car 1	Car 16								
	    4:  sw_n700_series_reverser_C_C;	     // Car 2	Car 15	    						
	    7:  sw_n700_series_reverser_C_C;         // Car 3    Car 14
	    10: sw_n700_series_reverser_C_C;         // Car 4    Car 13
        13: sw_n700_series_reverser_P_P;         // Car 5    Car 12
        16: sw_n700_series_reverser_C_C;         // Car 6    Car 11
        19: sw_n700_series_reverser_C_C;         // Car 7    Car 10
	    22: sw_n700_series_reverser_C_C;         // Car 8    Car 9
        25: sw_n700_series_reverser_C_C;         // Car 9    Car 8
        28: sw_n700_series_reverser_C_C;         // Car 10   Car 7
        31: sw_n700_series_reverser_C_C;         // Car 11   Car 6
        34: sw_n700_series_reverser_P_P;         // Car 12   Car 5
        37: sw_n700_series_reverser_C_C;         // Car 13   Car 4
        40: sw_n700_series_reverser_C_C;         // Car 14   Car 3
        43: sw_n700_series_reverser_C_C;         // Car 15   Car 2
        46: ss_n700_series_cab_rev;              // Car 16   Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_n700_series_graphics_8car, position_in_articulated_veh) {					
	    2:  ss_n700_series_cab; 	            // Car 1	Car 8								
	    8:  sw_n700_series_reverser_P_P;	    // Car 2	Car 7	    						
	    14: sw_n700_series_reverser_C_C;        // Car 3    Car 6
	    20: sw_n700_series_reverser_C_C;        // Car 4    Car 5
        26: sw_n700_series_reverser_C_C;        // Car 5    Car 4
        32: sw_n700_series_reverser_C_C;        // Car 6    Car 3
        38: sw_n700_series_reverser_P_P;        // Car 7    Car 2
        44: ss_n700_series_cab_rev;             // Car 8    Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_n700_series_graphics, cargo_subtype) {
        2: sw_n700_series_graphics_8car;
        sw_n700_series_graphics_16car;  
    }

/* ASSEMBLE */
	switch (FEAT_TRAINS, SELF, sw_n700_series_articulated_part, extra_callback_info1) {
		1 .. 47: return series_n700;										// Should be same as range above
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

/* N700 KYUSHU REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_n700_series_kyushu_reverser_C_C, vehicle_is_reversed) {
	    0: ss_n700_series_kyushu_coach;
	    ss_n700_series_kyushu_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_n700_series_kyushu_reverser_P_P, vehicle_is_reversed) {
	    0: ss_n700_series_kyushu_panto;
	    ss_n700_series_kyushu_panto_rev;
    }

/* N700 KYUSHU PUT TOGETHER THE EMU*/

    switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_graphics_8car, position_in_articulated_veh) {					
	    1:  ss_n700_series_kyushu_cab; 	                // Car 1	Car 8								
	    4:  sw_n700_series_kyushu_reverser_P_P;	        // Car 2	Car 7	    						
	    7:  sw_n700_series_kyushu_reverser_C_C;         // Car 3    Car 6
	    10: sw_n700_series_kyushu_reverser_C_C;         // Car 4    Car 5
        13: sw_n700_series_kyushu_reverser_C_C;         // Car 5    Car 4
        16: sw_n700_series_kyushu_reverser_C_C;         // Car 6    Car 3
        19: sw_n700_series_kyushu_reverser_P_P;         // Car 7    Car 2
        22: ss_n700_series_kyushu_cab_rev;              // Car 8    Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_graphics_6car, position_in_articulated_veh) {					
	    2:  ss_n700_series_kyushu_cab; 	                // Car 1	Car 6								
	    6:  sw_n700_series_kyushu_reverser_P_P;	        // Car 2	Car 5	    						
	    10:  sw_n700_series_kyushu_reverser_C_C;        // Car 3    Car 4
	    14: sw_n700_series_kyushu_reverser_C_C;         // Car 4    Car 3
        18: sw_n700_series_kyushu_reverser_P_P;         // Car 5    Car 2
        22: ss_n700_series_kyushu_cab_rev;              // Car 6    Car 1
	    dummy_sprites;
    }

    switch(FEAT_TRAINS, SELF, sw_n700_series_kyushu_graphics_year_dep, build_year) {
        0..2022: sw_n700_series_kyushu_graphics_8car;            // N700 Kyushu
        sw_n700_series_kyushu_graphics_6car;               // N700S Koname
    }
    
    switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_graphics, cargo_subtype) {
        0: sw_n700_series_kyushu_graphics_year_dep;
        1: sw_n700_series_kyushu_graphics_8car;
        sw_n700_series_kyushu_graphics_6car;
    }

/* ASSEMBLE */
	switch (FEAT_TRAINS, SELF, sw_n700_series_kyushu_articulated_part, extra_callback_info1) {
		1 .. 23: return series_n700_kyushu;										// Should be same as range above
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/n700_series/n700_series_fixed.pnml" 3

item(FEAT_TRAINS, series_n700) {
	property {
		/* Menu */
        name: 							string(STR_NAME_N700_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2007,07,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
		speed:                          301 km/h;				    // Overwritten by callback
    	power:                          22900 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_N700_SERIES);
        cargo_subtype_text:             sw_n700_series_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
        /* Graphics */
        default:                        sw_n700_series_graphics;
		purchase:                       sw_n700_series_year_dep_purchase;
		articulated_part:               sw_n700_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_n700_series_length;
        weight:                         sw_n700_series_weight;
        power:                          power_per_motor_n700_series * 4 * sw_n700_series_number_of_motor_cars();
		speed:							sw_n700_series_speed;
		cargo_capacity:                 sw_n700_series_cargo_capacity;
		loading_speed:					sw_n700_series_loading_speed;
		cost_factor:                    554;
        refit_cost:                     sw_n700_series_refit_cost;
		running_cost_factor:            sw_n700_series_running_costs;
		purchase_running_cost_factor:   running_cost_n700_series * sw_n700_series_number_of_cars();
	}
}

item(FEAT_TRAINS, series_n700_kyushu) {
	property {
		/* Menu */
        name: 							string(STR_NAME_N700_SERIES_KYUSHU);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,12);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// Default 185 x 1.5
		/* Stats */
		speed:                          301 km/h;				    // Operational Top Speed
    	power:                          22900 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_N700_SERIES_KYUSHU);
        cargo_subtype_text:             sw_n700_series_kyushu_subtype_text;
        /* Graphics */
        default:                        sw_n700_series_kyushu_graphics;
		purchase:                       sw_n700_series_kyushu_year_dep_purchase;
		articulated_part:               sw_n700_series_kyushu_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_n700_series_kyushu_length;
        weight:                         sw_n700_series_kyushu_weight;
        power:                          power_per_motor_n700_series_kyushu * 4 * sw_n700_series_kyushu_number_of_motor_cars();
		cargo_capacity:                 sw_n700_series_kyushu_cargo_capacity;
		loading_speed:					sw_n700_series_kyushu_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    sw_n700_series_kyushu_cost_factor;
        refit_cost:                     sw_n700_series_kyushu_refit_cost;
		running_cost_factor:            sw_n700_series_kyushu_running_costs;
		purchase_running_cost_factor:   running_cost_n700_series_kyushu * sw_n700_series_kyushu_number_of_cars();
	}
}

/* End N700 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/700_series/700_series_fixed.pnml" 1
/* Begin 700 Series */

# 1 "src/trains/700_series/700_series_subtypes.pnml" 1
/* Begin 700 Series SUBTYPES*/

    switch(FEAT_TRAINS, SELF, sw_700_series_subtype_text, cargo_subtype) {
	    0: return string(LV_700_SERIES_ORIGINAL);
        1: return string(LV_700_SERIES_HIKARI);
        return CB_RESULT_NO_TEXT;
        }
# 1 "src/trains/700_series/700_series_fixed.pnml" 3
# 1 "src/trains/700_series/700_series_gfx.pnml" 1
/* Begin 700 Series SPRITES */

    /* Purchase Menu */
    spriteset (ss_700_series_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_700_series_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/700_series/purchase.png") {template_purchase(0, 0)}

    /* EMU Parts */

    /* "CAB" */
    spriteset(ss_700_series_cab_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_cab_rev_original_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_cab_hikari_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_cab_rev_hikari_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 700 Series Original Strip Livery
    alternative_sprites(ss_700_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_standard(1,1)}
    alternative_sprites(ss_700_series_cab_rev_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_reversed(1,41)}		

    // 700 Series Hikari Strip Livery
    alternative_sprites(ss_700_series_cab_hikari_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_standard(1,1)}
    alternative_sprites(ss_700_series_cab_rev_hikari_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_reversed(1,41)}

    /* COACH */
    spriteset(ss_700_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_coach_hikari_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_coach_rev_hikari_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 700 Series Original Strip Livery
    alternative_sprites(ss_700_series_coach_original_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_standard(1,121)}
    alternative_sprites(ss_700_series_coach_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_reversed(1,121)}

    // 700 Series Hikari Strip Livery
    alternative_sprites(ss_700_series_coach_hikari_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_standard(1,121)}
    alternative_sprites(ss_700_series_coach_rev_hikari_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_reversed(1,121)}	

    // Coach Panto
    spriteset(ss_700_series_panto_original_livery,          		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_panto_rev_original_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_panto_hikari_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_panto_rev_hikari_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 700 Series Original Strip Livery
    alternative_sprites(ss_700_series_panto_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/700_series/original.png") {template_12_standard(1,81)}
    alternative_sprites(ss_700_series_panto_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/700_series/original.png") {template_12_reversed(1,81)}	

    // 700 Series Hikari Strip Livery
    alternative_sprites(ss_700_series_panto_hikari_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_standard(1,81)}
    alternative_sprites(ss_700_series_panto_rev_hikari_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_reversed(1,81)}	
# 1 "src/trains/700_series/700_series_fixed.pnml" 3
# 1 "src/trains/700_series/700_series_liveries.pnml" 1
/* Begin 700 Series LIVERIES */

    // CAB

    switch(FEAT_TRAINS, SELF, ss_700_series_cab, cargo_subtype) {
        1: ss_700_series_cab_hikari_livery;
        ss_700_series_cab_original_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_700_series_cab_rev, cargo_subtype) {
        1: ss_700_series_cab_rev_hikari_livery;
        ss_700_series_cab_rev_original_livery;
    }

    // COACH

    switch(FEAT_TRAINS, SELF, ss_700_series_coach, cargo_subtype) {
        1: ss_700_series_coach_hikari_livery;
        ss_700_series_coach_original_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_700_series_coach_rev, cargo_subtype) {
        1: ss_700_series_coach_rev_hikari_livery;
        ss_700_series_coach_rev_original_livery;
    }

    // PANTO

    switch(FEAT_TRAINS, SELF, ss_700_series_panto, cargo_subtype) {
        1: ss_700_series_panto_hikari_livery;
        ss_700_series_panto_original_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_700_series_panto_rev, cargo_subtype) {
        1: ss_700_series_panto_rev_hikari_livery;
        ss_700_series_panto_rev_original_livery;
    }
# 1 "src/trains/700_series/700_series_fixed.pnml" 3
# 1 "src/trains/700_series/700_series_stats.pnml" 1
/* Begin 700 Series STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_700_series_number_of_cars, cargo_subtype) {
            1: return 8;     
            return 16;       
        }

    switch(FEAT_TRAINS, SELF, sw_700_series_number_of_motor_cars, cargo_subtype) {
            1: return 6;        // 6M 2T  
            return 12;          // 12M 4T
        }

/* LENGTH */
    switch (FEAT_TRAINS, SELF, sw_700_series_length, cargo_subtype) {
        1: sw_length_1_1_7_1_1_1;
        sw_length_2_8_2;
    }

/* WEIGHT */
    weight_700_series = 44;           // 44t per JPS

/* POWER */
    power_per_motor_700_series = 369; // in hp (275 kW)

/* RUNNING COSTS */
    running_cost_700_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_700_series_running_costs, current_speed) {
        0: running_cost_700_series / 10 * sw_700_series_number_of_cars();           // Stopped
        1..15: running_cost_700_series / 4 * sw_700_series_number_of_cars(); 	    // Moving below ~33.5 mph
        running_cost_700_series * sw_700_series_number_of_cars(); 				    // Track speed
    }

/* CARGO CAPACITY 

    16-car JPS  1248/1560/1872/2184
    8-car JPS   624/780/936/1092

        16-car  8-car
    IRL 1323    571
    RW  1344    576        
    LS  2016    864    
    DC  2688    1152         
*/

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_700_series_param_cargo_capacity_16car, param_basecapacity) {
        0: return 28;       // 1x Real World Capacity
        2: return 56;       // 2x Double Real World Capacity
        return 42;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_700_series_param_cargo_capacity_8car, param_basecapacity) {
        0: return 12;       // 1x Real World Capacity
        2: return 24;       // 2x Double Real World Capacity
        return 18;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_700_series_cargo_capacity, cargo_subtype) {
        1: sw_700_series_param_cargo_capacity_8car;
        sw_700_series_param_cargo_capacity_16car;  
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_700_series_loading_speed_16car, param_basecapacity) {
        0: return 28 / param_loading_2D;        // 1x Real World Capacity
        2: return 56 / param_loading_2D;        // 2x Double Real World Capacity
        return 42 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_700_series_loading_speed_08car, param_basecapacity) {
        0: return 12 / param_loading_2D;        // 1x Real World Capacity
        2: return 24 / param_loading_2D;        // 2x Double Real World Capacity
        return 18 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_loading_speed, cargo_subtype) {
        1: sw_700_series_loading_speed_08car;
        sw_700_series_loading_speed_16car;
    }

/* REFIT COST */
    switch(FEAT_TRAINS, SELF, sw_700_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
	    -1:				8;
	    0:				0;
	    1:				-8;
	    return CB_FAILED;
    }
# 1 "src/trains/700_series/700_series_fixed.pnml" 3
# 1 "src/trains/700_series/700_series_formation.pnml" 1
/* Begin 700 Series */

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_700_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_700_series_coach;
	    ss_700_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_700_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_700_series_panto;
	    ss_700_series_panto_rev;
    }

/* PUT TOGETHER THE EMU*/

    /* Select the correct part of the train */
    switch (FEAT_TRAINS, SELF, sw_700_series_graphics_16car, position_in_articulated_veh) {					
	    1:  ss_700_series_cab; 	                // Car 1	Car 16								
	    4:  sw_700_series_reverser_C_C;	        // Car 2	Car 15	    						
	    7:  sw_700_series_reverser_C_C;         // Car 3    Car 14
	    10: sw_700_series_reverser_C_C;         // Car 4    Car 13
        13: sw_700_series_reverser_P_P;         // Car 5    Car 12
        16: sw_700_series_reverser_C_C;         // Car 6    Car 11
        19: sw_700_series_reverser_C_C;         // Car 7    Car 10
	    22: sw_700_series_reverser_C_C;         // Car 8    Car 9
        25: sw_700_series_reverser_C_C;         // Car 9    Car 8
        28: sw_700_series_reverser_C_C;         // Car 10   Car 7
        31: sw_700_series_reverser_C_C;         // Car 11   Car 6
        34: sw_700_series_reverser_P_P;         // Car 12   Car 5
        37: sw_700_series_reverser_C_C;         // Car 13   Car 4
        40: sw_700_series_reverser_C_C;         // Car 14   Car 3
        43: sw_700_series_reverser_C_C;         // Car 15   Car 2
        46: ss_700_series_cab_rev;              // Car 16   Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_graphics_8car, position_in_articulated_veh) {					
	    2:  ss_700_series_cab; 	                // Car 1	Car 8								
	    8:  sw_700_series_reverser_P_P;	        // Car 2	Car 7	    						
	    14: sw_700_series_reverser_C_C;         // Car 3    Car 6
	    20: sw_700_series_reverser_C_C;         // Car 4    Car 5
        26: sw_700_series_reverser_C_C;         // Car 5    Car 4
        32: sw_700_series_reverser_C_C;         // Car 6    Car 3
        38: sw_700_series_reverser_P_P;         // Car 7    Car 2
        44: ss_700_series_cab_rev;              // Car 8    Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_graphics, cargo_subtype) {
        1: sw_700_series_graphics_8car;
        sw_700_series_graphics_16car;
    }

/* Assemble an 16-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_700_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_700;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/700_series/700_series_fixed.pnml" 3

item(FEAT_TRAINS, series_700) {
	property {
		/* Menu */
        name: 							string(STR_NAME_700_SERIES);
        sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1999,03,13);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          286 km/h;				    // Operational Top Speed
		power:                          8050 kW;					// Overwritten by callback
		weight:                         648 tons;					// Overwritten by callback
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_700_SERIES);
        cargo_subtype_text:             sw_700_series_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
        /* Graphics */
        default:                        sw_700_series_graphics;
		purchase:                       ss_700_series_buy;
		articulated_part:               sw_700_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_700_series_length;
        weight:                         weight_700_series * sw_700_series_number_of_cars();
        power:                          power_per_motor_700_series * 4 * sw_700_series_number_of_motor_cars();
		cargo_capacity:                 sw_700_series_cargo_capacity;
		loading_speed:					sw_700_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    538;
		refit_cost:						sw_700_series_refit_cost;
		running_cost_factor:            sw_700_series_running_costs;
		purchase_running_cost_factor:   running_cost_700_series * sw_700_series_number_of_cars();
	}
}

/* End 700 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/500_series/500_series_fixed.pnml" 1
/* Begin 500 Series */

# 1 "src/trains/500_series/500_series_subtypes.pnml" 1
/* 500 Series CARGO SUBTYPE MENU*/

    switch(FEAT_TRAINS, SELF, sw_500_series_subtype_text, cargo_subtype) {
	    0: return string(LV_500_SERIES_16CAR);        // 16 Car Original
        1: return string(LV_500_SERIES_12CAR);        // 12 Car Original
        2: return string(LV_500_SERIES_08CAR);        // 08 Car Original
        return CB_RESULT_NO_TEXT;
        }
# 1 "src/trains/500_series/500_series_fixed.pnml" 3
# 1 "src/trains/500_series/500_series_gfx.pnml" 1
/* Begin 500 Series GRAPHICS */

    // Purchase Menu
    spriteset (ss_500_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_500_series_buy,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_500_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_500_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_500_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_500_series_cab_rev,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_500_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_500_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_500_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_500_series_coach_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_500_series_panto,          		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_500_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_500_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_500_series_panto_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_reversed(1,81)}	
# 1 "src/trains/500_series/500_series_fixed.pnml" 3
// #include "src/trains/500_series/500_series_liveries.pnml"
# 1 "src/trains/500_series/500_series_stats.pnml" 1
/* Begin 500 Series STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_500_series_number_of_cars, cargo_subtype) {
            1: return 12; 
            2: return 8;     
            return 16;       
        }

    switch(FEAT_TRAINS, SELF, sw_500_series_number_of_motor_cars, cargo_subtype) {
            1: return 12;        // All motorised
            2: return 8;        // All motorised  
            return 16;          // All motorised
        }

/* LENGTH */
    switch (FEAT_TRAINS, SELF, sw_500_series_length, cargo_subtype) {
        1: sw_length_1_1_8_2;
        2: sw_length_1_1_7_1_1_1;
        sw_length_2_8_2;
    }

/* WEIGHT */
    weight_500_series = 42;           // 42 tons from https://web-japan.org/atlas/technology/tec08.html	

/* POWER */
    power_per_motor_500_series = 382; // in hp (285 kW)

/* RUNNING COSTS */
    running_cost_500_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_500_series_running_costs, current_speed) {
        0: running_cost_500_series / 10 * sw_500_series_number_of_cars();           // Stopped
        1..15: running_cost_500_series / 4 * sw_500_series_number_of_cars(); 	    // Moving below ~33.5 mph
        running_cost_500_series * sw_500_series_number_of_cars(); 				    // Track speed
    }

/* CARGO CAPACITY 

    16-car JPS  1248/1560/1872/2184
    08-car JPS  624/780/936/1092

        16-car  8-car
    IRL 1324    608
    RW  1344    624       
    LS  2016      
    DC  2688           
*/

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_500_series_cargo_capacity_16car, param_basecapacity) {
        0: return 28;       // 1x Real World Capacity
        2: return 56;       // 2x Double Real World Capacity
        return 42;          // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_500_series_cargo_capacity_12car, param_basecapacity) {
        0: return 20;       // 1x Real World Capacity
        2: return 40;       // 2x Double Real World Capacity
        return 30;          // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_500_series_cargo_capacity_08car, param_basecapacity) {
        0: return 13;       // 1x Real World Capacity
        2: return 26;       // 2x Double Real World Capacity
        return 20;          // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_500_series_cargo_capacity, cargo_subtype) {
        1: sw_500_series_cargo_capacity_12car;
        2: sw_500_series_cargo_capacity_08car;
        sw_500_series_cargo_capacity_16car;
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_500_series_loading_speed_16car, param_basecapacity) {
        0: return 28 / param_loading_2D;        // 1x Real World Capacity
        2: return 56 / param_loading_2D;        // 2x Double Real World Capacity
        return 42 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_500_series_loading_speed_12car, param_basecapacity) {
        0: return 20 / param_loading_2D;        // 1x Real World Capacity
        2: return 40 / param_loading_2D;        // 2x Double Real World Capacity
        return 30 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_500_series_loading_speed_08car, param_basecapacity) {
        0: return 13 / param_loading_2D;        // 1x Real World Capacity
        2: return 26 / param_loading_2D;        // 2x Double Real World Capacity
        return 20 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_500_series_loading_speed, cargo_subtype) {
        1: sw_500_series_loading_speed_12car;
        2: sw_500_series_loading_speed_08car;
        sw_500_series_loading_speed_16car;
    }

/* REFIT COST */
   
    switch(FEAT_TRAINS, SELF, sw_500_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    

        -2:				8;
	    -1:				4;
	    0:				0;
	    1:				-4;
	    2:				-8;
    }
# 1 "src/trains/500_series/500_series_fixed.pnml" 3
# 1 "src/trains/500_series/500_series_formation.pnml" 1
/* Begin 500 Series FORMATION */

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_C_P, vehicle_is_reversed) {
	    0: ss_500_series_coach;
	    ss_500_series_panto_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_500_series_coach;
	    ss_500_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_P_C, vehicle_is_reversed) {
	    0: ss_500_series_panto;
	    ss_500_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_500_series_panto;
	    ss_500_series_panto_rev;
    }

/* PUT TOGETHER THE EMU*/

    // 16 Car Set
    switch (FEAT_TRAINS, SELF, sw_500_series_graphics_16car, position_in_articulated_veh) {					
	    1:  ss_500_series_cab; 	            // Car 1	Car 16								
	    4:  sw_500_series_reverser_C_C;	    // Car 2	Car 15	    						
	    7:  sw_500_series_reverser_C_C;     // Car 3    Car 14
	    10: sw_500_series_reverser_C_P;     // Car 4    Car 13
        13: sw_500_series_reverser_P_C;     // Car 5    Car 12
        16: sw_500_series_reverser_C_C;     // Car 6    Car 11
        19: sw_500_series_reverser_C_C;     // Car 7    Car 10
	    22: sw_500_series_reverser_C_C;     // Car 8    Car 9
        25: sw_500_series_reverser_C_C;     // Car 9    Car 8
        28: sw_500_series_reverser_C_C;     // Car 10   Car 7
        31: sw_500_series_reverser_C_C;     // Car 11   Car 6
        34: sw_500_series_reverser_C_P;     // Car 12   Car 5
        37: sw_500_series_reverser_P_C;     // Car 13   Car 4
        40: sw_500_series_reverser_C_C;     // Car 14   Car 3
        43: sw_500_series_reverser_C_C;     // Car 15   Car 2
        46: ss_500_series_cab_rev;          // Car 16   Car 1 
	    dummy_sprites;
    }

    // 12 Car Set
    switch (FEAT_TRAINS, SELF, sw_500_series_graphics_12car, position_in_articulated_veh) {					
	    2:  ss_500_series_cab; 	            // Car 1	Car 12								
	    6:  sw_500_series_reverser_C_C;	    // Car 2	Car 11	    						
	    10: sw_500_series_reverser_C_C;     // Car 3    Car 10
	    14: sw_500_series_reverser_C_P;     // Car 4    Car 9
        18: sw_500_series_reverser_P_C;     // Car 5    Car 8
        22: sw_500_series_reverser_C_C;     // Car 6    Car 7
        26: sw_500_series_reverser_C_C;     // Car 7    Car 6
	    30: sw_500_series_reverser_C_P;     // Car 8    Car 5
        34: sw_500_series_reverser_P_C;     // Car 9    Car 4
        38: sw_500_series_reverser_C_C;     // Car 10   Car 3
        42: sw_500_series_reverser_C_C;     // Car 11   Car 2
        46: ss_500_series_cab_rev;          // Car 12   Car 1 
	    dummy_sprites;
    }

    // 8 car set
    switch (FEAT_TRAINS, SELF, sw_500_series_graphics_08car, position_in_articulated_veh) {					
	    2:  ss_500_series_cab; 	                // Car 1	Car 8								
	    8:  sw_500_series_reverser_P_P;	        // Car 2	Car 7	    						
	    14: sw_500_series_reverser_C_C;         // Car 3    Car 6
	    20: sw_500_series_reverser_C_C;         // Car 4    Car 5
        26: sw_500_series_reverser_C_C;         // Car 5    Car 4
        32: sw_500_series_reverser_C_C;         // Car 6    Car 3
        38: sw_500_series_reverser_P_P;         // Car 7    Car 2
        44: ss_500_series_cab_rev;              // Car 8    Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_500_series_graphics, cargo_subtype) {
        1: sw_500_series_graphics_12car;
        2: sw_500_series_graphics_08car;
        sw_500_series_graphics_16car;
    }

    /* Assemble an articulated vehicle. */
    switch (FEAT_TRAINS, SELF, sw_500_series_articulated_part, extra_callback_info1) {
	    1 .. 47: return series_500;										// Should be same as range above
	    return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }
# 1 "src/trains/500_series/500_series_fixed.pnml" 3

item(FEAT_TRAINS, series_500) {
	property {
		/* Menu */
		name: 							string(STR_NAME_500_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          301 km/h;				
		power:                          18240 kW;	                // Changed by callback		
		weight:                         42*16 tons;	                // Changed by callback			
		tractive_effort_coefficient:    0.3;                        // Standard
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_500_SERIES);
		cargo_subtype_text:             sw_500_series_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
		/* Graphics */
		default:                        sw_500_series_graphics;
		purchase:                       ss_500_series_buy;
		articulated_part:               sw_500_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_500_series_length;
		weight:							weight_500_series * sw_500_series_number_of_cars();
		power:							power_per_motor_500_series * 4 * sw_500_series_number_of_motor_cars();
		cargo_capacity:                 sw_500_series_cargo_capacity;
		loading_speed:					sw_500_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    612;
		refit_cost:                     sw_500_series_refit_cost;
		running_cost_factor:            sw_500_series_running_costs;
		purchase_running_cost_factor:   running_cost_500_series * sw_500_series_number_of_cars();	
	}
}

/* End 500 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/300_series/300_series_fixed.pnml" 1
/* Begin 300 Series */

# 1 "src/trains/300_series/300_series_subtypes.pnml" 1
/* 300 Series CARGO SUBTYPE MENU*/

    switch(FEAT_TRAINS, SELF, sw_300_series_subtype_text, cargo_subtype) {
	    0: return string(LV_300_SERIES_16CAR);        // 16 Car Original
        1: return string(LV_300_SERIES_12CAR);        // 12 Car Original
        2: return string(LV_300_SERIES_08CAR);        // 08 Car Original
        return CB_RESULT_NO_TEXT;
        }
# 1 "src/trains/300_series/300_series_fixed.pnml" 3
# 1 "src/trains/300_series/300_series_gfx.pnml" 1
/* Begin 300 Series SPRITES*/

    // Purchase Menu
    spriteset (ss_300_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_300_series_buy,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_300_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_300_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_300_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_300_series_cab_rev,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_300_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_300_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_300_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_300_series_coach_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_300_series_panto,          		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_300_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_300_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_300_series_panto_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_reversed(1,81)}	
# 1 "src/trains/300_series/300_series_fixed.pnml" 3
// #include "src/trains/300_series/300_series_liveries.pnml"
# 1 "src/trains/300_series/300_series_stats.pnml" 1
/* Begin 300 Series STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_300_series_number_of_cars, cargo_subtype) {
            1: return 12; 
            2: return 8;     
            return 16;       
        }

    switch(FEAT_TRAINS, SELF, sw_300_series_number_of_motor_cars, cargo_subtype) {
            1: return 8;        // 8M 4T
            2: return 6;        // 6M 2T 
            return 10;          // 10M 6T
        }

/* LENGTH */
    switch (FEAT_TRAINS, SELF, sw_300_series_length, cargo_subtype) {
        1: sw_length_1_1_8_2;
        2: sw_length_1_1_7_1_1_1;
        sw_length_2_8_2;
    }

/* WEIGHT */
    weight_300_series = 44;           // 42 tons from https://web-japan.org/atlas/technology/tec08.html	

/* POWER */
    power_per_motor_300_series = 402; // in hp (300 kW)

/* RUNNING COSTS */
    running_cost_300_series = 187;                  // 150 is approx JPS
    
    switch(FEAT_TRAINS, SELF, sw_300_series_running_costs, current_speed) {
        0: running_cost_300_series / 10 * sw_300_series_number_of_cars();       // Stopped
        1..15: running_cost_300_series / 4 * sw_300_series_number_of_cars(); 	// Moving below ~33.5 mph
        running_cost_300_series * sw_300_series_number_of_cars(); 				// Track speed
    }

/* CARGO CAPACITY 

    16-car JPS  1248/1560/1872/2184
    08-car JPS  624/780/936/1092

        16-car
    IRL 1323
    RW  1344       
    LS  2016   
    DC  2688        
*/

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_300_series_cargo_capacity_16car, param_basecapacity) {
        0: return 28;       // 1x Real World Capacity
        2: return 56;       // 2x Double Real World Capacity
        return 42;          // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_300_series_cargo_capacity_12car, param_basecapacity) {
        0: return 20;       // 1x Real World Capacity
        2: return 40;       // 2x Double Real World Capacity
        return 30;          // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_300_series_cargo_capacity_08car, param_basecapacity) {
        0: return 13;       // 1x Real World Capacity
        2: return 26;       // 2x Double Real World Capacity
        return 20;          // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_300_series_cargo_capacity, cargo_subtype) {
        1: sw_300_series_cargo_capacity_12car;
        2: sw_300_series_cargo_capacity_08car;
        sw_300_series_cargo_capacity_16car;
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_300_series_loading_speed_16car, param_basecapacity) {
        0: return 28 / param_loading_2D;        // 1x Real World Capacity
        2: return 56 / param_loading_2D;        // 2x Double Real World Capacity
        return 42 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_300_series_loading_speed_12car, param_basecapacity) {
        0: return 20 / param_loading_2D;        // 1x Real World Capacity
        2: return 40 / param_loading_2D;        // 2x Double Real World Capacity
        return 30 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_300_series_loading_speed_08car, param_basecapacity) {
        0: return 13 / param_loading_2D;        // 1x Real World Capacity
        2: return 26 / param_loading_2D;        // 2x Double Real World Capacity
        return 20 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_300_series_loading_speed, cargo_subtype) {
        1: sw_300_series_loading_speed_12car;
        2: sw_300_series_loading_speed_08car;
        sw_300_series_loading_speed_16car;
    }

/* REFIT COST */
   
    switch(FEAT_TRAINS, SELF, sw_300_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    

        -2:				8;
	    -1:				4;
	    0:				0;
	    1:				-4;
	    2:				-8;
    }
# 1 "src/trains/300_series/300_series_fixed.pnml" 3
# 1 "src/trains/300_series/300_series_formation.pnml" 1
/* Begin 300 Series FORMATION*/

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_C_P, vehicle_is_reversed) {
	    0: ss_300_series_coach;
	    ss_300_series_panto_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_300_series_coach;
	    ss_300_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_P_C, vehicle_is_reversed) {
	    0: ss_300_series_panto;
	    ss_300_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_300_series_panto;
	    ss_300_series_panto_rev;
    }

/* PUT TOGETHER THE EMU*/

    // 16 Car Set
    switch (FEAT_TRAINS, SELF, sw_300_series_graphics_16car, position_in_articulated_veh) {					
	    1:  ss_300_series_cab; 	            // Car 1	Car 16								
	    4:  sw_300_series_reverser_C_C;	    // Car 2	Car 15	    						
	    7:  sw_300_series_reverser_C_C;     // Car 3    Car 14
	    10: sw_300_series_reverser_C_C;     // Car 4    Car 13
        13: sw_300_series_reverser_C_P;     // Car 5    Car 12
        16: sw_300_series_reverser_P_C;     // Car 6    Car 11
        19: sw_300_series_reverser_C_C;     // Car 7    Car 10
	    22: sw_300_series_reverser_C_C;     // Car 8    Car 9
        25: sw_300_series_reverser_C_C;     // Car 9    Car 8
        28: sw_300_series_reverser_C_C;     // Car 10   Car 7
        31: sw_300_series_reverser_C_P;     // Car 11   Car 6
        34: sw_300_series_reverser_P_C;     // Car 12   Car 5
        37: sw_300_series_reverser_C_C;     // Car 13   Car 4
        40: sw_300_series_reverser_C_C;     // Car 14   Car 3
        43: sw_300_series_reverser_C_C;     // Car 15   Car 2
        46: ss_300_series_cab_rev;          // Car 16   Car 1 
	    dummy_sprites;
    }

    // 12 Car Set
    switch (FEAT_TRAINS, SELF, sw_300_series_graphics_12car, position_in_articulated_veh) {					
	    2:  ss_300_series_cab; 	            // Car 1	Car 12								
	    6:  sw_300_series_reverser_C_C;	    // Car 2	Car 11	    						
	    10: sw_300_series_reverser_C_C;     // Car 3    Car 10
	    14: sw_300_series_reverser_C_P;     // Car 4    Car 9
        18: sw_300_series_reverser_P_C;     // Car 5    Car 8
        22: sw_300_series_reverser_C_C;     // Car 6    Car 7
        26: sw_300_series_reverser_C_C;     // Car 7    Car 6
	    30: sw_300_series_reverser_C_P;     // Car 8    Car 5
        34: sw_300_series_reverser_P_C;     // Car 9    Car 4
        38: sw_300_series_reverser_C_C;     // Car 10   Car 3
        42: sw_300_series_reverser_C_C;     // Car 11   Car 2
        46: ss_300_series_cab_rev;          // Car 12   Car 1 
	    dummy_sprites;
    }

    // 8 car set
    switch (FEAT_TRAINS, SELF, sw_300_series_graphics_08car, position_in_articulated_veh) {					
	    2:  ss_300_series_cab; 	                // Car 1	Car 8								
	    8:  sw_300_series_reverser_P_P;	        // Car 2	Car 7	    						
	    14: sw_300_series_reverser_C_C;         // Car 3    Car 6
	    20: sw_300_series_reverser_C_C;         // Car 4    Car 5
        26: sw_300_series_reverser_C_C;         // Car 5    Car 4
        32: sw_300_series_reverser_C_C;         // Car 6    Car 3
        38: sw_300_series_reverser_P_P;         // Car 7    Car 2
        44: ss_300_series_cab_rev;              // Car 8    Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_300_series_graphics, cargo_subtype) {
        1: sw_300_series_graphics_12car;
        2: sw_300_series_graphics_08car;
        sw_300_series_graphics_16car;
    }

    /* Assemble an articulated vehicle. */
    switch (FEAT_TRAINS, SELF, sw_300_series_articulated_part, extra_callback_info1) {
	    1 .. 47: return series_300;										// Should be same as range above
	    return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }
# 1 "src/trains/300_series/300_series_fixed.pnml" 3

item(FEAT_TRAINS, series_300) {
	property {
		/* Menu */
        name: 							string(STR_NAME_300_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1992,03,01);
		model_life:                     30;		                    // In service from 1992,03,01 to 2012,03,16
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
        ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          271 km/h;					// Agreed to Wikipedia					
		power:                          402*4*10 hp;            	// 300kw x 10 motorised cars x 4 per car				
		weight:                         44*16 tons;	                // 44t (per JPS) x 16 cars				
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_300_SERIES);
        cargo_subtype_text:             sw_300_series_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
        /* Graphics */
        default:                        sw_300_series_graphics;
		purchase:                       ss_300_series_buy;
		articulated_part:               sw_300_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_300_series_length;
        power:                          power_per_motor_300_series * 4 * sw_300_series_number_of_motor_cars();
        weight:                         weight_300_series * sw_300_series_number_of_cars();
		cargo_capacity:                 sw_300_series_cargo_capacity;
		loading_speed:					sw_300_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    548;
		refit_cost:                     sw_300_series_refit_cost;
		running_cost_factor:            sw_300_series_running_costs;
		purchase_running_cost_factor:   running_cost_300_series * sw_300_series_number_of_cars();	
	}
}

/* End 300 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/100_series/100_series_fixed.pnml" 1
/* Begin 100 Series */

# 1 "src/trains/100_series/100_series_subtypes.pnml" 1
/* Begin 100 Series SUBTYPES*/

// From 1985 to 1988
switch(FEAT_TRAINS, SELF, sw_100_series_1985_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);       // Year Dependent Livery
	1: return string(LV_100_SERIES_X_16);       // 16-car set
    2: return string(LV_100_SERIES_X_12);       // 12-car set
       return CB_RESULT_NO_TEXT;
    }

// From 1988 to 2000 - introduction of V set with more double decker cars
switch(FEAT_TRAINS, SELF, sw_100_series_1988_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);       // Year Dependent Livery
	1: return string(LV_100_SERIES_X_16);       // 16-car set
    2: return string(LV_100_SERIES_X_12);       // 12-car set
    3: return string(LV_100_SERIES_V);          // 16-car ser with bilevel
       return CB_RESULT_NO_TEXT;
    }

// From 2000 onwards - introduction of Kodama Livery
switch(FEAT_TRAINS, SELF, sw_100_series_2000_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);       // Year Dependent Livery
	1: return string(LV_100_SERIES_X_16);       // 16-car set
    2: return string(LV_100_SERIES_X_12);       // 12-car set
    3: return string(LV_100_SERIES_V);          // 16-car ser with bilevel
    4: return string(LV_100_SERIES_KODAMA);     // 8-car ser with Kodama livery 
       return CB_RESULT_NO_TEXT;
    }

// SUBTYPE MENU over time
switch(FEAT_TRAINS, SELF, sw_100_series_year_dep_subtype_text, current_year) {
    0..1987: sw_100_series_1985_subtype_text;
    1988..1999: sw_100_series_1988_subtype_text;
    sw_100_series_2000_subtype_text;
}
# 1 "src/trains/100_series/100_series_fixed.pnml" 3
# 1 "src/trains/100_series/100_series_gfx.pnml" 1
/* Begin 100 Series GRAPHICS */

/* SPRITES */

/* Purchase Menu */
spriteset (ss_100_series_buy_original_jnr,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_original_jrc,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_original_c_w,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_kodama_c_w,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_kodama_jrw,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

alternative_sprites(ss_100_series_buy_original_jnr,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_original_jnr.png") {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_original_jrc,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_original_jrc.png") {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_original_c_w,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_original_c&w.png") {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_kodama_c_w,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_kodama_c&w.png")   {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_kodama_jrw,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_kodama_jrw.png")   {template_purchase(0, 0)}

/* EMU Parts */

/* "CAB" */

spriteset(ss_100_series_cab_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_cab_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_cab_kodama_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_cab_rev_kodama_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_100_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,1)}
alternative_sprites(ss_100_series_cab_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,41)}		

// 200 Series Kodama Strip Livery
alternative_sprites(ss_100_series_cab_kodama_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_standard(1,1)}
alternative_sprites(ss_100_series_cab_rev_kodama_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_reversed(1,41)}	


/* "COACH" */

spriteset(ss_100_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_coach_kodama_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_coach_rev_kodama_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_100_series_coach_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_100_series_coach_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,121)}		

// 200 Series Kodama Strip Livery
alternative_sprites(ss_100_series_coach_kodama_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_standard(1,121)}
alternative_sprites(ss_100_series_coach_rev_kodama_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_reversed(1,121)}	


/* "PANTO" */

spriteset(ss_100_series_panto_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_panto_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_panto_kodama_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_panto_rev_kodama_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_100_series_panto_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_100_series_panto_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,81)}		

// 200 Series Kodama Strip Livery
alternative_sprites(ss_100_series_panto_kodama_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_standard(1,81)}
alternative_sprites(ss_100_series_panto_rev_kodama_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_reversed(1,81)}	


/* "DOUBLE DECKER" */

spriteset(ss_100_series_2deck,             	                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_2deck_rev,    		                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_2dec2,             	                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_2dec2_rev,    		                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 100 Series Original Livery
alternative_sprites(ss_100_series_2deck,                        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,161)}
alternative_sprites(ss_100_series_2deck_rev,                    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,161)}	
alternative_sprites(ss_100_series_2dec2,                        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,201)}
alternative_sprites(ss_100_series_2dec2_rev,                    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,201)}
# 1 "src/trains/100_series/100_series_fixed.pnml" 3
# 1 "src/trains/100_series/100_series_liveries.pnml" 1
/* Begin 100 Series LIVERIES*/

/* Purchase Menu */

    switch(FEAT_TRAINS, SELF, sw_100_series_year_dep_purchase, current_year) {
        0..1986: ss_100_series_buy_original_jnr;        // JNR (Original Livery)
        1987..1988: ss_100_series_buy_original_jrc;     // JR Central (Original Livery)
        1989..1999: ss_100_series_buy_original_c_w;     // JR Central & West (Original Livery)
        2000..2001: ss_100_series_buy_kodama_c_w;       // JR Central & West (Kodama Livery)
        ss_100_series_buy_kodama_jrw;                   // JR West (Kodama Livery)
    }

/* EMU Parts */

/* "CAB" */

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_year_dep_livery, build_year) {
    0..1999: ss_100_series_cab_original_livery;
    ss_100_series_cab_kodama_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_cab, cargo_subtype) {
    1: ss_100_series_cab_original_livery;       // Original
    2: ss_100_series_cab_original_livery;       // Original
    3: ss_100_series_cab_original_livery;       // Original
    4: ss_100_series_cab_kodama_livery;         // Kodama
    sw_100_series_cab_year_dep_livery;          // Year-dependent Livery
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev_year_dep_livery, build_year) {
    0..1999: ss_100_series_cab_rev_original_livery;
    ss_100_series_cab_rev_kodama_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev, cargo_subtype) {
    1: ss_100_series_cab_rev_original_livery;   // Original
    2: ss_100_series_cab_rev_original_livery;   // Original
    3: ss_100_series_cab_rev_original_livery;   // Original
    4: ss_100_series_cab_rev_kodama_livery;     // Kodama
    sw_100_series_cab_rev_year_dep_livery;      // Year-dependent Livery
}

/* "COACH" */

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_year_dep_livery, build_year) {
    0..1999: ss_100_series_coach_original_livery;
    ss_100_series_coach_kodama_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_coach, cargo_subtype) {
    1: ss_100_series_coach_original_livery;       // Original
    2: ss_100_series_coach_original_livery;       // Original
    3: ss_100_series_coach_original_livery;       // Original
    4: ss_100_series_coach_kodama_livery;         // Kodama
    sw_100_series_coach_year_dep_livery;          // Year-dependent Livery
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev_year_dep_livery, build_year) {
    0..1999: ss_100_series_coach_rev_original_livery;
    ss_100_series_coach_rev_kodama_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev, cargo_subtype) {
    1: ss_100_series_coach_rev_original_livery;   // Original
    2: ss_100_series_coach_rev_original_livery;   // Original
    3: ss_100_series_coach_rev_original_livery;   // Original
    4: ss_100_series_coach_rev_kodama_livery;     // Kodama
    sw_100_series_coach_rev_year_dep_livery;      // Year-dependent Livery
}

/* "PANTO" */

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_year_dep_livery, build_year) {
    0..1999: ss_100_series_panto_original_livery;
    ss_100_series_panto_kodama_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_panto, cargo_subtype) {
    1: ss_100_series_panto_original_livery;       // Original
    2: ss_100_series_panto_original_livery;       // Original
    3: ss_100_series_panto_original_livery;       // Original
    4: ss_100_series_panto_kodama_livery;         // Kodama
    sw_100_series_panto_year_dep_livery;          // Year-dependent Livery
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev_year_dep_livery, build_year) {
    0..1999: ss_100_series_panto_rev_original_livery;
    ss_100_series_panto_rev_kodama_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev, cargo_subtype) {
    1: ss_100_series_panto_rev_original_livery;   // Original
    2: ss_100_series_panto_rev_original_livery;   // Original
    3: ss_100_series_panto_rev_original_livery;   // Original
    4: ss_100_series_panto_rev_kodama_livery;     // Kodama
    sw_100_series_panto_rev_year_dep_livery;      // Year-dependent Livery
}
# 1 "src/trains/100_series/100_series_fixed.pnml" 3
# 1 "src/trains/100_series/100_series_stats.pnml" 1
/* Begin 100 Series STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_100_series_number_of_cars_year_dep, build_year) {
        0..1999: return 16;     // 16-car X_16
        return 8;               // 8-car Kodama
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_number_of_cars, cargo_subtype) {
            0: sw_100_series_number_of_cars_year_dep;
            2: return 12;
            4: return 8;     
            return 16;       
        }

    switch(FEAT_TRAINS, SELF, sw_100_series_number_of_motor_cars_year_dep, build_year) {
        0..1999: return 12;     // 16-car X_16
        return 8;               // 8-car Kodama
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_number_of_motor_cars, cargo_subtype) {
            0: sw_100_series_number_of_motor_cars_year_dep;
            2: return 10;       // 10M 2T  
            4: return 8;        // All cars motorised
            return 12;          // 12M 4T
        }

/* LENGTH*/

    switch(FEAT_TRAINS, SELF, sw_100_series_length_year_dep, build_year) {
        0..1999: sw_length_2_8_2;                   // 16-car
        sw_length_1_1_7_1_1_1;                      // 8-car
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_length, cargo_subtype) {
        0: sw_100_series_length_year_dep;           // Year Dependent
        2: sw_length_1_1_8_2;                       // 12-car
        4: sw_length_1_1_7_1_1_1;                   // 8-car
        sw_length_2_8_2;                            // All other 16-length sets
    }

/* RUNNING COSTS */
    running_cost_100_series = 187;                  // 150 is approx JPS
    
    switch(FEAT_TRAINS, SELF, sw_100_series_running_costs, current_speed) {
        0: running_cost_100_series / 10 * sw_100_series_number_of_cars();       // Stopped
        1..15: running_cost_100_series / 4 * sw_100_series_number_of_cars(); 	// Moving below ~33.5 mph
        running_cost_100_series * sw_100_series_number_of_cars(); 				// Track speed
    }

/* WEIGHT */  
    weight_100_series = 53;                         // 53t per JPS

/* POWER */
    power_per_motor_100_series = 308;               // in hp (230 kW)

/* SPEED */
    switch(FEAT_TRAINS, SELF, sw_100_series_speed, cargo_subtype) {
        0..3: return 220;   // Original speed
        return 230;         // Kodama speed
    }

/* CARGO CAPACITY 

    16-car JPS  1248/1560/1872/2184
    12-car JPS  936/1170/1404/1638
    8-car JPS   624/780/936/1092

        16-car(X)   16-car(V)   12-car  8-car
    IRL 1277        1285        1031    638* 
    RW  1296        1296        1056    624        
    LS  1920        1920        1440    960     
    DC  2592        2592        1968    1296         

    * made up since no length 8 sets

*/

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_100_series_param_cargo_capacity_16car, param_basecapacity) {
        0: return 27;       // 1x Real World Capacity
        2: return 54;       // 2x Double Real World Capacity
        return 40;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_100_series_param_cargo_capacity_12car, param_basecapacity) {
        0: return 22;       // 1x Real World Capacity
        2: return 41;       // 2x Double Real World Capacity
        return 30;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_100_series_param_cargo_capacity_8car, param_basecapacity) {
        0: return 13;       // 1x Real World Capacity
        2: return 27;       // 2x Double Real World Capacity
        return 20;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_100_series_cargo_capacity, cargo_subtype) {
        2: sw_100_series_param_cargo_capacity_12car;
        4: sw_100_series_param_cargo_capacity_8car;
        sw_100_series_param_cargo_capacity_16car;  
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_100_series_param_loading_speed_16car, param_basecapacity) {
        0: return 27 / param_loading_2D;        // 1x Real World Capacity
        2: return 54 / param_loading_2D;        // 2x Double Real World Capacity
        return 40 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_100_series_param_loading_speed_12car, param_basecapacity) {
        0: return 22 / param_loading_2D;        // 1x Real World Capacity
        2: return 41 / param_loading_2D;        // 2x Double Real World Capacity
        return 30 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_100_series_param_loading_speed_8car, param_basecapacity) {
        0: return 13 / param_loading_2D;        // 1x Real World Capacity
        2: return 27 / param_loading_2D;        // 2x Double Real World Capacity
        return 20 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_loading_speed, cargo_subtype) {
        2: sw_100_series_param_loading_speed_12car;
        4: sw_100_series_param_loading_speed_8car; 
        sw_100_series_param_loading_speed_16car;
    }

/* COST FACTOR */
    switch(FEAT_TRAINS, SELF, sw_100_series_cost_factor, build_year) {
        0..1999: return 526; 
        return 526/2;           
    }

/* REFIT COST */

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus4, build_year) {
        0..1999: return 7; // Kodama -> Year Dependent, if 0-1999, Cost, otherwise it's Kodama to Kodama so 0  
        return 0;
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus3_year_dep, build_year) {
        0..1999: return 0; 
        return -6;           
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus3, cargo_subtype) {
        4: return 7;            
        sw_100_series_refit_cost_minus3_year_dep;
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus2_year_dep, build_year) {
        0..1999: return 4; 
        return -3;           
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus2, cargo_subtype) {
        3: return 0;
        4: return 4;            
        sw_100_series_refit_cost_minus2_year_dep;
    }
    
    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus1_year_dep, build_year) {
        0..1999: return 0; 
        return -6;           
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_minus1, cargo_subtype) {
        2: return 4;           
        3: return -3; 
        4: return 7; 
        sw_100_series_refit_cost_minus1_year_dep;
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus1_year_dep, build_year) {
        0..1999: return 0; 
        return 4;           
    }
    
    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus1, cargo_subtype) {
        1: return -3;
        2: return 4;                     
        3: return -6;
        sw_100_series_refit_cost_plus1_year_dep;
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus2_year_dep, build_year) {
        0..1999: return -3; // Year Dependent -> X_12, if 0-1999, Refund, 
        return 4;           // Otherwise it's 'Kodama' to 'X_12' so cost 
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus2, cargo_subtype) {
        1: return 0;        // Currently 'X_16'moving to 'V' -> Nil  
        2: return -3;       // Currently 'X_12'moving to 'Kodama' -> Refund
        sw_100_series_refit_cost_plus2_year_dep;
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus3_year_dep, build_year) {
        0..1999: return 0;  // Year Dependent -> X_16, if 0-1999, Nil, 
        return 7;           // Otherwise it's 'Kodama' to 'V' so cost 
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus3, cargo_subtype) {
        1: return -6;      // Currently 'X_16', Refund to move to 'Kodama'   
        sw_100_series_refit_cost_plus3_year_dep;
    }


    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost_plus4, build_year) {
        0..1999: return -6; // Year Dependent -> Kodama, if 0-1999, Refund, otherwise it's Kodama to Kodama so 0  
        return 0;
    }

    switch(FEAT_TRAINS, SELF, sw_100_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
	    -4:             sw_100_series_refit_cost_minus4; 
        -3:             sw_100_series_refit_cost_minus3; 
        -2:				sw_100_series_refit_cost_minus2;
	    -1:				sw_100_series_refit_cost_minus1;
	    0:				0;
	    1:				sw_100_series_refit_cost_plus1;
	    2:				sw_100_series_refit_cost_plus2;
        3:              sw_100_series_refit_cost_plus3;
        4:              sw_100_series_refit_cost_plus4;
	    return CB_FAILED;
    }
# 1 "src/trains/100_series/100_series_fixed.pnml" 3
# 1 "src/trains/100_series/100_series_formation.pnml" 1
/* Begin 100 Series FORMATION */

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_C_P, vehicle_is_reversed) {
	0: sw_100_series_coach;
	sw_100_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_P_C, vehicle_is_reversed) {
	0: sw_100_series_panto;
	sw_100_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_B_D, vehicle_is_reversed) {
	0: ss_100_series_2dec2;
	ss_100_series_2deck_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_D_B, vehicle_is_reversed) {
	0: ss_100_series_2deck;
	ss_100_series_2dec2_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_D_D, vehicle_is_reversed) {
	0: ss_100_series_2deck;
	ss_100_series_2deck_rev;
}

/* PUT TOGETHER THE EMU*/

/* 16-car sets */
switch (FEAT_TRAINS, SELF, sw_100_series_graphics_16car_x, position_in_articulated_veh) {
                                        // 16-car   
    1:  sw_100_series_cab; 	            // Car 1    Car 16  	
	4:  sw_100_series_reverser_P_C;	    // Car 2    Car 15     	
	7:  sw_100_series_reverser_C_P;     // Car 3    Car 14   
	10: sw_100_series_reverser_P_C;     // Car 4    Car 13  
    13: sw_100_series_reverser_C_P;     // Car 5    Car 12  
    16: sw_100_series_reverser_P_C;     // Car 6    Car 11  
    19: sw_100_series_reverser_C_P;     // Car 7    Car 10   
	22: sw_100_series_reverser_D_B;     // Car 8    Car 9  
    25: sw_100_series_reverser_B_D;     // Car 9    Car 8    
    28: sw_100_series_reverser_P_C;     // Car 10   Car 7 
    31: sw_100_series_reverser_C_P;     // Car 11   Car 6  
    34: sw_100_series_reverser_P_C;     // Car 12   Car 5
    37: sw_100_series_reverser_C_P;     // Car 13   Car 4  
    40: sw_100_series_reverser_P_C;     // Car 14   Car 3   
    43: sw_100_series_reverser_C_P;     // Car 15   Car 2  
    46: sw_100_series_cab_rev;          // Car 16   Car 1  
	dummy_sprites;
}

switch (FEAT_TRAINS, SELF, sw_100_series_graphics_16car_v, position_in_articulated_veh) {
                                        // 16-car   
    1:  sw_100_series_cab; 	            // Car 1    Car 16  	
	4:  sw_100_series_reverser_P_C;	    // Car 2    Car 15     	
	7:  sw_100_series_reverser_C_P;     // Car 3    Car 14   
	10: sw_100_series_reverser_P_C;     // Car 4    Car 13  
    13: sw_100_series_reverser_C_P;     // Car 5    Car 12  
    16: sw_100_series_reverser_P_C;     // Car 6    Car 11  
    19: sw_100_series_reverser_D_D;     // Car 7    Car 10   
	22: sw_100_series_reverser_D_B;     // Car 8    Car 9  
    25: sw_100_series_reverser_B_D;     // Car 9    Car 8    
    28: sw_100_series_reverser_D_D;     // Car 10   Car 7 
    31: sw_100_series_reverser_C_P;     // Car 11   Car 6  
    34: sw_100_series_reverser_P_C;     // Car 12   Car 5
    37: sw_100_series_reverser_C_P;     // Car 13   Car 4  
    40: sw_100_series_reverser_P_C;     // Car 14   Car 3   
    43: sw_100_series_reverser_C_P;     // Car 15   Car 2  
    46: sw_100_series_cab_rev;          // Car 16   Car 1  
	dummy_sprites;
}

// For 12-car set
switch (FEAT_TRAINS, SELF, sw_100_series_graphics_12car_x, position_in_articulated_veh) {
                                        // 12-car
    2:  sw_100_series_cab; 	            // Car 1	
	6:  sw_100_series_reverser_P_C;     // Car 2
    10: sw_100_series_reverser_C_P;     // Car 3
    14: sw_100_series_reverser_P_C;     // Car 4 
    18: sw_100_series_reverser_C_P;     // Car 5
    22: sw_100_series_reverser_P_C;     // Car 6
    26: sw_100_series_reverser_C_P;     // Car 7
    30: sw_100_series_reverser_P_C;     // Car 8
    34: sw_100_series_reverser_C_P;     // Car 9
    38: sw_100_series_reverser_P_C;     // Car 10
    42: sw_100_series_reverser_C_P;     // Car 11
    46: sw_100_series_cab_rev;          // Car 12
	dummy_sprites;
}

switch (FEAT_TRAINS, SELF, sw_100_series_graphics_8car_kodama, position_in_articulated_veh) {					
    2:  sw_100_series_cab; 	            // Car 1	Car 8								
    8:  sw_100_series_reverser_P_C;	    // Car 2	Car 7	    						
    14: sw_100_series_reverser_C_P;     // Car 3    Car 6
    20: sw_100_series_reverser_P_C;     // Car 4    Car 5
    26: sw_100_series_reverser_C_P;     // Car 5    Car 4
    32: sw_100_series_reverser_P_C;     // Car 6    Car 3
    38: sw_100_series_reverser_C_P;     // Car 7    Car 2
    44: sw_100_series_cab_rev;          // Car 8    Car 1
    dummy_sprites;
}

/* Choose which Graphics based on which Cargo Subtype */

switch(FEAT_TRAINS, SELF, sw_100_series_graphics_year_dep, build_year) {
    0..1999: sw_100_series_graphics_16car_x;
    sw_100_series_graphics_8car_kodama;
}


switch(FEAT_TRAINS, SELF, sw_100_series_graphics, cargo_subtype) {
    1: sw_100_series_graphics_16car_x;
    2: sw_100_series_graphics_12car_x;
    3: sw_100_series_graphics_16car_v;
    4: sw_100_series_graphics_8car_kodama;
    sw_100_series_graphics_year_dep;
}

/* Assemble an 48 part articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_100_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_100;										
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/100_series/100_series_fixed.pnml" 3

item(FEAT_TRAINS, series_100) {
	property {
		/* Menu */
        name: 							string(STR_NAME_100_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1985,10,01);           // Date of launch
		model_life:                     26;		                    // 
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train		
		/* Stats */
        speed:                          211 km/h;                   // Changed by callback
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_100_SERIES);
        cargo_subtype_text:             sw_100_series_year_dep_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
        /* Graphics */
        default:                        sw_100_series_graphics;
		purchase:                       sw_100_series_year_dep_purchase;
		articulated_part:               sw_100_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_100_series_length;
        weight:                         weight_100_series * sw_100_series_number_of_cars();
        power:                          power_per_motor_100_series * 4 * sw_100_series_number_of_motor_cars();
        speed:							sw_100_series_speed;
		cargo_capacity:                 sw_100_series_cargo_capacity;
		loading_speed:					sw_100_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    sw_100_series_cost_factor;
		refit_cost:                     sw_100_series_refit_cost;
		running_cost_factor:            sw_100_series_running_costs;              
		purchase_running_cost_factor:   running_cost_100_series * sw_100_series_number_of_cars();
		
	}
}

/* End 100 Series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/800_series/800_series_fixed.pnml" 1
/* Begin 800 Series */

// #include "src/trains/800_series/800_series_subtypes.pnml"
# 1 "src/trains/800_series/800_series_gfx.pnml" 1
/* Begin 800 Series SPRITES */

    // Purchase Menu
    spriteset (ss_800_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_800_series_buy,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_800_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_800_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_800_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_800_series_cab_rev,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_800_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_800_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_800_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_800_series_coach_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_800_series_panto,          		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_800_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_800_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_800_series_panto_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_reversed(1,81)}	
# 1 "src/trains/800_series/800_series_fixed.pnml" 4
// #include "src/trains/800_series/800_series_liveries.pnml"
# 1 "src/trains/800_series/800_series_stats.pnml" 1
/* Begin 800 Series STATS */

/* RUNNING COSTS */
    running_cost_800_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_800_series_running_costs, current_speed) {
        0: running_cost_800_series / 10 * 6;           // Stopped
        1..15: running_cost_800_series / 4 * 6; 	    // Moving below ~33.5 mph
        running_cost_800_series * 6; 				    // Track speed
    }

/* CARGO CAPACITY 

    6-car JPS equivalent 468/585/702/819

        6-car
    IRL 392
    RW  396       
    LS  594   
    DC  792       
*/

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_800_series_cargo_capacity, param_basecapacity) {
        0: return 22;       // 1x Real World Capacity
        2: return 44;       // 2x Double Real World Capacity
        return 33;          // 1.5x Long Sprite Adjusted Capacity 
    }

/* LOADING SPEED */

    // 6 car
    switch(FEAT_TRAINS, SELF, sw_800_series_loading_speed, param_basecapacity) {
        0: return 22 / param_loading_2D;        // 1x Real World Capacity
        2: return 44 / param_loading_2D;        // 2x Double Real World Capacity
        return 33 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }
# 1 "src/trains/800_series/800_series_fixed.pnml" 4
# 1 "src/trains/800_series/800_series_formation.pnml" 1
/* Begin 800 Series FORMATION */

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_800_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_800_series_panto;
	    ss_800_series_panto_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_800_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_800_series_coach;
	    ss_800_series_coach_rev;
    }

/* PUT TOGETHER THE EMU*/

    // 6 Car Set
    switch (FEAT_TRAINS, SELF, sw_800_series_graphics, position_in_articulated_veh) {					
	    1:  ss_800_series_cab; 	            // Car 1	Car 6								
	    4:  sw_800_series_reverser_P_P;	    // Car 2	Car 5	    						
	    7:  sw_800_series_reverser_C_C;     // Car 3    Car 4
	    10: sw_800_series_reverser_C_C;     // Car 4    Car 3
        13: sw_800_series_reverser_P_P;     // Car 5    Car 2
        16: ss_800_series_cab_rev;          // Car 6    Car 1
	    dummy_sprites;
    }

    /* Assemble an articulated vehicle. */
    switch (FEAT_TRAINS, SELF, sw_800_series_articulated_part, extra_callback_info1) {
	    1 .. 17: return series_800;										// Should be same as range above
	    return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }
# 1 "src/trains/800_series/800_series_fixed.pnml" 4

item(FEAT_TRAINS, series_800) {
	property {
		/* Menu */
		name: 							string(STR_NAME_800_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2004,03,13);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          261 km/h;				
		power:                          9300 hp;					// 1550 hp (per JPS) x 6 cars					
		weight:                         44 * 6 tons;				// 44t (per JPS) x 6 cars					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_800_SERIES);
		//cargo_subtype_text:             sw_800_series_subtype_text;
		can_attach_wagon:				sw_full_notjreast_attach_vehid;
		/* Graphics */
		default:                        sw_800_series_graphics;
		purchase:                       ss_800_series_buy;
		articulated_part:               sw_800_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_2_8_2;
        //power:                          sw_800_series_power;
        //weight:                         sw_800_series_weight;
		cargo_capacity:                 sw_800_series_cargo_capacity;
		loading_speed:					sw_800_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    189;
		running_cost_factor:            sw_800_series_running_costs;
		purchase_running_cost_factor:   running_cost_800_series * 6;
	}
}

/* End 800 series */
# 1 "JPplusShinkansen.pnml" 4

/*---JR EAST TRAINS---*/
# 1 "src/trains/200_series/200_series_fixed.pnml" 1
/* Begin 200 Series */

# 1 "src/trains/200_series/200_series_subtypes.pnml" 1
/* Begin 200 Series SUBTYPES*/

// From 1982 to 1987
switch(FEAT_TRAINS, SELF, sw_200_series_1982_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
       return CB_RESULT_NO_TEXT;
    }

// From 1987 to 1990 - introduction of 10-car and 8-car sets
switch(FEAT_TRAINS, SELF, sw_200_series_1987_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
    2: return string(LV_200_SERIES_10CAR);              // Original 10-car
    3: return string(LV_200_SERIES_08CAR);              // Original 8-car
       return CB_RESULT_NO_TEXT;
    }

// From 1990 to 1992 - introduction of Sharknose sets
switch(FEAT_TRAINS, SELF, sw_200_series_1990_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
    2: return string(LV_200_SERIES_10CAR);              // Original 10-car
    3: return string(LV_200_SERIES_08CAR);              // Original 8-car
    4: return string(LV_200_SERIES_SHARK12);            // Sharknose 12-car
    5: return string(LV_200_SERIES_SHARK16);            // Sharknose 16-car
       return CB_RESULT_NO_TEXT;
    }

// From 1992 onwards - introduction of Refurbished Livery
switch(FEAT_TRAINS, SELF, sw_200_series_1992_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);               // Year Dependent (12-car)
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
    2: return string(LV_200_SERIES_10CAR);              // Original 10-car
    3: return string(LV_200_SERIES_08CAR);              // Original 8-car
    4: return string(LV_200_SERIES_SHARK12);            // Sharknose 12-car         
    5: return string(LV_200_SERIES_SHARK16);            // Sharknose 16-car
    6: return string(LV_200_SERIES_REFURB10);           // Refurbished 10-car
    7: return string(LV_200_SERIES_REFURB08);           // Refurbished 8-car
       return CB_RESULT_NO_TEXT;
    }

// Subtype Menu
switch(FEAT_TRAINS, SELF, sw_200_series_year_dep_subtype_text, current_year) {
        0..1986: sw_200_series_1982_subtype_text;
        1987..1989: sw_200_series_1987_subtype_text;
        1990..1991: sw_200_series_1990_subtype_text;
        sw_200_series_1992_subtype_text;
    }
# 1 "src/trains/200_series/200_series_fixed.pnml" 3
# 1 "src/trains/200_series/200_series_gfx.pnml" 1
/* Begin 200 Series GRAPHICS */

/* Purchase Menu */
spriteset (ss_200_series_buy_original_jnr,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_200_series_buy_original_jre,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_200_series_buy_sharknose_livery,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

alternative_sprites(ss_200_series_buy_original_jnr,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/purchase_original_jnr.png") {template_purchase(0, 0)}
alternative_sprites(ss_200_series_buy_original_jre,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/purchase_original_jre.png") {template_purchase(0, 0)}
alternative_sprites(ss_200_series_buy_sharknose_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/purchase_sharknose.png") {template_purchase(0, 0)}

/* EMU Parts */

/* "CAB" */

spriteset(ss_200_series_cab_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_sharknose_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_rev_sharknose_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_refurb_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_rev_refurb_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_200_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,1)}
alternative_sprites(ss_200_series_cab_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,41)}		

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_cab_sharknose_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_standard(1,1)}
alternative_sprites(ss_200_series_cab_rev_sharknose_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_reversed(1,41)}	

// 200 Series Refurbished Livery
alternative_sprites(ss_200_series_cab_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_standard(1,1)}
alternative_sprites(ss_200_series_cab_rev_refurb_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_reversed(1,41)}

/* "COACH" */

spriteset(ss_200_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_sharknose_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_rev_sharknose_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_refurb_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_rev_refurb_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_200_series_coach_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_200_series_coach_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,121)}		

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_coach_sharknose_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_200_series_coach_rev_sharknose_livery,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,121)}	

// 200 Series Refurbished Livery
alternative_sprites(ss_200_series_coach_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_standard(1,121)}
alternative_sprites(ss_200_series_coach_rev_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_reversed(1,121)}

/* "PANTO" */

spriteset(ss_200_series_panto_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_sharknose_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_rev_sharknose_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_refurb_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_rev_refurb_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_200_series_panto_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_panto_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,81)}		

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_panto_sharknose_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_panto_rev_sharknose_livery,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,81)}	

// 200 Series Refurbished Livery
alternative_sprites(ss_200_series_panto_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_panto_rev_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_reversed(1,81)}

/* "DOUBLE DECKER" */

spriteset(ss_200_series_2deck,             	                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_2deck_rev,    		                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_2deck,                        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_2deck_rev,                    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_reversed(1,81)}	
# 1 "src/trains/200_series/200_series_fixed.pnml" 3
# 1 "src/trains/200_series/200_series_liveries.pnml" 1
/* Begin 200 Series LIVERIES*/

/* Purchase Menu */

    switch(FEAT_TRAINS, SELF, sw_200_series_year_dep_purchase, current_year) {
        0..1986: ss_200_series_buy_original_jnr;        // JNR
        1987..1990: ss_200_series_buy_original_jre;     // JR East
        ss_200_series_buy_sharknose_livery;             // UPDATE!!!
    }

/* EMU Parts */

/* "CAB" */

    // Year Dependent Livery
    switch(FEAT_TRAINS, SELF, sw_200_series_cab_year_dep_livery, build_year) {
        0..1986: ss_200_series_cab_original_livery;
        1987..9999: ss_200_series_cab_sharknose_livery;
        ss_200_series_cab_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_cab, cargo_subtype) {
        1: ss_200_series_cab_original_livery;      // Original 12-car
        2: ss_200_series_cab_original_livery;      // Original 10-car
        3: ss_200_series_cab_original_livery;      // Original 8-car
        4: ss_200_series_cab_sharknose_livery;     // Sharknose 12-car
        5: ss_200_series_cab_sharknose_livery;     // Sharknose 16-car
        6: ss_200_series_cab_refurb_livery;        // Refurbished 10-car
        7: ss_200_series_cab_refurb_livery;        // Refurbished 8-car
        sw_200_series_cab_year_dep_livery;
    }

    // Reversed
    // Year Dependent Livery
    switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev_year_dep_livery, build_year) {
        0..1986: ss_200_series_cab_rev_original_livery;
        1987..9999: ss_200_series_cab_rev_sharknose_livery;
        ss_200_series_cab_rev_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev, cargo_subtype) {
        1: ss_200_series_cab_rev_original_livery;      // Original 12-car
        2: ss_200_series_cab_rev_original_livery;      // Original 10-car
        3: ss_200_series_cab_rev_original_livery;      // Original 8-car
        4: ss_200_series_cab_rev_sharknose_livery;     // Sharknose 12-car
        5: ss_200_series_cab_rev_sharknose_livery;     // Sharknose 16-car
        6: ss_200_series_cab_rev_refurb_livery;        // Refurbished 10-car
        7: ss_200_series_cab_rev_refurb_livery;        // Refurbished 8-car
        sw_200_series_cab_rev_year_dep_livery;
    }

/* "COACH" */

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_coach_year_dep_livery, build_year) {
    0..1986: ss_200_series_coach_original_livery;
    1987..9999: ss_200_series_coach_sharknose_livery;
    ss_200_series_coach_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_200_series_coach, cargo_subtype) {
    1: ss_200_series_coach_original_livery;      // Original 12-car
    2: ss_200_series_coach_original_livery;      // Original 10-car
    3: ss_200_series_coach_original_livery;      // Original 8-car
    4: ss_200_series_coach_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_coach_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_coach_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_coach_refurb_livery;        // Refurbished 8-car
    sw_200_series_coach_year_dep_livery;
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev_year_dep_livery, build_year) {
    0..1986: ss_200_series_coach_rev_original_livery;
    1987..9999: ss_200_series_coach_rev_sharknose_livery;
    ss_200_series_coach_rev_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev, cargo_subtype) {
    1: ss_200_series_coach_rev_original_livery;      // Original 12-car
    2: ss_200_series_coach_rev_original_livery;      // Original 10-car
    3: ss_200_series_coach_rev_original_livery;      // Original 8-car
    4: ss_200_series_coach_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_coach_rev_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_coach_rev_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_coach_rev_refurb_livery;        // Refurbished 8-car
    sw_200_series_coach_rev_year_dep_livery;
}

/* "PANTO" */

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_panto_year_dep_livery, build_year) {
    0..1986: ss_200_series_panto_original_livery;
    1987..9999: ss_200_series_panto_sharknose_livery;
    ss_200_series_panto_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_200_series_panto, cargo_subtype) {
    1: ss_200_series_panto_original_livery;      // Original 12-car
    2: ss_200_series_panto_original_livery;      // Original 10-car
    3: ss_200_series_panto_original_livery;      // Original 8-car
    4: ss_200_series_panto_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_panto_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_panto_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_panto_refurb_livery;        // Refurbished 8-car
    sw_200_series_panto_year_dep_livery;
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev_year_dep_livery, build_year) {
    0..1986: ss_200_series_panto_rev_original_livery;
    1987..9999: ss_200_series_panto_rev_sharknose_livery;
    ss_200_series_panto_rev_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev, cargo_subtype) {
    1: ss_200_series_panto_rev_original_livery;      // Original 12-car
    2: ss_200_series_panto_rev_original_livery;      // Original 10-car
    3: ss_200_series_panto_rev_original_livery;      // Original 8-car
    4: ss_200_series_panto_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_panto_rev_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_panto_rev_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_panto_rev_refurb_livery;        // Refurbished 8-car
    sw_200_series_panto_rev_year_dep_livery;
}
# 1 "src/trains/200_series/200_series_fixed.pnml" 3
# 1 "src/trains/200_series/200_series_stats.pnml" 1
/* Begin 200 Series STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_200_series_number_of_cars, cargo_subtype) {
            2: return 10;
            3: return 8;
            5: return 16;
            6: return 10;
            7: return 8;      
            return 12;       
        }

    switch(FEAT_TRAINS, SELF, sw_200_series_number_of_motor_cars, cargo_subtype) {
            2: return 10;   // All motorised
            3: return 8;    // All motorised
            5: return 14;   // 14M 2T
            6: return 10;   // All motorised
            7: return 8;    // All motorised    
            return 12;      // All motorised 
        }

/* LENGTH*/

    // Make a 10 car set by adjusting sprite sizes
    switch(FEAT_TRAINS, SELF, sw_200_series_shorten_10_car_vehicle_majority, position_in_articulated_veh % 5) {
        2: return 8;
        return 1;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_shorten_10_car_vehicle, position_in_articulated_veh) {
        0..44: sw_200_series_shorten_10_car_vehicle_majority;
        46: return 8;
        return 2;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_length, cargo_subtype) {
        2: sw_200_series_shorten_10_car_vehicle;        // 10-car Original
        3: sw_length_1_1_7_1_1_1;                       // 8-car Original
        5: sw_length_2_8_2;                             // 16-car Sharknose
        6: sw_200_series_shorten_10_car_vehicle;        // 10-car Refurbished
        7: sw_length_1_1_7_1_1_1;                       // 8-car Refurbished
        sw_length_1_1_8_2;                              // All other 12-length sets
    }

/* RUNNING COSTS */
    running_cost_200_series = 187;                  // 150 is approx JPS
    
    switch(FEAT_TRAINS, SELF, sw_200_series_running_costs, current_speed) {
        0: running_cost_200_series / 10 * sw_200_series_number_of_cars();       // Stopped
        1..15: running_cost_200_series / 4 * sw_200_series_number_of_cars(); 	// Moving below ~33.5 mph
        running_cost_200_series * sw_200_series_number_of_cars(); 				// Track speed
    }

/* WEIGHT */
    weight_200_series = 58;                         // 58t per JPS
    
/* POWER */
    power_per_motor_200_series = 308;               // in hp (230 kW)

/* SPEED */
    switch(FEAT_TRAINS, SELF, sw_200_series_speed_year_dep, build_year) {
        0..1986: return 210;    // Original speed
        return 240;             // Sharknose and Refurbished Speed
    }
        
    switch(FEAT_TRAINS, SELF, sw_200_series_speed, cargo_subtype) {
        0: sw_200_series_speed_year_dep;
        1..3: return 210;       // Original speed
        return 240;             // Sharknose and Refurbished Speed
    }

/* CARGO CAPACITY

    JPS 16-car  624/780/936/1092
    JPS 12-car
    JPS 10-car 
    JPS 8-car      

        16-car  12-car  10-car  8-car
    IRL 1324     ?     
    RW  1344     432     
    LS  864     648       
    DC  1152    864       

    */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity_16car, param_basecapacity) {
        0: return 28;       // 1x Real World Capacity
        2: return 56;       // 2x Double Real World Capacity
        return 42;          // 1.5x Long Sprite Adjusted Capacity 
    }
    // 12 car
    switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity_12car, param_basecapacity) {
        0: return 21;       // 1x Real World Capacity
        2: return 42;       // 2x Double Real World Capacity
        return 31;          // 1.5x Long Sprite Adjusted Capacity 
    }
    // 10 car
    switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity_10car, param_basecapacity) {
        0: return 17;       // 1x Real World Capacity
        2: return 35;       // 2x Double Real World Capacity
        return 26;          // 1.5x Long Sprite Adjusted Capacity 
    }
    // 8 car
    switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity_08car, param_basecapacity) {
        0: return 14;       // 1x Real World Capacity
        2: return 28;       // 2x Double Real World Capacity
        return 21;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity, cargo_subtype) {
        2: sw_200_series_cargo_capacity_10car; 
        3: sw_200_series_cargo_capacity_08car; 
        5: sw_200_series_cargo_capacity_16car;     
        6: sw_200_series_cargo_capacity_10car;
        7: sw_200_series_cargo_capacity_08car;
        sw_200_series_cargo_capacity_12car;
    }

/* LOADING SPEED */

    // 16 car
    switch(FEAT_TRAINS, SELF, sw_200_series_param_loading_speed_16car, param_basecapacity) {
        0: return 28 / param_loading_2D;        // 1x Real World Capacity
        2: return 56 / param_loading_2D;        // 2x Double Real World Capacity
        return 42 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_200_series_param_loading_speed_12car, param_basecapacity) {
        0: return 21 / param_loading_2D;        // 1x Real World Capacity
        2: return 42 / param_loading_2D;        // 2x Double Real World Capacity
        return 31 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 10 car
    switch(FEAT_TRAINS, SELF, sw_200_series_param_loading_speed_10car, param_basecapacity) {
        0: return 17 / param_loading_2D;        // 1x Real World Capacity
        2: return 35 / param_loading_2D;        // 2x Double Real World Capacity
        return 26 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_200_series_param_loading_speed_08car, param_basecapacity) {
        0: return 13 / param_loading_2D;        // 1x Real World Capacity
        2: return 27 / param_loading_2D;        // 2x Double Real World Capacity
        return 20 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_loading_speed, cargo_subtype) {
        2: sw_200_series_param_loading_speed_10car;
        3: sw_200_series_param_loading_speed_08car;
        5: sw_200_series_param_loading_speed_16car;
        6: sw_200_series_param_loading_speed_10car;
        7: sw_200_series_param_loading_speed_08car;
        sw_200_series_param_loading_speed_12car;
    }

/* REFIT COST */

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_minus6, cargo_subtype) {                                     
        6: return -10+12;
        return -8+12;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_minus5, cargo_subtype) {                                     
        5: return -16+12;
        6: return -10+12;
        return -8+10;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_minus4, cargo_subtype) {                  
        4: return -12+12;                     
        5: return -16+12;
        6: return -10+10;
        return -8+8;
    }
    
    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_minus3, cargo_subtype) {                                    
        3: return -8+12;
        4: return -12+12;                     
        5: return -16+10;
        6: return -10+8;
        return -8+12;
    }
    
    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_minus2, cargo_subtype) {
        2: return -10+12;                     
        3: return -8+12;
        4: return -12+10;                     
        5: return -16+8;
        6: return -10+12;
        return -8+16;
    }
    
    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_minus1, cargo_subtype) {
        1: return -12+12;
        2: return -10+12;                     
        3: return -8+10;
        4: return -12+8;                     
        5: return -16+12;
        6: return -10+16;
        return -8+10;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_plus1, cargo_subtype) {
        0: return -12+12;
        1: return -12+10;
        2: return -10+8;  
        3: return -8+12;
        4: return -12+16;
        5: return -16+10;
        return -10+8;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_plus2, cargo_subtype) {
        0: return -12+10;
        1: return -12+8;
        2: return -10+12;  
        3: return -8+16;
        4: return -12+10;
        return -16+8;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_plus3, cargo_subtype) {
        0: return -12+8;
        1: return -12+12;
        2: return -10+16;  
        3: return -8+10;
        return -12+8;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_plus4, cargo_subtype) {
        0: return -12+12;
        1: return -12+16;
        2: return -10+10;  
        return -8+8;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_plus5, cargo_subtype) {
        0: return -12+16;
        1: return -12+10;      
        return -10+8;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost_plus6, cargo_subtype) {
        0: return -12+10;      
        return -12+8;
    }

    switch(FEAT_TRAINS, SELF, sw_200_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo sybtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
	    -7:             -8+12;
        -6:             sw_200_series_refit_cost_minus6;
        -5:             sw_200_series_refit_cost_minus5; 
        -4:             sw_200_series_refit_cost_minus4; 
        -3:             sw_200_series_refit_cost_minus3; 
        -2:				sw_200_series_refit_cost_minus2;
	    -1:				sw_200_series_refit_cost_minus1;
	    0:				0;
	    1:				sw_200_series_refit_cost_plus1;
	    2:				sw_200_series_refit_cost_plus2;
        3:              sw_200_series_refit_cost_plus3;
        4:              sw_200_series_refit_cost_plus4;
        5:              sw_200_series_refit_cost_plus5;
        6:              sw_200_series_refit_cost_plus6;
        7:              -12+8;
	    return CB_FAILED;
    }
# 1 "src/trains/200_series/200_series_fixed.pnml" 3
# 1 "src/trains/200_series/200_series_formation.pnml" 1
/* Begin 200 Series FORMATION */

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_C_P, vehicle_is_reversed) {
	0: sw_200_series_coach;
	sw_200_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_P_C, vehicle_is_reversed) {
	0: sw_200_series_panto;
	sw_200_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_P_D, vehicle_is_reversed) {
	0: sw_200_series_panto;
	ss_200_series_2deck_rev;
}

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_C_D, vehicle_is_reversed) {
	0: sw_200_series_coach;
	ss_200_series_2deck_rev;
}

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_D_P, vehicle_is_reversed) {
	0: ss_200_series_2deck;
	sw_200_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_D_C, vehicle_is_reversed) {
	0: ss_200_series_2deck;
	sw_200_series_coach_rev;
}

/* PUT TOGETHER THE EMU*/

/* 16-car sent */
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_16car, position_in_articulated_veh) {
                                        // 16-car   
    1:  sw_200_series_cab; 	            // Car 1    Car 16  	
	4:  sw_200_series_reverser_P_C;	    // Car 2    Car 15     	
	7:  sw_200_series_reverser_C_P;     // Car 3    Car 14   
	10: sw_200_series_reverser_P_C;     // Car 4    Car 13  
    13: sw_200_series_reverser_C_P;     // Car 5    Car 12  
    16: sw_200_series_reverser_P_D;     // Car 6    Car 11  
    19: sw_200_series_reverser_C_D;     // Car 7    Car 10   
	22: sw_200_series_reverser_P_C;     // Car 8    Car 9  
    25: sw_200_series_reverser_C_P;     // Car 9    Car 8    
    28: sw_200_series_reverser_D_C;     // Car 10   Car 7 
    31: sw_200_series_reverser_D_P;     // Car 11   Car 6  
    34: sw_200_series_reverser_P_C;     // Car 12   Car 5
    37: sw_200_series_reverser_C_P;     // Car 13   Car 4  
    40: sw_200_series_reverser_P_C;     // Car 14   Car 3   
    43: sw_200_series_reverser_C_P;     // Car 15   Car 2  
    46: sw_200_series_cab_rev;          // Car 16   Car 1  
	dummy_sprites;
}

// For 12-car set
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_12car, position_in_articulated_veh) {
                                        // 12-car
    2:  sw_200_series_cab; 	            // Car 1    Car 12	
	6:  sw_200_series_reverser_P_C;     // Car 2    Car 11
    10: sw_200_series_reverser_C_P;     // Car 3    Car 10
    14: sw_200_series_reverser_P_C;     // Car 4    Car 9
    18: sw_200_series_reverser_C_P;     // Car 5    Car 8
    22: sw_200_series_reverser_P_C;     // Car 6    Car 7
    26: sw_200_series_reverser_C_P;     // Car 7    Car 6
    30: sw_200_series_reverser_P_C;     // Car 8    Car 5
    34: sw_200_series_reverser_C_P;     // Car 9    Car 4
    38: sw_200_series_reverser_P_C;     // Car 10   Car 3
    42: sw_200_series_reverser_C_P;     // Car 11   Car 2
    46: sw_200_series_cab_rev;          // Car 12   Car 1
	dummy_sprites;
}

// For 10-car set
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_10car, position_in_articulated_veh) {
                                        // 10-car
    2:  sw_200_series_cab; 		        // Car 1    Car 10	
	7:  sw_200_series_reverser_P_C;     // Car 2    Car 9
    12: sw_200_series_reverser_C_P;     // Car 3    Car 8
    17: sw_200_series_reverser_P_C;     // Car 4    Car 4
    22: sw_200_series_reverser_C_P;     // Car 5    Car 6
    27: sw_200_series_reverser_P_C;     // Car 6    Car 5
    32: sw_200_series_reverser_C_P;     // Car 7    Car 4
    37: sw_200_series_reverser_P_C;     // Car 8    Car 3
    42: sw_200_series_reverser_C_P;     // Car 9    Car 2
    46: sw_200_series_cab_rev;          // Car 10   Car 1
	dummy_sprites;
}

// For 8-car set
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_8car, position_in_articulated_veh) {
                                        // 8-car
    2:  sw_200_series_cab; 	 	        // Car 1    Car 8	
	8:  sw_200_series_reverser_P_C;     // Car 2    Car 7
    14: sw_200_series_reverser_C_P;     // Car 3    Car 6
    20: sw_200_series_reverser_P_C;     // Car 4    Car 5
    26: sw_200_series_reverser_C_P;     // Car 5    Car 4
    32: sw_200_series_reverser_P_C;     // Car 6    Car 3
    38: sw_200_series_reverser_C_P;     // Car 7    Car 2
    44: sw_200_series_cab_rev;          // Car 8    Car 1
	dummy_sprites;
}

/* Choose which Graphics based on which Cargo Subtype */
switch(FEAT_TRAINS, SELF, sw_200_series_graphics, cargo_subtype) {
    2: sw_200_series_graphics_10car;
    3: sw_200_series_graphics_8car;
    5: sw_200_series_graphics_16car;
    6: sw_200_series_graphics_10car;
    7: sw_200_series_graphics_8car;
    sw_200_series_graphics_12car;
}

/* Assemble an 48 part articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_200_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_200;										
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/200_series/200_series_fixed.pnml" 3

item(FEAT_TRAINS, series_200) {
	property {
		/* Menu */
		name: 							string(STR_NAME_200_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1982,06,23);           // Date of launch
		model_life:                     34;		                    // Until 2008
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          210 km/h;                   // Changed by callback
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_200_SERIES);
		cargo_subtype_text:             sw_200_series_year_dep_subtype_text;
		can_attach_wagon:				sw_full_jreast_attach_vehid;
		/* Graphics */
		default:                        sw_200_series_graphics;
		purchase:                       sw_200_series_year_dep_purchase;
		articulated_part:               sw_200_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_200_series_length;
        weight:                         weight_200_series * sw_200_series_number_of_cars();
        power:                          power_per_motor_200_series * 4 * sw_200_series_number_of_motor_cars();
        speed:							sw_200_series_speed;
		cargo_capacity:                 sw_200_series_cargo_capacity;
		loading_speed:					sw_200_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    508;
		refit_cost:                     sw_200_series_refit_cost;
		running_cost_factor:            sw_200_series_running_costs;
		purchase_running_cost_factor:   running_cost_0_series * sw_0_series_number_of_cars();
		
	}
}

/* End 200 Series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/400_series/400_series.pnml" 1
// Begin 400_series

# 1 "src/trains/400_series/400_series_subtypes.pnml" 1
// Begin 400_series SUBTYPES

  switch(FEAT_TRAINS, SELF, sw_400_series_subtypetext_mucar, cargo_subtype) {
    0 : string(LV_400_SERIES_ORIGINAL);
    1 : string(LV_400_SERIES_REFURB);
  }
  switch(FEAT_TRAINS, SELF, sw_400_series_subtypetext_main, cargo_subtype) {
    0 : string(LV_400_SERIES_ORIGINAL);
    1 : string(LV_400_SERIES_REFURB);
  }
# 1 "src/trains/400_series/400_series.pnml" 3
# 1 "src/trains/400_series/400_series_gfx.pnml" 1
// Begin 400_series GRAPHICS

    // Purchase Sprites
        spriteset (spriteset_400_series_purchase,	        	"src/gfx/dummy/purchase.png") {tmpl_purchase_dh(0, 0)}
        alternative_sprites(spriteset_400_series_purchase,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/buy_400.png") {tmpl_purchase_dh_32bpp(0, 0)}

    // 400 Series Original
        spriteset(ss_400_series_cab_original,                   "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_cab_rev_original,               "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_original,                 "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_rev_original,             "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_original,                 "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_rev_original,             "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_400_series_cab_original,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,1)}
        alternative_sprites(ss_400_series_cab_rev_original,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,41)}
        alternative_sprites(ss_400_series_coach_original,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,121)}
        alternative_sprites(ss_400_series_coach_rev_original,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_400_series_panto_original,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,81)}
        alternative_sprites(ss_400_series_panto_rev_original,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_reversed(1,81)}

    // 400 Series Refurbished
        spriteset(ss_400_series_cab_refurb,                     "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_cab_rev_refurb,                 "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_refurb,                   "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_rev_refurb,               "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_refurb,                   "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_rev_refurb,               "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_400_series_cab_refurb,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,1)}
        alternative_sprites(ss_400_series_cab_rev_refurb,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,41)}
        alternative_sprites(ss_400_series_coach_refurb,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,121)}
        alternative_sprites(ss_400_series_coach_rev_refurb,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_400_series_panto_refurb,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,81)}
        alternative_sprites(ss_400_series_panto_rev_refurb,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_reversed(1,81)}    
# 1 "src/trains/400_series/400_series.pnml" 3
# 1 "src/trains/400_series/400_series_liveries.pnml" 1
// Begin 400_series LIVERIES

    // Cab Livery (Yellow Lights)
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_cab_original;
        1 : ss_400_series_cab_refurb;
    }
    // Cab Reversed Livery (Red lights)
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_cab_rev_original;
        1 : ss_400_series_cab_rev_refurb;
    }
    // Coach Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_coach_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_coach_original;
        1 : ss_400_series_coach_refurb;
    }
    // Coach Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_coach_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_coach_rev_original;
        1 : ss_400_series_coach_rev_refurb;
    }
    // Panto Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_panto_original;
        1 : ss_400_series_panto_refurb;
    }
    // Panto Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_panto_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_panto_rev_original;
        1 : ss_400_series_panto_rev_refurb;
    }
# 1 "src/trains/400_series/400_series.pnml" 3
# 1 "src/trains/400_series/400_series_stats.pnml" 1
// Begin 400_series STATS

/* CARGO CAPACITY 

    per car JPS   40/50/60/70

        per car
    IRL 57      399/7 = 57    
    RW  57          
    LS  71       
    DC  85         
*/

  // Passenger Capacities for each parameter level
  switch(FEAT_TRAINS, SELF, sw_400_series_cargo_capacity, param_basecapacity) {
        0: return 57;       // 1x Real World Capacity
        2: return 85;       // Double Real World Capacity (1.5x for Mini-Shinkansen)
        return 71;          // Long Sprite Adjusted Capacity (1.25x for Mini-Shinkansen)
  }

// Loading Speed

  // Loading Speeds for each parameter level
  switch(FEAT_TRAINS, SELF, sw_400_series_loading_speed, param_basecapacity) {
      // Loading Capacity for a 2 door
      0: return 57 / param_loading_1D;       // Low Capacity
      2: return 85 / param_loading_1D;       // High Capacity
      return 71 / param_loading_1D;          // Normal Capacity 
  }
# 1 "src/trains/400_series/400_series.pnml" 3

/* COACH and PANTO flipping */

    // Check if Coach is flipped
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_coach_flippedcheck, vehicle_is_flipped) {
        1 : sw_400_series_gfx_coach_livery;
        default : sw_400_series_gfx_coach_rev_livery;
    }
    // Check if Panto is flipped
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_panto_flippedcheck, vehicle_is_flipped) {
        1 : sw_400_series_gfx_panto_livery;
        default : sw_400_series_gfx_panto_rev_livery;
    }

/* PANTOGRAPH CHECKS */

    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_original_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
        0 : sw_400_series_gfx_panto_flippedcheck;
        default : sw_400_series_gfx_coach_flippedcheck;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_original_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
        1 : sw_400_series_gfx_panto_flippedcheck;
        //4 : sw_400_series_gfx_panto_flippedcheck;
        7 : sw_400_series_gfx_panto_flippedcheck;
    default : sw_400_series_gfx_coach_flippedcheck;
    }

    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_original, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
        0..2 : sw_400_series_gfx_rev_pantograph_pos_original_sw1;
        default : sw_400_series_gfx_rev_pantograph_pos_original_sw2;
    }

    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_refurb_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
        0 : sw_400_series_gfx_panto_flippedcheck;
        default : sw_400_series_gfx_coach_flippedcheck;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_refurb_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
        1 : sw_400_series_gfx_panto_flippedcheck;
        //4 : sw_400_series_gfx_panto_flippedcheck;
        7 : sw_400_series_gfx_panto_flippedcheck;
        default : sw_400_series_gfx_coach_flippedcheck;
    }

    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_refurb, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
        0..2 : sw_400_series_gfx_rev_pantograph_pos_refurb_sw1;
        default : sw_400_series_gfx_rev_pantograph_pos_refurb_sw2;
    }

    switch(FEAT_TRAINS,SELF, sw_400_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : sw_400_series_gfx_rev_pantograph_pos_original;
        1 : sw_400_series_gfx_rev_pantograph_pos_refurb;
    }

    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_nomucars,
    [STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
        1 : sw_400_series_gfx_cab_rev_livery;
        0 : sw_400_series_gfx_cab_livery;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_aftermucars,
    [STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
        1 : sw_400_series_gfx_cab_livery;
        0 : sw_400_series_gfx_cab_rev_livery;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_mucarcheck,
    [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
    STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
    var[0x61, 0, 0x0000FFFF, 0xC6]]){
        1111 : sw_400_series_gfx_rev_frontback_aftermucars;         // From above switch
        default : sw_400_series_gfx_rev_frontback_nomucars;         // From above switch
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_sameid,
    [STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
        400 : sw_400_series_gfx_rev_frontback_mucarcheck;
        1111 : sw_400_series_gfx_cab_rev_livery;
        default : sw_400_series_gfx_cab_livery;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback,
    [STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
        400 : sw_400_series_gfx_rev_frontback_sameid;
        1111 : sw_400_series_gfx_cab_livery;
        default : sw_400_series_gfx_cab_rev_livery;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
        1111 : sw_400_series_gfx_rev_pantograph_pos;        
        400 : sw_400_series_gfx_rev_frontback;
    }
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
    
    // Original
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_original_sw1, position_in_vehid_chain){
        0 : ss_400_series_panto_original;
        default : ss_400_series_coach_original;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_original_sw2, position_in_vehid_chain%10){
        1 : ss_400_series_panto_original;
        //4 : ss_400_series_panto_original;
        7 : ss_400_series_panto_original;
        default : ss_400_series_coach_original;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_original, num_vehs_in_vehid_chain){
        0..2 : sw_400_series_gfx_pantograph_pos_original_sw1;
        default : sw_400_series_gfx_pantograph_pos_original_sw2;
    }
    
    // Refurbished
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_refurb_sw1, position_in_vehid_chain){
        0 : ss_400_series_panto_refurb;
        default : ss_400_series_coach_refurb;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_refurb_sw2, position_in_vehid_chain%10){
        1 : ss_400_series_panto_refurb;
        //4 : ss_400_series_panto_refurb;
        7 : ss_400_series_panto_refurb;
        default : ss_400_series_coach_refurb;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_refurb, num_vehs_in_vehid_chain){
        0..2 : sw_400_series_gfx_pantograph_pos_refurb_sw1;
        default : sw_400_series_gfx_pantograph_pos_refurb_sw2;
    }

/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/

// Original Set
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_flipcheck_original, vehicle_is_flipped){
        0: ss_400_series_cab_original;                             // Cab
        default: ss_400_series_cab_rev_original;                   // Cab Reversed
    }
    switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_cab_original, vehicle_is_reversed){
        0: sw_400_series_gfx_cab_flipcheck_original;               // Above switch
        default: sw_400_series_gfx_rev_idcheck;              
    }

// Refurbished Set
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_flipcheck_refurb, vehicle_is_flipped){
        0: ss_400_series_cab_refurb;                             // Cab
        default: ss_400_series_cab_rev_refurb;                   // Cab Reversed
    }
    switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_cab_refurb, vehicle_is_reversed){
        0: sw_400_series_gfx_cab_flipcheck_refurb;               // Above switch
        default: sw_400_series_gfx_rev_idcheck;             
    }


/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
    switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_mucar_revcheck_mid_original, vehicle_is_reversed){
        0: sw_400_series_gfx_pantograph_pos_original;
        default: sw_400_series_gfx_rev_idcheck;
    }

    switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_mucar_revcheck_mid_refurb, vehicle_is_reversed){
        0: sw_400_series_gfx_pantograph_pos_refurb;
        default: sw_400_series_gfx_rev_idcheck;
    }

/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_mucar,  cargo_subtype) {
        0 : sw_400_series_gfx_mucar_revcheck_mid_original;
        1 : sw_400_series_gfx_mucar_revcheck_mid_refurb;
    }
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_main,  cargo_subtype) {
        0 : sw_400_series_gfx_cab_original;
        1 : sw_400_series_gfx_cab_refurb;
    }
/*---END OF SECTION---*/

/*---Coupling Switch---*/
    switch(FEAT_TRAINS, SELF, sw_400_series_attach_vehid, [vehicle_type_id == series_400 || vehicle_type_id == mu_car_ms]) {
        0: return string(MU_UNIQUE);
    }
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_400) {
    property {
        name:                           string(STR_NAME_400_SERIES);
        introduction_date:              date(1992,07,01);
        model_life:                     28;                             // In service until 2010,04,18
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;
        speed:                          240 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          4 * 280 hp;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_400_series_gfx_main;
	    purchase:                       spriteset_400_series_purchase;
		additional_text:	            return string(STR_DESC_400_SERIES);
        cargo_subtype_text:             sw_400_series_subtypetext_main;
        can_attach_wagon:			    sw_400_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_400_series_gfx_mucar;
        cargo_capacity:                 sw_400_series_cargo_capacity;
        cargo_age_period:				param_decay_express;
        loading_speed:                  sw_400_series_loading_speed;
        cargo_subtype_text:             sw_400_series_subtypetext_mucar;
        power:                          4 * 280;
        weight:                         42;
        running_cost_factor:            120;
      }

}

// End 400_series
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e1_series/e1_series_fixed.pnml" 1
/* Begin E1 Series */

# 1 "src/trains/e1_series/e1_series_subtypes.pnml" 1
/* Begin e1 Series SUBTYPES */

// Pre 2003 subtype text
switch(FEAT_TRAINS, SELF, sw_e1_series_old_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E1_SERIES_ORIGINAL); 
       return CB_RESULT_NO_TEXT;
    }

// Post 2003 subtype text
switch(FEAT_TRAINS, SELF, sw_e1_series_new_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E1_SERIES_ORIGINAL);
    2: return string(LV_E1_SERIES_REFURB);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e1_series_year_dep_subtype_text, current_year) {
    0..2003: sw_e1_series_old_livery_subtype_text;
    sw_e1_series_new_livery_subtype_text;
}
# 1 "src/trains/e1_series/e1_series_fixed.pnml" 3
# 1 "src/trains/e1_series/e1_series_gfx.pnml" 1
/* Begin e1 Series GRAPHICS */

/* Purchase Menu */
    spriteset (ss_e1_series_buy_original_livery,	        	    "src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    spriteset (ss_e1_series_buy_refurb_livery,	        	        "src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}

    alternative_sprites(ss_e1_series_buy_original_livery,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/buy_e1_original.png") {template_purchase(0, 0)}
    alternative_sprites(ss_e1_series_buy_refurb_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/buy_e1_refurb.png")   {template_purchase(0, 0)}

    switch(FEAT_TRAINS, SELF, sw_e1_series_year_dep_purchase, current_year) {
        0..2003: ss_e1_series_buy_original_livery;
        ss_e1_series_buy_refurb_livery;
    }

/* EMU Parts */

/* "CAB" */
    spriteset(ss_e1_series_cab_original_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_cab_rev_original_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_cab_refurb_livery,             		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_cab_rev_refurb_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

    // E1 Series Original Livery
    alternative_sprites(ss_e1_series_cab_original_livery,     	        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e1_series_cab_rev_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_reversed(1,41)}		

    // E1 Series Refurbished Livery
    alternative_sprites(ss_e1_series_cab_refurb_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e1_series_cab_rev_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_reversed(1,41)}

/* COACH */
    spriteset(ss_e1_series_coach_original_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_coach_reversed_original_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_coach_refurb_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_coach_reversed_refurb_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

    // E1 Series Original Livery
    alternative_sprites(ss_e1_series_coach_original_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e1_series_coach_reversed_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_reversed(1,121)}

    // E1 Series Refurbished Livery
    alternative_sprites(ss_e1_series_coach_refurb_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e1_series_coach_reversed_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_reversed(1,121)}	

/* PANTO */
    spriteset(ss_e1_series_panto_original_livery,          		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_panto_reversed_original_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_panto_refurb_livery,          		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e1_series_panto_reversed_refurb_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

    // E1 Series Original Livery
    alternative_sprites(ss_e1_series_panto_original_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e1_series_panto_reversed_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_reversed(1,81)}	

    // E1 Series Refurbished Livery
    alternative_sprites(ss_e1_series_panto_refurb_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e1_series_panto_reversed_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_reversed(1,81)}	
# 1 "src/trains/e1_series/e1_series_fixed.pnml" 3
# 1 "src/trains/e1_series/e1_series_liveries.pnml" 1
/* Begin E1 Series LIVERIES */

// CAB

    switch(FEAT_TRAINS, SELF, sw_e1_series_cab_year_dep_livery, build_year) {
        0..2003: ss_e1_series_cab_original_livery;
        2004..9999: ss_e1_series_cab_refurb_livery;
        ss_e1_series_cab_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_cab_old_livery, cargo_subtype) {
        1: ss_e1_series_cab_original_livery;
        sw_e1_series_cab_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_cab_new_livery, cargo_subtype) {
        1: ss_e1_series_cab_original_livery;
        2: ss_e1_series_cab_refurb_livery;
        sw_e1_series_cab_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_e1_series_cab, current_year) {
        0..2003: sw_e1_series_cab_old_livery;
        sw_e1_series_cab_new_livery;
    }

// CAB REVERSED

    switch(FEAT_TRAINS, SELF, sw_e1_series_cab_rev_year_dep_livery, build_year) {
        0..2003: ss_e1_series_cab_rev_original_livery;
        2004..9999: ss_e1_series_cab_rev_refurb_livery;
        ss_e1_series_cab_rev_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_cab_rev_old_livery, cargo_subtype) {
        1: ss_e1_series_cab_rev_original_livery;
        sw_e1_series_cab_rev_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_cab_rev_new_livery, cargo_subtype) {
        1: ss_e1_series_cab_rev_original_livery;
        2: ss_e1_series_cab_rev_refurb_livery;
        sw_e1_series_cab_rev_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_e1_series_cab_rev, current_year) {
        0..2003: sw_e1_series_cab_rev_old_livery;
        sw_e1_series_cab_rev_new_livery;
    }

// Coach

    switch(FEAT_TRAINS, SELF, sw_e1_series_coach_year_dep_livery, build_year) {
        0..2003: ss_e1_series_coach_original_livery;
        2004..9999: ss_e1_series_coach_refurb_livery;
        ss_e1_series_coach_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_coach_old_livery, cargo_subtype) {
        1: ss_e1_series_coach_original_livery;
        sw_e1_series_coach_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_coach_new_livery, cargo_subtype) {
        1: ss_e1_series_coach_original_livery;
        2: ss_e1_series_coach_refurb_livery;
        sw_e1_series_coach_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_e1_series_coach, current_year) {
        0..2003: sw_e1_series_coach_old_livery;
        sw_e1_series_coach_new_livery;
    }

// Coach Reversed

    switch(FEAT_TRAINS, SELF, sw_e1_series_coach_reversed_year_dep_livery, build_year) {
        0..2003: ss_e1_series_coach_reversed_original_livery;
        2004..9999: ss_e1_series_coach_reversed_refurb_livery;
        ss_e1_series_coach_reversed_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_coach_reversed_old_livery, cargo_subtype) {
        1: ss_e1_series_coach_reversed_original_livery;
        sw_e1_series_coach_reversed_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_coach_reversed_new_livery, cargo_subtype) {
        1: ss_e1_series_coach_reversed_original_livery;
        2: ss_e1_series_coach_reversed_refurb_livery;
        sw_e1_series_coach_reversed_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_e1_series_coach_reversed, current_year) {
        0..2003: sw_e1_series_coach_reversed_old_livery;
        sw_e1_series_coach_reversed_new_livery;
    }

// Panto

    switch(FEAT_TRAINS, SELF, sw_e1_series_panto_year_dep_livery, build_year) {
        0..2003: ss_e1_series_panto_original_livery;
        2004..9999: ss_e1_series_panto_refurb_livery;
        ss_e1_series_panto_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_panto_old_livery, cargo_subtype) {
        1: ss_e1_series_panto_original_livery;
        sw_e1_series_panto_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_panto_new_livery, cargo_subtype) {
        1: ss_e1_series_panto_original_livery;
        2: ss_e1_series_panto_refurb_livery;
        sw_e1_series_panto_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_e1_series_panto, current_year) {
        0..2003: sw_e1_series_panto_old_livery;
        sw_e1_series_panto_new_livery;
    }

// Panto Reversed

    switch(FEAT_TRAINS, SELF, sw_e1_series_panto_reversed_year_dep_livery, build_year) {
        0..2003: ss_e1_series_panto_reversed_original_livery;
        2004..9999: ss_e1_series_panto_reversed_refurb_livery;
        ss_e1_series_panto_reversed_original_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_panto_reversed_old_livery, cargo_subtype) {
        1: ss_e1_series_panto_reversed_original_livery;
        sw_e1_series_panto_reversed_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, sw_e1_series_panto_reversed_new_livery, cargo_subtype) {
        1: ss_e1_series_panto_reversed_original_livery;
        2: ss_e1_series_panto_reversed_refurb_livery;
        sw_e1_series_panto_reversed_year_dep_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_e1_series_panto_reversed, current_year) {
        0..2003: sw_e1_series_panto_reversed_old_livery;
        sw_e1_series_panto_reversed_new_livery;
    }
# 1 "src/trains/e1_series/e1_series_fixed.pnml" 3
# 1 "src/trains/e1_series/e1_series_stats.pnml" 1
/* Begin E1 Series STATS */

/* RUNNING COSTS */
    running_cost_e1_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_e1_series_running_costs, current_speed) {
        0: running_cost_e1_series / 10 * 12;        // Stopped
        1..15: running_cost_e1_series / 4 * 12;     // Moving below ~33.5 mph
        running_cost_e1_series * 12; 				// Track speed
    }

/* CARGO CAPACITY

    IRL 12 car = 1235     JPS 1440/1800/2160/2520

        12-car  parts   per part
    IRL 1235    36      34.305
    RW  1224    36      34   
    LS  1836    36      51
    DC  2448    36      68

    */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_e1_series_cargo_capacity, param_basecapacity) {
        0: return 34;       // 1x Real World Capacity
        2: return 68;       // 2x Double Real World Capacity
        return 51;          // 1.5x Normal Capacity 
    }

/* LOADING SPEED */

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_e1_series_loading_speed, param_basecapacity) {
        0: return 34 / param_loading_2D;        // 1x Real World Capacity
        2: return 68 / param_loading_2D;        // 2x Double Real World Capacity
        return 51 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

# 1 "src/trains/e1_series/e1_series_fixed.pnml" 3
# 1 "src/trains/e1_series/e1_series_formation.pnml" 1
/* Begin e1 Series FORMATION */

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e1_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e1_series_coach;
	ss_e1_series_panto_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e1_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e1_series_coach;
	ss_e1_series_coach_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e1_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e1_series_panto;
	ss_e1_series_coach_reversed;
}

/* PUT TOGETHER THE EMU*/

/* Select the correct part of the train */
switch (FEAT_TRAINS, SELF, sw_e1_series_graphics, position_in_articulated_veh) {					
	1:  ss_e1_series_cab; 	            // Car 1    Car 12									
	4:  sw_e1_series_reverser_C_C;	    // Car 2	Car 11							
	7:  sw_e1_series_reverser_C_P;      // Car 3    Car 10
	10: sw_e1_series_reverser_C_C;      // Car 4    Car 9
    13: sw_e1_series_reverser_C_C;      // Car 5    Car 8
    16: sw_e1_series_reverser_P_C;      // Car 6    Car 7
    19: sw_e1_series_reverser_C_P;      // Car 7    Car 6
	22: sw_e1_series_reverser_C_C;      // Car 8    Car 5 
    25: sw_e1_series_reverser_C_C;      // Car 9    Car 4
    28: sw_e1_series_reverser_P_C;      // Car 10   Car 3
    31: sw_e1_series_reverser_C_C;      // Car 11   Car 2
    34: ss_e1_series_cab_rev;           // Car 12   Car 1
	dummy_sprites;
}

/* Assemble an 12-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e1_series_articulated_part, extra_callback_info1) {
	1 .. 35: return series_e1;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/e1_series/e1_series_fixed.pnml" 3

item(FEAT_TRAINS, series_e1) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E1_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1994,07,15);
		model_life:                     18;							// In service until 2012,09,28
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          241 km/h;					// Operational Top Speed
		power:                          550 * 4 * 6 hp;					// 550 hp (or 410 kW) per motor x 4 motors per car x 6 motorised cars
		weight:                         58 * 12 tons;					// 58t (per JPS) x 12 cars
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_E1_SERIES);
		cargo_subtype_text:             sw_e1_series_year_dep_subtype_text;
		can_attach_wagon:				sw_full_jreast_attach_vehid;
		/* Graphics */
		default:                        sw_e1_series_graphics;
		purchase:                       sw_e1_series_year_dep_purchase;
		articulated_part:               sw_e1_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_2_8_2;
		cargo_capacity:                 sw_e1_series_cargo_capacity;                                         
		loading_speed:					sw_e1_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    397;
		running_cost_factor:            sw_e1_series_running_costs;
		purchase_running_cost_factor:   running_cost_e1_series * 12;
	}
}

/* End E1 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e2_series/e2_series_fixed.pnml" 1
/* Begin e2 Series */

# 1 "src/trains/e2_series/e2_series_subtypes.pnml" 1
/* Begin E2 Series SUBTYPES */

    // From 1997 to 2002
    switch(FEAT_TRAINS, SELF, sw_e2_series_1997_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
        1: return string(LV_E2_SERIES_08CAR_RED);
        2: return string(LV_E2_SERIES_10CAR_RED);
        return CB_RESULT_NO_TEXT;
        }

    // From 2002 onwards - introduction of 10-car sets
    switch(FEAT_TRAINS, SELF, sw_e2_series_2002_subtype_text, cargo_subtype) {
        0: return string(LV_YEAR_DEP_LIVERY);
        1: return string(LV_E2_SERIES_10CAR_RED);
        2: return string(LV_E2_SERIES_08CAR_RED);
        3: return string(LV_E2_SERIES_10CAR_PINK);
        4: return string(LV_E2_SERIES_08CAR_PINK);
        return CB_RESULT_NO_TEXT;
        }

    switch(FEAT_TRAINS, SELF, sw_e2_series_year_dep_subtype_text, current_year) {
        0..2001: sw_e2_series_1997_subtype_text;
        sw_e2_series_2002_subtype_text;
    }
# 1 "src/trains/e2_series/e2_series_fixed.pnml" 3
# 1 "src/trains/e2_series/e2_series_gfx.pnml" 1
/* Begin e2 Series GRPAHICS */

    // Purchase Menu
    spriteset (ss_e2_series_buy_red,	        	            "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_e2_series_buy_red,                   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/buy_red.png") {template_purchase(0, 0)}

    spriteset (ss_e2_series_buy_pink,	        	            "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_e2_series_buy_pink,                  ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/buy_pink.png") {template_purchase(0, 0)}

    // Red Stripe

    // "CAB"
    spriteset(ss_e2_series_cab_red_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_cab_rev_red_livery,             	    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_cab_red_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/red_stripe.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e2_series_cab_rev_red_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/red_stripe.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_e2_series_coach_red_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_coach_rev_red_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_coach_red_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/red_stripe.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e2_series_coach_rev_red_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/red_stripe.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_e2_series_panto_red_livery,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_panto_rev_red_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_panto_red_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/red_stripe.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e2_series_panto_rev_red_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/red_stripe.png") {template_12_reversed(1,81)}

    // Pink Stripe

    // "CAB"
    spriteset(ss_e2_series_cab_pink_livery,             	    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_cab_rev_pink_livery,                "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_cab_pink_livery,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/pink_stripe.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e2_series_cab_rev_pink_livery,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/pink_stripe.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_e2_series_coach_pink_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_coach_rev_pink_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_coach_pink_livery,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/pink_stripe.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e2_series_coach_rev_pink_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/pink_stripe.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_e2_series_panto_pink_livery,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_panto_rev_pink_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_panto_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/pink_stripe.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e2_series_panto_rev_pink_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/pink_stripe.png") {template_12_reversed(1,81)}
# 1 "src/trains/e2_series/e2_series_fixed.pnml" 3
# 1 "src/trains/e2_series/e2_series_liveries.pnml" 1
/* E2 Series LIVERIES */

// PURCHASE MENU

switch(FEAT_TRAINS, SELF, sw_e2_series_buy, build_year) {
    0..2001: ss_e2_series_buy_red;
    2002..9999: ss_e2_series_buy_pink;
    ss_e2_series_buy_red;
}

// CAB

switch(FEAT_TRAINS, SELF, sw_e2_series_cab_year_dep_livery, build_year) {
    0..2001: ss_e2_series_cab_red_livery;
    2002..9999: ss_e2_series_cab_pink_livery;
    ss_e2_series_cab_red_livery;
}

switch(FEAT_TRAINS, SELF, sw_e2_series_cab, cargo_subtype) {
    1..2: ss_e2_series_cab_red_livery;
    3..4: ss_e2_series_cab_pink_livery;
    sw_e2_series_cab_year_dep_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_e2_series_cab_rev_year_dep_livery, build_year) {
    0..2001: ss_e2_series_cab_rev_red_livery;
    2002..9999: ss_e2_series_cab_rev_pink_livery;
    ss_e2_series_cab_rev_red_livery;
}

switch(FEAT_TRAINS, SELF, sw_e2_series_cab_rev, cargo_subtype) {
    1..2: ss_e2_series_cab_rev_red_livery;
    3..4: ss_e2_series_cab_rev_pink_livery;
    sw_e2_series_cab_rev_year_dep_livery;
}

// COACH

switch(FEAT_TRAINS, SELF, sw_e2_series_coach_year_dep_livery, build_year) {
    0..2001: ss_e2_series_coach_red_livery;
    2002..9999: ss_e2_series_coach_pink_livery;
    ss_e2_series_coach_red_livery;
}

switch(FEAT_TRAINS, SELF, sw_e2_series_coach, cargo_subtype) {
    1..2: ss_e2_series_coach_red_livery;
    3..4: ss_e2_series_coach_pink_livery;
    sw_e2_series_coach_year_dep_livery;
}

// Coach Reversed

switch(FEAT_TRAINS, SELF, sw_e2_series_coach_rev_year_dep_livery, build_year) {
    0..2001: ss_e2_series_coach_rev_red_livery;
    2002..9999: ss_e2_series_coach_rev_pink_livery;
    ss_e2_series_coach_rev_red_livery;
}

switch(FEAT_TRAINS, SELF, sw_e2_series_coach_rev, cargo_subtype) {
    1..2: ss_e2_series_coach_rev_red_livery;
    3..4: ss_e2_series_coach_rev_pink_livery;
    sw_e2_series_coach_rev_year_dep_livery;
}

// Panto

switch(FEAT_TRAINS, SELF, sw_e2_series_panto_year_dep_livery, build_year) {
    0..2001: ss_e2_series_panto_red_livery;
    2002..9999: ss_e2_series_panto_pink_livery;
    ss_e2_series_panto_red_livery;
}

switch(FEAT_TRAINS, SELF, sw_e2_series_panto, cargo_subtype) {
    1..2: ss_e2_series_panto_red_livery;
    3..4: ss_e2_series_panto_pink_livery;
    sw_e2_series_panto_year_dep_livery;
}

// Panto Reversed

switch(FEAT_TRAINS, SELF, sw_e2_series_panto_rev_year_dep_livery, build_year) {
    0..2001: ss_e2_series_panto_rev_red_livery;
    2002..9999: ss_e2_series_panto_rev_pink_livery;
    ss_e2_series_panto_rev_red_livery;
}

switch(FEAT_TRAINS, SELF, sw_e2_series_panto_rev, cargo_subtype) {
    1..2: ss_e2_series_panto_rev_red_livery;
    3..4: ss_e2_series_panto_rev_pink_livery;
    sw_e2_series_panto_rev_year_dep_livery;
}
# 1 "src/trains/e2_series/e2_series_fixed.pnml" 3
# 1 "src/trains/e2_series/e2_series_stats.pnml" 1
/* Begin e2 Series STATS */

/* NUMBER OF CARS */

    switch(FEAT_TRAINS, SELF, sw_e2_series_number_of_cars, cargo_subtype) {
            1: return 10;
            3: return 10;
            return 8;       
        }

    switch(FEAT_TRAINS, SELF, sw_e2_series_number_of_motor_cars, cargo_subtype) {
            1: return 8;   // 8M 2T  
            3: return 8;   // 8M 2T
            return 6;      // 6M 2T
        }

/* LENGTH*/
    switch(FEAT_TRAINS, SELF, sw_e2_series_length, cargo_subtype) {
        1: sw_length_1_1_8_2;                   // 10-car Set
        3: sw_length_1_1_8_2;                   // 10-car Set
        sw_length_1_1_8_1_1;                    // 8-car Set
    }

/* WEIGHT */
    weight_e2_series = 46;                      // 46t per JPS

/* POWER */
    power_per_motor_e2_series = 400;            // in hp (300 kW)

/* RUNNING COSTS */
    running_cost_e2_series = 187;               // 150 is approx JPS
    
    switch(FEAT_TRAINS, SELF, sw_e2_series_running_costs, current_speed) {
        0: running_cost_e2_series / 10 * sw_e2_series_number_of_cars();         // Stopped
        1..15: running_cost_e2_series / 4 * sw_e2_series_number_of_cars(); 	    // Moving below ~33.5 mph
        running_cost_e2_series * sw_e2_series_number_of_cars(); 				// Track speed
    }

/* REFIT COST */
    
    switch(FEAT_TRAINS, SELF, sw_e2_series_refit_cost_plusminus1, cargo_subtype) {
        0: return -8+10;
        2: return -8+10;
        4: return -8+10; 
        return -10+8;
    }
    
    switch(FEAT_TRAINS, SELF, sw_e2_series_refit_cost, var[0x10,8,0xFF] - cargo_subtype) {
        /* Refit cost based on difference between target cargo subtype and current cargo subtype.
	    Refitting to fewer carriages refunds money, while adding carriages costs (more) money.    */    
	    -4:             0;
        -3:             sw_e2_series_refit_cost_plusminus1;       
        -2:             0;
        -1:				sw_e2_series_refit_cost_plusminus1;
	    0:				0;
	    1:				sw_e2_series_refit_cost_plusminus1;
        2:              0;
        3:              sw_e2_series_refit_cost_plusminus1;
        4:              0;
	    return CB_FAILED;
    }

/* CARGO CAPACITY

    JPS 780/975/1170/1365
    JPS 624/780/936/1092

        10-car  8-car
    IRL 815     630
    RW  800     640  
    LS  1200    864
    DC  1600    1152

    */

    // round(IRL capacity/40)
    switch(FEAT_TRAINS, SELF, sw_e2_series_param_cargo_capacity_10car, param_basecapacity) {
        0: return 20;       // 1x Real World Capacity
        2: return 40;       // 2x Double Real World Capacity
        return 30;          // 1.5x Long Sprite Adjusted Capacity 
    }
    // round(IRL capacity/40)
    switch(FEAT_TRAINS, SELF, sw_e2_series_param_cargo_capacity_08car, param_basecapacity) {
        0: return 16;       // 1x Real World Capacity
        2: return 32;       // 2x Double Real World Capacity
        return 24;          // 1.5x Long Sprite Adjusted Capacity 
    }

    // Capacity for each length    
    switch(FEAT_TRAINS, SELF, sw_e2_series_cargo_capacity, cargo_subtype) {
        1: sw_e2_series_param_cargo_capacity_10car;          // Length 10 (7.5 tiles)
        3: sw_e2_series_param_cargo_capacity_10car;          // Length 10 (7.5 tiles)
        sw_e2_series_param_cargo_capacity_08car; 
    }

/* LOADING SPEED */

    // 10 car
    switch(FEAT_TRAINS, SELF, sw_e2_series_loading_speed_10car, param_basecapacity) {
        0: return 20 / param_loading_2D;        // 1x Real World Capacity
        2: return 40 / param_loading_2D;        // 2x Double Real World Capacity
        return 30 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_e2_series_loading_speed_08car, param_basecapacity) {
        0: return 16 / param_loading_2D;        // 1x Real World Capacity
        2: return 32 / param_loading_2D;        // 2x Double Real World Capacity
        return 24 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }

    switch (FEAT_TRAINS, SELF, sw_e2_series_loading_speed, cargo_subtype) {
        1: sw_e2_series_loading_speed_10car;
        3: sw_e2_series_loading_speed_10car;
        sw_e2_series_loading_speed_08car;
    }
# 1 "src/trains/e2_series/e2_series_fixed.pnml" 3
# 1 "src/trains/e2_series/e2_series_formation.pnml" 1
/* Begin e2 Series FORMATION */

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e2_series_reverser_C_P, vehicle_is_reversed) {
	0: sw_e2_series_coach;
	sw_e2_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e2_series_reverser_C_C, vehicle_is_reversed) {
	0: sw_e2_series_coach;
	sw_e2_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e2_series_reverser_P_C, vehicle_is_reversed) {
	0: sw_e2_series_panto;
	sw_e2_series_coach_rev;
}
 
/* PUT TOGETHER THE EMU*/

    // 10 Car Set
    switch (FEAT_TRAINS, SELF, sw_e2_series_graphics_10car, position_in_articulated_veh) {					
	    2:  sw_e2_series_cab; 	            // Car 1	Car 10								
	    6:  sw_e2_series_reverser_C_C;	    // Car 2	Car 9	    						
	    10: sw_e2_series_reverser_C_C;      // Car 3    Car 8
	    14: sw_e2_series_reverser_P_C;      // Car 4    Car 7
        18: sw_e2_series_reverser_C_P;      // Car 5    Car 6
        22: sw_e2_series_reverser_P_C;      // Car 6    Car 5
        26: sw_e2_series_reverser_C_P;      // Car 7    Car 4
	    30: sw_e2_series_reverser_C_C;      // Car 8    Car 3
        34: sw_e2_series_reverser_C_C;      // Car 9    Car 2
        38: sw_e2_series_cab_rev;           // Car 10   Car 1
	    dummy_sprites;
    }
    // 8 Car Set
    switch (FEAT_TRAINS, SELF, sw_e2_series_graphics_08car, position_in_articulated_veh) {					
	    2:  sw_e2_series_cab; 	            // Car 1	Car 8								
	    7:  sw_e2_series_reverser_C_C;	    // Car 2	Car 7	    						
	    12: sw_e2_series_reverser_C_P;      // Car 3    Car 6
	    17: sw_e2_series_reverser_P_C;      // Car 4    Car 5
        22: sw_e2_series_reverser_C_P;      // Car 5    Car 4
        27: sw_e2_series_reverser_P_C;      // Car 6    Car 3
        32: sw_e2_series_reverser_C_C;      // Car 7    Car 2
        37: sw_e2_series_cab_rev;           // Car 8    Car 1
	    dummy_sprites;
    }
    // Graphics selection per cargo subtype
    switch(FEAT_TRAINS, SELF, sw_e2_series_graphics, cargo_subtype) {
        1: sw_e2_series_graphics_10car;         // 10-car Set
        3: sw_e2_series_graphics_10car;         // 10-car Set
        sw_e2_series_graphics_08car;            // 8-car Set
    }

/* Assemble an articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e2_series_articulated_part, extra_callback_info1) {
	1 .. 39: return series_e2;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/e2_series/e2_series_fixed.pnml" 3

item(FEAT_TRAINS, series_e2) {
	property {
		/* Menu */
        name: 							string(STR_NAME_E2_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,22);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          275 km/h;				    // Operational Top Speed
		power:                          8050 kW;                    // Overwritten by callback					
		weight:                         648 tons;                   // Overwritten by callback					
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_E2_SERIES);
        cargo_subtype_text:             sw_e2_series_year_dep_subtype_text;
        can_attach_wagon:				sw_full_jreast_attach_vehid;
		/* Graphics */
        default:                        sw_e2_series_graphics;
		purchase:                       sw_e2_series_buy;
		articulated_part:               sw_e2_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_e2_series_length;
        power:                          power_per_motor_e2_series * 4 * sw_e2_series_number_of_motor_cars();
        weight:                         weight_e2_series * sw_e2_series_number_of_cars();
		cargo_capacity:                 sw_e2_series_cargo_capacity;
		loading_speed:					sw_e2_series_loading_speed;
		cargo_age_period:				param_decay_express;
		refit_cost:                     sw_e2_series_refit_cost;
		cost_factor:                    258;
		running_cost_factor:            sw_e2_series_running_costs;
		purchase_running_cost_factor:   running_cost_e2_series * sw_e2_series_number_of_cars();	
	}
}

/* End e2 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e3_series/e3_series.pnml" 1
// Begin e3_series

# 1 "src/trains/e3_series/e3_series_subtypes.pnml" 1
// Begin e3_series SUBTYPES

  switch(FEAT_TRAINS, SELF, sw_e3_series_subtypetext_mucar, cargo_subtype) {
    0 : string(LV_E3_SERIES_R);
    1 : string(LV_E3_SERIES_1000);
    2 : string(LV_E3_SERIES_2000); 
  }
  switch(FEAT_TRAINS, SELF, sw_e3_series_subtypetext_main, cargo_subtype) {
    0 : string(LV_E3_SERIES_R);
    1 : string(LV_E3_SERIES_1000);
    2 : string(LV_E3_SERIES_2000); 
  }
# 1 "src/trains/e3_series/e3_series.pnml" 3
# 1 "src/trains/e3_series/e3_series_gfx.pnml" 1
// Begin e3_series GRAPHICS

    // Purchase Sprites
        spriteset (spriteset_e3_series_purchase,	        	"src/gfx/dummy/purchase.png") {tmpl_purchase_dh(0, 0)}
        alternative_sprites(spriteset_e3_series_purchase,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/buy_e3_r.png") {tmpl_purchase_dh_32bpp(0, 0)}

    // E3 Series R Set
        spriteset(ss_e3_series_cab_r,                           "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_cab_rev_r,                       "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_r,                         "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_rev_r,                     "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_r,                         "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_rev_r,                     "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e3_series_cab_r,                 ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e3_series_cab_rev_r,             ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e3_series_coach_r,               ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e3_series_coach_rev_r,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e3_series_panto_r,               ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e3_series_panto_rev_r,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_reversed(1,81)}

    // E3-1000 Series
        spriteset(ss_e3_series_cab_1000,                        "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_cab_rev_1000,                    "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_1000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_rev_1000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_1000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_rev_1000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e3_series_cab_1000,              ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e3_series_cab_rev_1000,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e3_series_coach_1000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e3_series_coach_rev_1000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e3_series_panto_1000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e3_series_panto_rev_1000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_reversed(1,81)}

    // E3-2000 Series
        spriteset(ss_e3_series_cab_2000,                        "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_cab_rev_2000,                    "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_2000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_rev_2000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_2000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_rev_2000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e3_series_cab_2000,              ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e3_series_cab_rev_2000,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e3_series_coach_2000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e3_series_coach_rev_2000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e3_series_panto_2000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e3_series_panto_rev_2000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_reversed(1,81)}
# 1 "src/trains/e3_series/e3_series.pnml" 3
# 1 "src/trains/e3_series/e3_series_liveries.pnml" 1
// Begin e3_series LIVERIES

    // Cab Livery (Yellow Lights)
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_cab_r;
        1 : ss_e3_series_cab_1000;
        2 : ss_e3_series_cab_2000;
    }
    // Cab Reversed Livery (Red lights)
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_cab_rev_r;
        1 : ss_e3_series_cab_rev_1000;
        2 : ss_e3_series_cab_rev_2000;
    }
    // Coach Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_coach_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_coach_r;
        1 : ss_e3_series_coach_1000;
        2 : ss_e3_series_coach_2000;
    }
    // Coach Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_coach_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_coach_rev_r;
        1 : ss_e3_series_coach_rev_1000;
        2 : ss_e3_series_coach_rev_2000;
    }
    // Panto Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_panto_r;
        1 : ss_e3_series_panto_1000;
        2 : ss_e3_series_panto_2000;
    }
    // Panto Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_panto_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_panto_rev_r;
        1 : ss_e3_series_panto_rev_1000;
        2 : ss_e3_series_panto_rev_2000;
    }
# 1 "src/trains/e3_series/e3_series.pnml" 3
# 1 "src/trains/e3_series/e3_series_stats.pnml" 1
// Begin e3_series

/* CARGO CAPACITY 

    per car JPS   40/50/60/70

        per car
    IRL 56      Average 338/6, 402/7, 394/7 = 56    
    RW  56          
    LS  71       
    DC  85         
*/

// Passenger Capacities for each parameter level
  switch(FEAT_TRAINS, SELF, sw_e3_series_cargo_capacity, param_basecapacity) {
      // Assuming 50 capacity per car (same as JapanSet)
        0: return 56;       // 1x Real World Capacity
        2: return 84;       // Double Real World Capacity (1.5x for Mini-Shinkansen)
        return 70;          // Long Sprite Adjusted Capacity (1.25x for Mini-Shinkansen)
  }

// Loading Speed

// Loading Speeds for each parameter level
  switch(FEAT_TRAINS, SELF, sw_e3_series_loading_speed, param_basecapacity) {
      // Loading Capacity for a 1 door
      0: return 56 / param_loading_1D;       // Low Capacity
      2: return 84 / param_loading_1D;       // High Capacity
      return 70 / param_loading_1D;          // Normal Capacity 
  }
# 1 "src/trains/e3_series/e3_series.pnml" 3

/* COACH and PANTO flipping */

    // Check if Coach is flipped
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_coach_flippedcheck, vehicle_is_flipped) {
        1 : sw_e3_series_gfx_coach_livery;
        default : sw_e3_series_gfx_coach_rev_livery;
    }
    // Check if Panto is flipped
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_panto_flippedcheck, vehicle_is_flipped) {
        1 : sw_e3_series_gfx_panto_livery;
    default : sw_e3_series_gfx_panto_rev_livery;
    }

/* PANTOGRAPH CHECKS */

switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_r_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_r_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e3_series_gfx_panto_flippedcheck;
 //4 : sw_e3_series_gfx_panto_flippedcheck;
 7 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_1000_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_1000_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e3_series_gfx_panto_flippedcheck;
 //4 : sw_e3_series_gfx_panto_flippedcheck;
 7 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_2000_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_2000_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e3_series_gfx_panto_flippedcheck;
 //4 : sw_e3_series_gfx_panto_flippedcheck;
 7 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}

switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_r, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e3_series_gfx_rev_pantograph_pos_r_sw1;
  default : sw_e3_series_gfx_rev_pantograph_pos_r_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_1000, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e3_series_gfx_rev_pantograph_pos_1000_sw1;
  default : sw_e3_series_gfx_rev_pantograph_pos_1000_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_2000, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e3_series_gfx_rev_pantograph_pos_2000_sw1;
  default : sw_e3_series_gfx_rev_pantograph_pos_2000_sw2;
}

switch(FEAT_TRAINS,SELF, sw_e3_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : sw_e3_series_gfx_rev_pantograph_pos_r;
1 : sw_e3_series_gfx_rev_pantograph_pos_1000;
2 : sw_e3_series_gfx_rev_pantograph_pos_2000;
}

switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e3_series_gfx_cab_rev_livery;
 0 : sw_e3_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e3_series_gfx_cab_livery;
 0 : sw_e3_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1111 : sw_e3_series_gfx_rev_frontback_aftermucars;         // From above switch
 default : sw_e3_series_gfx_rev_frontback_nomucars;         // From above switch
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2003 : sw_e3_series_gfx_rev_frontback_mucarcheck;
 1111 : sw_e3_series_gfx_cab_rev_livery;
 default : sw_e3_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2003 : sw_e3_series_gfx_rev_frontback_sameid;
 1111 : sw_e3_series_gfx_cab_livery;
 default : sw_e3_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1111 : sw_e3_series_gfx_rev_pantograph_pos;        
 2003 : sw_e3_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_r_sw1, position_in_vehid_chain){
 0 : ss_e3_series_panto_r;
 default : ss_e3_series_coach_r;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_r_sw2, position_in_vehid_chain%10){
 1 : ss_e3_series_panto_r;
 //4 : ss_e3_series_panto_r;
 7 : ss_e3_series_panto_r;
 default : ss_e3_series_coach_r;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_1000_sw1, position_in_vehid_chain){
 0 : ss_e3_series_panto_1000;
 default : ss_e3_series_coach_1000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_1000_sw2, position_in_vehid_chain%10){
 1 : ss_e3_series_panto_1000;
 //4 : ss_e3_series_panto_1000;
 7 : ss_e3_series_panto_1000;
 default : ss_e3_series_coach_1000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_2000_sw1, position_in_vehid_chain){
 0 : ss_e3_series_panto_2000;
 default : ss_e3_series_coach_2000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_2000_sw2, position_in_vehid_chain%10){
 1 : ss_e3_series_panto_2000;
 //4 : ss_e3_series_panto_2000;
 7 : ss_e3_series_panto_2000;
 default : ss_e3_series_coach_2000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_r, num_vehs_in_vehid_chain){
  0..2 : sw_e3_series_gfx_pantograph_pos_r_sw1;
  default : sw_e3_series_gfx_pantograph_pos_r_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_1000, num_vehs_in_vehid_chain){
  0..2 : sw_e3_series_gfx_pantograph_pos_1000_sw1;
  default : sw_e3_series_gfx_pantograph_pos_1000_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_2000, num_vehs_in_vehid_chain){
  0..2 : sw_e3_series_gfx_pantograph_pos_2000_sw1;
  default : sw_e3_series_gfx_pantograph_pos_2000_sw2;
}
/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/

// R Set
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_flipcheck_r, vehicle_is_flipped){
 0: ss_e3_series_cab_r;                             // Cab
 default: ss_e3_series_cab_rev_r;                   // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_cab_r, vehicle_is_reversed){
 0: sw_e3_series_gfx_cab_flipcheck_r;               // Above switch
 default: sw_e3_series_gfx_rev_idcheck;             // 
}

// 1000 Series
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_flipcheck_1000, vehicle_is_flipped){
 0: ss_e3_series_cab_1000;                          // Cab
 default: ss_e3_series_cab_rev_1000;                // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_cab_1000, vehicle_is_reversed){
 0: sw_e3_series_gfx_cab_flipcheck_1000;            // Above switch
 default: sw_e3_series_gfx_rev_idcheck;             // 
}

// 2000 Series
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_flipcheck_2000, vehicle_is_flipped){
 0: ss_e3_series_cab_2000;                          // Cab
 default: ss_e3_series_cab_rev_2000;                // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_cab_2000, vehicle_is_reversed){
 0: sw_e3_series_gfx_cab_flipcheck_2000;            // Above switch
 default: sw_e3_series_gfx_rev_idcheck;             // 
}

/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_mucar_revcheck_mid_r, vehicle_is_reversed){
 0: sw_e3_series_gfx_pantograph_pos_r;
 default: sw_e3_series_gfx_rev_idcheck;
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_mucar_revcheck_mid_1000, vehicle_is_reversed){
 0: sw_e3_series_gfx_pantograph_pos_1000;
 default: sw_e3_series_gfx_rev_idcheck;
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_mucar_revcheck_mid_2000, vehicle_is_reversed){
 0: sw_e3_series_gfx_pantograph_pos_2000;
 default: sw_e3_series_gfx_rev_idcheck;
}

/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_mucar,  cargo_subtype) {
0 : sw_e3_series_gfx_mucar_revcheck_mid_r;
1 : sw_e3_series_gfx_mucar_revcheck_mid_1000;
2 : sw_e3_series_gfx_mucar_revcheck_mid_2000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_main,  cargo_subtype) {
0 : sw_e3_series_gfx_cab_r;
1 : sw_e3_series_gfx_cab_1000;
2 : sw_e3_series_gfx_cab_2000;
}
/*---END OF SECTION---*/
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_attach_vehid, [vehicle_type_id == series_e3 || vehicle_type_id == mu_car_ms]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_e3) {
    property {
        name:                           string(STR_NAME_E3_SERIES );
        introduction_date:              date(1997,03,22);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;
        speed:                          275 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          400 * 4 hp;
        weight:                         43 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e3_series_gfx_main;
	      purchase:                       spriteset_e3_series_purchase;
		    additional_text:	              return string(STR_DESC_E3_SERIES);
        cargo_subtype_text:             sw_e3_series_subtypetext_main;
        can_attach_wagon:			          sw_e3_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_e3_series_gfx_mucar;
        cargo_capacity:                 sw_e3_series_cargo_capacity;
        cargo_age_period:				        param_decay_express;
        loading_speed:                  sw_e3_series_loading_speed;
        cargo_subtype_text:             sw_e3_series_subtypetext_mucar;
        power:                          400 * 4;
        weight:                         43;
        running_cost_factor:            120;
      }

}

// End e3_series
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e4_series/e4_series_fixed.pnml" 1
/* Begin E4 Series */

# 1 "src/trains/e4_series/e4_series_subtypes.pnml" 1
/* Begin E4 Series SUBTYPES*/

// Pre 2014 subtype text
switch(FEAT_TRAINS, SELF, sw_e4_series_old_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E4_SERIES_YELLOW); 
       return CB_RESULT_NO_TEXT;
    }

// Post 2014 subtype text
switch(FEAT_TRAINS, SELF, sw_e4_series_new_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E4_SERIES_YELLOW);
    2: return string(LV_E4_SERIES_PINK);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e4_series_year_dep_subtype_text, current_year) {
    0..2014: sw_e4_series_old_livery_subtype_text;
    sw_e4_series_new_livery_subtype_text;
}
# 1 "src/trains/e4_series/e4_series_fixed.pnml" 3
# 1 "src/trains/e4_series/e4_series_gfx.pnml" 1

/* Purchase Menu */
    spriteset (ss_e4_series_buy_yellow_livery,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    spriteset (ss_e4_series_buy_pink_livery,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}

    alternative_sprites(ss_e4_series_buy_yellow_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/purchase_yellow.png") {template_purchase(0, 0)}
    alternative_sprites(ss_e4_series_buy_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/purchase_pink.png")   {template_purchase(0, 0)}

    switch(FEAT_TRAINS, SELF, sw_e4_series_year_dep_purchase, current_year) {
        0..2014: ss_e4_series_buy_yellow_livery;
        ss_e4_series_buy_pink_livery;
    }

/* EMU Parts */

    /* "CAB" */
    spriteset(ss_e4_series_cab_yellow_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_cab_rev_yellow_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_cab_pink_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_cab_rev_pink_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

    // E4 Series Yellow Strip Livery
    alternative_sprites(ss_e4_series_cab_yellow_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e4_series_cab_rev_yellow_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png")  {template_12_reversed(1,41)}		

    // E4 Series Pink Strip Livery
    alternative_sprites(ss_e4_series_cab_pink_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e4_series_cab_rev_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_reversed(1,41)}

    /* COACH */
    spriteset(ss_e4_series_coach_yellow_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_coach_reversed_yellow_livery,    		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_coach_pink_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_coach_reversed_pink_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

    // E4 Series Yellow Strip Livery
    alternative_sprites(ss_e4_series_coach_yellow_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e4_series_coach_reversed_yellow_livery,  ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_reversed(1,121)}

    // E4 Series Pink Strip Livery
    alternative_sprites(ss_e4_series_coach_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e4_series_coach_reversed_pink_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_reversed(1,121)}	

    // Coach Panto
    spriteset(ss_e4_series_panto_yellow_livery,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_panto_reversed_yellow_livery, 		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_panto_pink_livery,          		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e4_series_panto_reversed_pink_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

    // E4 Series Yellow Strip Livery
    alternative_sprites(ss_e4_series_panto_yellow_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e4_series_panto_reversed_yellow_livery,  ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_reversed(1,81)}	

    // E4 Series Pink Strip Livery
    alternative_sprites(ss_e4_series_panto_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e4_series_panto_reversed_pink_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_reversed(1,81)}	
# 1 "src/trains/e4_series/e4_series_fixed.pnml" 3
# 1 "src/trains/e4_series/e4_series_liveries.pnml" 1
/* E4 Series LIVERIES */

// CAB

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_year_dep_livery, build_year) {
    0..2014: ss_e4_series_cab_yellow_livery;
    2014..9999: ss_e4_series_cab_pink_livery;
    ss_e4_series_cab_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_old_livery, cargo_subtype) {
    1: ss_e4_series_cab_yellow_livery;
    sw_e4_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_new_livery, cargo_subtype) {
    1: ss_e4_series_cab_yellow_livery;
    2: ss_e4_series_cab_pink_livery;
    sw_e4_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_cab, current_year) {
    0..2014: sw_e4_series_cab_old_livery;
    sw_e4_series_cab_new_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_rev_year_dep_livery, build_year) {
    0..2014: ss_e4_series_cab_rev_yellow_livery;
    2014..9999: ss_e4_series_cab_rev_pink_livery;
    ss_e4_series_cab_rev_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_rev_old_livery, cargo_subtype) {
    1: ss_e4_series_cab_rev_yellow_livery;
    sw_e4_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_rev_new_livery, cargo_subtype) {
    1: ss_e4_series_cab_rev_yellow_livery;
    2: ss_e4_series_cab_rev_pink_livery;
    sw_e4_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_cab_rev, current_year) {
    0..2014: sw_e4_series_cab_rev_old_livery;
    sw_e4_series_cab_rev_new_livery;
}

// Coach

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_year_dep_livery, build_year) {
    0..2014: ss_e4_series_coach_yellow_livery;
    2014..9999: ss_e4_series_coach_pink_livery;
    ss_e4_series_coach_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_old_livery, cargo_subtype) {
    1: ss_e4_series_coach_yellow_livery;
    sw_e4_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_new_livery, cargo_subtype) {
    1: ss_e4_series_coach_yellow_livery;
    2: ss_e4_series_coach_pink_livery;
    sw_e4_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_coach, current_year) {
    0..2014: sw_e4_series_coach_old_livery;
    sw_e4_series_coach_new_livery;
}

// Coach Reversed

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_reversed_year_dep_livery, build_year) {
    0..2014: ss_e4_series_coach_reversed_yellow_livery;
    2014..9999: ss_e4_series_coach_reversed_pink_livery;
    ss_e4_series_coach_reversed_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_reversed_old_livery, cargo_subtype) {
    1: ss_e4_series_coach_reversed_yellow_livery;
    sw_e4_series_coach_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_reversed_new_livery, cargo_subtype) {
    1: ss_e4_series_coach_reversed_yellow_livery;
    2: ss_e4_series_coach_reversed_pink_livery;
    sw_e4_series_coach_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_coach_reversed, current_year) {
    0..2014: sw_e4_series_coach_reversed_old_livery;
    sw_e4_series_coach_reversed_new_livery;
}

// Panto

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_year_dep_livery, build_year) {
    0..2014: ss_e4_series_panto_yellow_livery;
    2014..9999: ss_e4_series_panto_pink_livery;
    ss_e4_series_panto_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_old_livery, cargo_subtype) {
    1: ss_e4_series_panto_yellow_livery;
    sw_e4_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_new_livery, cargo_subtype) {
    1: ss_e4_series_panto_yellow_livery;
    2: ss_e4_series_panto_pink_livery;
    sw_e4_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_panto, current_year) {
    0..2014: sw_e4_series_panto_old_livery;
    sw_e4_series_panto_new_livery;
}

// Panto Reversed

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_reversed_year_dep_livery, build_year) {
    0..2014: ss_e4_series_panto_reversed_yellow_livery;
    2014..9999: ss_e4_series_panto_reversed_pink_livery;
    ss_e4_series_panto_reversed_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_reversed_old_livery, cargo_subtype) {
    1: ss_e4_series_panto_reversed_yellow_livery;
    sw_e4_series_panto_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_reversed_new_livery, cargo_subtype) {
    1: ss_e4_series_panto_reversed_yellow_livery;
    2: ss_e4_series_panto_reversed_pink_livery;
    sw_e4_series_panto_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_panto_reversed, current_year) {
    0..2014: sw_e4_series_panto_reversed_old_livery;
    sw_e4_series_panto_reversed_new_livery;
}
# 1 "src/trains/e4_series/e4_series_fixed.pnml" 3
# 1 "src/trains/e4_series/e4_series_stats.pnml" 1
/* Begin E4 Series STATS */

/* RUNNING COSTS */
    running_cost_e4_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_e4_series_running_costs, current_speed) {
        0: running_cost_e4_series / 10 * 8;        // Stopped
        1..15: running_cost_e4_series / 4 * 8;     // Moving below ~33.5 mph
        running_cost_e4_series * 8; 				// Track speed
    }

/* CARGO CAPACITY

    IRL 8 car = 817     JPS 960/1200/1440/1680

        8-car   parts   per part
    RW  816     24      34   
    LS  1224    24      51
    DC  1632    24      68

    */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_e4_series_param_cargo_capacity, param_basecapacity) {
        0: return 34;       // 1x Real World Capacity
        2: return 68;       // 2x Double Real World Capacity
        return 51;          // 1.5x Normal Capacity 
    }

/* LOADING SPEED */

    // 8 car
    switch(FEAT_TRAINS, SELF, sw_e4_series_loading_speed, param_basecapacity) {
        0: return 34 / param_loading_2D;        // 1x Real World Capacity
        2: return 68 / param_loading_2D;        // 2x Double Real World Capacity
        return 51 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }
# 1 "src/trains/e4_series/e4_series_fixed.pnml" 3
# 1 "src/trains/e4_series/e4_series_formation.pnml" 1
/* Begin E4 Series FORMATION*/

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e4_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e4_series_coach;
	ss_e4_series_panto_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e4_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e4_series_coach;
	ss_e4_series_coach_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e4_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e4_series_panto;
	ss_e4_series_coach_reversed;
}

/* PUT TOGETHER THE EMU*/

/* Select the correct part of the train */
switch (FEAT_TRAINS, SELF, sw_e4_series_graphics, position_in_articulated_veh) {
	// Car 1					
	1:  ss_e4_series_cab; 	            // Car 1									
	4:  sw_e4_series_reverser_C_C;	    // Car 2								
	7:  sw_e4_series_reverser_C_P;      // Car 3
	10: sw_e4_series_reverser_P_C;      // Car 4
    13: sw_e4_series_reverser_C_P;      // Car 5
    16: sw_e4_series_reverser_P_C;      // Car 6
    19: sw_e4_series_reverser_C_C;      // Car 7
	22: ss_e4_series_cab_rev;           // Car 8
	dummy_sprites;
}

/* Assemble an 8-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e4_series_articulated_part, extra_callback_info1) {
	1 .. 23: return series_e4;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/e4_series/e4_series_fixed.pnml" 3

item(FEAT_TRAINS, series_e4, 2004) {
	property {
		/* Menu */
        name: 							string(STR_NAME_E4_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
        misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
        running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,12,20);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          241 km/h;					// Operational Top Speed
		power:                          560 * 4 * 8 hp;				// Agreed to Wikipedia
		weight:                         54 * 8 tons;				// Agreed to Wikipedia 
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_E4_SERIES);
        cargo_subtype_text:             sw_e4_series_year_dep_subtype_text;
		can_attach_wagon:				sw_full_jreast_attach_vehid;
        /* Graphics */
        default:                        sw_e4_series_graphics;
		purchase:                       sw_e4_series_year_dep_purchase;
		articulated_part:               sw_e4_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_2_8_2;
		cargo_capacity:                 sw_e4_series_param_cargo_capacity;
		loading_speed:					sw_e4_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    264;
		//refit_cost:                   // N/A - No changes in length 
        running_cost_factor:            sw_e4_series_running_costs;
		purchase_running_cost_factor:   running_cost_e4_series * 8;
	}
}

/* End E4 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e5_series/e5_series_fixed.pnml" 1
/* Begin E5 Series */

# 1 "src/trains/e5_series/e5_series_subtypes.pnml" 1
/* Begin E5 Series SUBTYPES */

// Pre 2016 subtype text
switch(FEAT_TRAINS, SELF, sw_e5_series_old_livery_subtype_text, cargo_subtype) {
	0: return string(LV_E5_SERIES_E5); 
       return CB_RESULT_NO_TEXT;
    }

// Post 2016 subtype text
switch(FEAT_TRAINS, SELF, sw_e5_series_new_livery_subtype_text, cargo_subtype) {
	0: return string(LV_E5_SERIES_E5);
    1: return string(LV_E5_SERIES_H5);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e5_series_year_dep_subtype_text, current_year) {
    0..2016: sw_e5_series_old_livery_subtype_text;
    sw_e5_series_new_livery_subtype_text;
}
# 1 "src/trains/e5_series/e5_series_fixed.pnml" 3
# 1 "src/trains/e5_series/e5_series_gfx.pnml" 1
/* Begin E5 Series GRAPHICS */

/* Purchase Menu */
	spriteset (ss_e5_series_purchase_pink_livery,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
	spriteset (ss_e5_series_purchase_purple_livery,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

	alternative_sprites(ss_e5_series_purchase_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/purchase.png") {template_purchase(0, 0)}
	alternative_sprites(ss_e5_series_purchase_purple_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/purchase.png") {template_purchase(0, 0)}

/* EMU Parts */

/* Cab  */
	spriteset(ss_e5_series_cab_pink_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
	spriteset(ss_e5_series_cab_rev_pink_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
	spriteset(ss_e5_series_cab_purple_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
	spriteset(ss_e5_series_cab_rev_purple_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}


	// E5 Series Pink Strip Livery
	alternative_sprites(ss_e5_series_cab_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png")  {template_12_standard(1,1)}
	alternative_sprites(ss_e5_series_cab_rev_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png")  {template_12_reversed(1,41)}			

	// E5 Series Purple Strip Livery
	alternative_sprites(ss_e5_series_cab_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/e5_series/h5purple.png") {template_12_standard(1,1)}
	alternative_sprites(ss_e5_series_cab_rev_purple_livery,    	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,41)}

// Coach
	spriteset(ss_e5_series_coach_pink_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
	spriteset(ss_e5_series_coach_rev_pink_livery,    			"src/gfx/dummy/empty.png") {template_dummy(0,0)}
	spriteset(ss_e5_series_coach_purple_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
	spriteset(ss_e5_series_coach_rev_purple_livery,    			"src/gfx/dummy/empty.png") {template_dummy(0,0)}

	// E5 Series Pink Strip Livery
	alternative_sprites(ss_e5_series_coach_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_standard(1,121)}
	alternative_sprites(ss_e5_series_coach_rev_pink_livery,		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_reversed(1,121)}

	// E5 Series Purple Strip Livery
	alternative_sprites(ss_e5_series_coach_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_standard(1,121)}
	alternative_sprites(ss_e5_series_coach_rev_purple_livery,  	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,121)}	

// Panto
	spriteset(ss_e5_series_panto_pink_livery,          			"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
	spriteset(ss_e5_series_panto_rev_pink_livery, 				"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
	spriteset(ss_e5_series_panto_purple_livery,          		"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
	spriteset(ss_e5_series_panto_rev_purple_livery, 		    "src/gfx/dummy/empty.png")     						{template_dummy(0,0)}

	// E5 Series pink Strip Livery
	alternative_sprites(ss_e5_series_panto_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_standard(1,81)}
	alternative_sprites(ss_e5_series_panto_rev_pink_livery, 	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_reversed(1,81)}	

	// E5 Series purple Strip Livery
	alternative_sprites(ss_e5_series_panto_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_standard(1,81)}
	alternative_sprites(ss_e5_series_panto_rev_purple_livery,  	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,81)}	
# 1 "src/trains/e5_series/e5_series_fixed.pnml" 3
# 1 "src/trains/e5_series/e5_series_liveries.pnml" 1
/* Begin E5 Series LIVERIES */

// CAB

	switch(FEAT_TRAINS, SELF, sw_e5_series_cab_new_livery, cargo_subtype) {
		1: ss_e5_series_cab_purple_livery;
		ss_e5_series_cab_pink_livery;
	}

	switch(FEAT_TRAINS, SELF, ss_e5_series_cab, current_year) {
		0..2016: ss_e5_series_cab_pink_livery;
		sw_e5_series_cab_new_livery;
	}

	// Reversed
	switch(FEAT_TRAINS, SELF, sw_e5_series_cab_rev_new_livery, cargo_subtype) {
		1: ss_e5_series_cab_rev_purple_livery;
		ss_e5_series_cab_rev_pink_livery;
	}

	switch(FEAT_TRAINS, SELF, ss_e5_series_cab_rev, current_year) {
		0..2016: ss_e5_series_cab_rev_pink_livery;
		sw_e5_series_cab_rev_new_livery;
	}

// COACH

	switch(FEAT_TRAINS, SELF, sw_e5_series_coach_new_livery, cargo_subtype) {
		1: ss_e5_series_coach_purple_livery;
		ss_e5_series_coach_pink_livery;
	}

	switch(FEAT_TRAINS, SELF, ss_e5_series_coach, current_year) {
		0..2016: ss_e5_series_coach_pink_livery;
		sw_e5_series_coach_new_livery;
	}
	
	// Reversed
	switch(FEAT_TRAINS, SELF, sw_e5_series_coach_rev_new_livery, cargo_subtype) {
		1: ss_e5_series_coach_rev_purple_livery;
		ss_e5_series_coach_rev_pink_livery;
	}

	switch(FEAT_TRAINS, SELF, ss_e5_series_coach_rev, current_year) {
		0..2016: ss_e5_series_coach_rev_pink_livery;
		sw_e5_series_coach_rev_new_livery;
	}

// PANTO

	switch(FEAT_TRAINS, SELF, sw_e5_series_panto_new_livery, cargo_subtype) { 
		1: ss_e5_series_panto_purple_livery;
		ss_e5_series_panto_pink_livery;
	}

	switch(FEAT_TRAINS, SELF, ss_e5_series_panto, current_year) {
		0..2016: ss_e5_series_panto_pink_livery;
		sw_e5_series_panto_new_livery;
	}

	// Reversed
	switch(FEAT_TRAINS, SELF, sw_e5_series_panto_rev_new_livery, cargo_subtype) {
		1: ss_e5_series_panto_rev_purple_livery;
		ss_e5_series_panto_rev_pink_livery;
	}

	switch(FEAT_TRAINS, SELF, ss_e5_series_panto_rev, current_year) {
		0..2016: ss_e5_series_panto_rev_pink_livery;
		sw_e5_series_panto_rev_new_livery;
	}
# 1 "src/trains/e5_series/e5_series_fixed.pnml" 3
# 1 "src/trains/e5_series/e5_series_stats.pnml" 1
/* Begin E5 Series STATS */

/* RUNNING COSTS */
    running_cost_e5_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_e5_series_running_costs, current_speed) {
        0: running_cost_e5_series / 10 * 10;        // Stopped
        1..15: running_cost_e5_series / 4 * 10;     // Moving below ~33.5 mph
        running_cost_e5_series * 10; 				// Track speed
    }

/* CARGO CAPACITY

    JPS 780/975/1170/1365

        10-car	Parts	Per Part
    IRL 731		30		24.367
    RW  750  	30		25			
    LS  1110	30		37	
    DC  1500	30		50	

    */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_e5_series_cargo_capacity, param_basecapacity) {
        0: return 25;       // 1x Real World Capacity
        2: return 50;       // 2x Double Real World Capacity
        return 37;          // 1.5x Normal Capacity 
    }

/* LOADING SPEED */

    // 10 car
    switch(FEAT_TRAINS, SELF, sw_e5_series_loading_speed, param_basecapacity) {
        0: return 25 / param_loading_2D;        // 1x Real World Capacity
        2: return 50 / param_loading_2D;        // 2x Double Real World Capacity
        return 37 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }
# 1 "src/trains/e5_series/e5_series_fixed.pnml" 3
# 1 "src/trains/e5_series/e5_series_formation.pnml" 1
/* Begin E5 Series FORMATION */

/* REVERSERS */

	// Coach Car going forwards and a Panto Car going backwards
	switch (FEAT_TRAINS, PARENT, sw_e5_series_reverser_C_P, vehicle_is_reversed) {
		0: ss_e5_series_coach;
		ss_e5_series_panto_rev;
	}

	// Coach Car going forwards and a Coach Car going backwards
	switch (FEAT_TRAINS, PARENT, sw_e5_series_reverser_C_C, vehicle_is_reversed) {
		0: ss_e5_series_coach;
		ss_e5_series_coach_rev;
	}

	// Panto Car going forwards and a Coach Car going backwards
	switch (FEAT_TRAINS, PARENT, sw_e5_series_reverser_P_C, vehicle_is_reversed) {
		0: ss_e5_series_panto;
		ss_e5_series_coach_rev;
	}

/* PUT TOGETHER THE EMU*/

	/* Select the correct part of the train */
	switch (FEAT_TRAINS, SELF, sw_e5_series_graphics, position_in_articulated_veh) {				
		1:  ss_e5_series_cab; 				// Car 1								
		4:  sw_e5_series_reverser_C_C;		// Car 2									
		7:  sw_e5_series_reverser_P_C;		// Car 3
		10: sw_e5_series_reverser_C_P;		// Car 4
		13: sw_e5_series_reverser_C_C;		// Car 5
		16: sw_e5_series_reverser_C_C;		// Car 6
		19: sw_e5_series_reverser_P_C;		// Car 7
		22: sw_e5_series_reverser_C_P;		// Car 8	
		25: sw_e5_series_reverser_C_C;		// Car 9
		28: ss_e5_series_cab_rev;			// Car 10
		dummy_sprites;
	}

	/* Assemble an 10-car articulated vehicle. */
	switch (FEAT_TRAINS, SELF, sw_e5_series_articulated_part, extra_callback_info1) {
		1 .. 29: return series_e5;										// Should be same as range above
		return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
	}
# 1 "src/trains/e5_series/e5_series_fixed.pnml" 3

item(FEAT_TRAINS, series_e5, 2005) {
	property {
		/* Menu */
		name: 							string(STR_NAME_E5_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		/* Availability */
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,05); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		track_type:                     SHINKANSEN;
		/* Cargo */
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
		speed:                          321 km/h;					// Operational Top Speed
		power:                          12900 hp;					// Agreed to https://en.wikipedia.org/wiki/E5_and_H5_Series_Shinkansen
		weight:                         453 tons;					// Agreed to https://en.wikipedia.org/wiki/E5_and_H5_Series_Shinkansen
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
		additional_text:                string(STR_DESC_E5_SERIES);
		cargo_subtype_text:             sw_e5_series_year_dep_subtype_text;
		can_attach_wagon:				sw_full_jreast_attach_vehid;
		/* Graphics */
		default:                        sw_e5_series_graphics;
		purchase:                       ss_e5_series_purchase_pink_livery;
		articulated_part:               sw_e5_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
		/* Stats */
		length:                         sw_length_2_8_2;
		cargo_capacity:                 sw_e5_series_cargo_capacity;
		loading_speed:					sw_e5_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    359;
		running_cost_factor:            sw_e5_series_running_costs;
		purchase_running_cost_factor:   running_cost_e5_series * 10;
	}
}

/* End E5 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e6_series/e6_series.pnml" 1
// Begin e6_series

# 1 "src/trains/e6_series/e6_series_gfx.pnml" 1
// Begin e6_series GRAPHICS

// Purchase Sprites
spriteset (spriteset_e6_series_purchase,	        	"src/gfx/dummy/purchase.png")               		{tmpl_purchase_dh(0, 0)}
alternative_sprites(spriteset_e6_series_purchase,     		
	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     			"src/gfx/e6_series/purchase.png")     	 	{tmpl_purchase_dh_32bpp(0, 0)}
    
// Vehicle Sprites
spriteset(spriteset_e6_series_front_std,                    "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_back_std,                     "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_mid_std,                      "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_mid_panto_std,                "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_back_panto_std,               "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}

spriteset(spriteset_e6_series_rev_front_std,                "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_back_std,                 "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_mid_std,                  "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_mid_panto_std,            "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_back_panto_std,           "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}

spriteset(spriteset_e6_series_revflip_front_std,            "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_back_std,             "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_mid_std,              "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_mid_panto_std,        "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_back_panto_std,       "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}

alternative_sprites(spriteset_e6_series_front_std,          // Front std
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,1)}
alternative_sprites(spriteset_e6_series_back_std,           // Back rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,41)}
alternative_sprites(spriteset_e6_series_mid_std,            // Coach
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,201)}
alternative_sprites(spriteset_e6_series_mid_panto_std,      // Panto rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,161)}
alternative_sprites(spriteset_e6_series_back_panto_std,     // Back Panto rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,121)}

alternative_sprites(spriteset_e6_series_rev_front_std,      // Back rev 
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,41)}
alternative_sprites(spriteset_e6_series_rev_back_std,       // Front rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,1)}
alternative_sprites(spriteset_e6_series_rev_mid_std,        // Coach
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,201)}
alternative_sprites(spriteset_e6_series_rev_mid_panto_std,  // Panto     
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,161)}
alternative_sprites(spriteset_e6_series_rev_back_panto_std, // Front Panto rev     
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1, 81)}

alternative_sprites(spriteset_e6_series_revflip_front_std,  // Back         
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_reversed(1,41)}
alternative_sprites(spriteset_e6_series_revflip_back_std,   // Front    
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,1)}
alternative_sprites(spriteset_e6_series_revflip_mid_std,    // Coach rev     
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_reversed(1,201)}
alternative_sprites(spriteset_e6_series_revflip_mid_panto_std,     // Panto  
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_reversed(1,161)}
alternative_sprites(spriteset_e6_series_revflip_back_panto_std,    // Front Panto   
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1, 81)}
# 1 "src/trains/e6_series/e6_series.pnml" 3
# 1 "src/trains/e6_series/e6_series_stats.pnml" 1
// Begin e6_series STATS

/* CARGO CAPACITY 

    per car JPS   40/50/60/70

        per car
    IRL 48      338/7 = 48.3    
    RW  48          
    LS  60       
    DC  72         
*/

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e6_series_cargo_capacity, param_basecapacity) {
        0: return 48;       // 1x Real World Capacity
        2: return 72;       // Double Real World Capacity (1.5x for Mini-Shinkansen)
        return 60;          // Long Sprite Adjusted Capacity (1.25x for Mini-Shinkansen)
}

// Loading Speed

// Loading Speeds for each parameter level
  switch(FEAT_TRAINS, SELF, sw_e6_series_loading_speed, param_basecapacity) {
      // Loading Capacity for a 1 door
      0: return 48 / param_loading_1D;       // Low Capacity
      2: return 72 / param_loading_1D;       // High Capacity
      return 60 / param_loading_1D;          // Normal Capacity 
  }
# 1 "src/trains/e6_series/e6_series.pnml" 3

/*---END OF SECTION---*/
/*---GFX: Train Reversing Switches---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_front_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_front_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_front_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_front_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_back_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_back_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_back_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_mid_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_mid_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_mid_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_mid_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_back_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_back_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_back_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_front_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_front_livery;
  default : sw_e6_series_gfx_revflip_front_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_back_livery;
  default : sw_e6_series_gfx_revflip_back_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_mid_livery;
  default : sw_e6_series_gfx_revflip_mid_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_panto_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_mid_panto_livery;
  default : sw_e6_series_gfx_revflip_mid_panto_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_panto_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_back_panto_livery;
  default : sw_e6_series_gfx_revflip_back_panto_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_pantograph_pos_std_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 default : sw_e6_series_gfx_rev_mid_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_pantograph_pos_std_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 4 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 7 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 default : sw_e6_series_gfx_rev_mid_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_pantograph_pos_std, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 06, 0x000000FF, 0x41]]){
  0..1 : sw_e6_series_gfx_rev_pantograph_pos_std_sw1;
  default : sw_e6_series_gfx_rev_pantograph_pos_std_sw2;
}
switch(FEAT_TRAINS,SELF, sw_e6_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : sw_e6_series_gfx_rev_pantograph_pos_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_pantocheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e6_series_gfx_rev_back_flippedcheck;
 default : sw_e6_series_gfx_rev_back_panto_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e6_series_gfx_rev_front_flippedcheck;
 0 : sw_e6_series_gfx_rev_back_pantocheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e6_series_gfx_rev_back_pantocheck;
 0 : sw_e6_series_gfx_rev_front_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1111 : sw_e6_series_gfx_rev_frontback_aftermucars;
 default : sw_e6_series_gfx_rev_frontback_nomucars;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2006 : sw_e6_series_gfx_rev_frontback_mucarcheck;
 1111 : sw_e6_series_gfx_rev_front_flippedcheck;
 default : sw_e6_series_gfx_rev_back_pantocheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2006 : sw_e6_series_gfx_rev_frontback_sameid;
 1111 : sw_e6_series_gfx_rev_back_pantocheck;
 default : sw_e6_series_gfx_rev_front_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1111 : sw_e6_series_gfx_rev_pantograph_pos;
 2006 : sw_e6_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantograph_pos_std_sw1, position_in_vehid_chain){
 0 : spriteset_e6_series_mid_panto_std;
 default : spriteset_e6_series_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantograph_pos_std_sw2, position_in_vehid_chain%10){
 1 : spriteset_e6_series_mid_panto_std;
 4 : spriteset_e6_series_mid_panto_std;
 7 : spriteset_e6_series_mid_panto_std;
 default : spriteset_e6_series_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantograph_pos_std, num_vehs_in_vehid_chain){
  0..1 : sw_e6_series_gfx_pantograph_pos_std_sw1;
  default : sw_e6_series_gfx_pantograph_pos_std_sw2;
}
/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantocheck_std, position_in_vehid_chain){
 0: spriteset_e6_series_back_std;
default: spriteset_e6_series_back_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_frontback_flipcheck_std, vehicle_is_flipped){
 0: spriteset_e6_series_front_std;
 default: sw_e6_series_gfx_pantocheck_std;
}
switch(FEAT_TRAINS, PARENT, sw_e6_series_gfx_frontback_std, vehicle_is_reversed){
 0: sw_e6_series_gfx_frontback_flipcheck_std;
 default: sw_e6_series_gfx_rev_idcheck;
}
/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_e6_series_gfx_mucar_revcheck_mid_std, vehicle_is_reversed){
 0: sw_e6_series_gfx_pantograph_pos_std;
 default: sw_e6_series_gfx_rev_idcheck;
}
/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_mucar,  cargo_subtype) {
0 : sw_e6_series_gfx_mucar_revcheck_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_main,  cargo_subtype) {
0 : sw_e6_series_gfx_frontback_std;
}
/*---END OF SECTION---*/

/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_attach_vehid, [vehicle_type_id == series_e6 || vehicle_type_id == mu_car_ms]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_e6, 2006) {
    property {
        name:                           string(STR_NAME_E6_SERIES);
        introduction_date:              date(2013,03,16);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   24;
        reliability_decay:              23;

        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;

        speed:                          321 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          400 * 4 hp;
        weight:                         42 ton;

        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;

        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);

        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e6_series_gfx_main;
		    purchase:                       spriteset_e6_series_purchase;
		    additional_text:	              return string(STR_DESC_E6_SERIES);
        //cargo_subtype_text:           sw_e6_series_subtypetext_main;
        can_attach_wagon:			          sw_e6_series_attach_vehid;
        //start_stop:                   ;
        cargo_capacity:                 sw_e6_series_cargo_capacity;
        cargo_age_period:				        param_decay_express;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_e6_series_gfx_mucar;
        cargo_capacity:                 sw_e6_series_cargo_capacity;
        cargo_age_period:				        param_decay_express;
        loading_speed:                  sw_e6_series_loading_speed;
        //cargo_subtype_text:           sw_e6_series_subtypetext_mucar;
        power:                          400 * 4;
        weight:                         42;
        running_cost_factor:            120;
      }

}

// End e6_series
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e7_series/e7_series_fixed.pnml" 1
/* Begin E7 Series */

# 1 "src/trains/e7_series/e7_series_subtypes.pnml" 1
/* Begin E7 Series SUBTYPES */

    switch(FEAT_TRAINS, SELF, sw_e7_series_subtype_text, cargo_subtype) {
        0: return string(LV_E7_SERIES_E7);
	    1: return string(LV_E7_SERIES_W7);
        return CB_RESULT_NO_TEXT;
        }
# 1 "src/trains/e7_series/e7_series_fixed.pnml" 3
# 1 "src/trains/e7_series/e7_series_gfx.pnml" 1
/* Begin E7 Series GRAPHICS */

/* SPRITES */

    // Purchase Menu
    spriteset (ss_e7_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_e7_series_buy,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_e7_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e7_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e7_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e7_series_cab_rev,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_e7_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e7_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e7_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e7_series_coach_rev,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_e7_series_panto,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e7_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e7_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e7_series_panto_rev,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_reversed(1,81)}	
# 1 "src/trains/e7_series/e7_series_fixed.pnml" 3
// #include "src/trains/e7_series/e7_series_liveries.pnml"
# 1 "src/trains/e7_series/e7_series_stats.pnml" 1
/* Begin E7 Series STATS */

/* RUNNING COSTS */
    running_cost_e7_series = 187;    // 150 is approx JPS
    
    switch (FEAT_TRAINS, SELF, sw_e7_series_running_costs, current_speed) {
        0: running_cost_e7_series / 10 * 12;        // Stopped
        1..15: running_cost_e7_series / 4 * 12;     // Moving below ~33.5 mph
        running_cost_e7_series * 12; 				// Track speed
    }

/* CARGO CAPACITY

    IRL 12 car = 934     JPS 936/1170/1404/1638

        12-car  parts   per part
    IRL 934     36      25.944
    RW  936     36      26   
    LS  1404    36      39
    DC  1872    36      52

    */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_e7_series_cargo_capacity, param_basecapacity) {
        0: return 26;       // 1x Real World Capacity
        2: return 52;       // 2x Double Real World Capacity
        return 39;          // 1.5x Normal Capacity 
    }

/* LOADING SPEED */

    // 12 car
    switch(FEAT_TRAINS, SELF, sw_e7_series_loading_speed, param_basecapacity) {
        0: return 26 / param_loading_2D;        // 1x Real World Capacity
        2: return 52 / param_loading_2D;        // 2x Double Real World Capacity
        return 39 / param_loading_2D;           // 1.5x Long Sprite Adjusted Capacity 
    }
# 1 "src/trains/e7_series/e7_series_fixed.pnml" 3
# 1 "src/trains/e7_series/e7_series_formation.pnml" 1
/* Begin E7 Series FORMATION */

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e7_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e7_series_coach;
	ss_e7_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e7_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e7_series_coach;
	ss_e7_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e7_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e7_series_panto;
	ss_e7_series_coach_rev;
}

/* PUT TOGETHER THE EMU*/

    // 12 Car Set
    switch (FEAT_TRAINS, SELF, sw_e7_series_graphics, position_in_articulated_veh) {					
	    1:  ss_e7_series_cab; 	            // Car 1	Car 12								
	    4:  sw_e7_series_reverser_C_C;	    // Car 2	Car 11	    						
	    7:  sw_e7_series_reverser_P_C;      // Car 3    Car 10
	    10: sw_e7_series_reverser_C_C;      // Car 4    Car 9
        13: sw_e7_series_reverser_C_C;      // Car 5    Car 8
        16: sw_e7_series_reverser_C_P;      // Car 6    Car 7
        19: sw_e7_series_reverser_P_C;      // Car 7    Car 6
	    22: sw_e7_series_reverser_C_C;      // Car 8    Car 5
        25: sw_e7_series_reverser_C_C;      // Car 9    Car 4
        28: sw_e7_series_reverser_C_P;      // Car 10   Car 3
        31: sw_e7_series_reverser_C_C;      // Car 11   Car 2
        34: ss_e7_series_cab_rev;           // Car 12   Car 1
	    dummy_sprites;
    }

/* Assemble an articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e7_series_articulated_part, extra_callback_info1) {
	1 .. 35: return series_e7;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
# 1 "src/trains/e7_series/e7_series_fixed.pnml" 3

item(FEAT_TRAINS, series_e7) {
	property {
		/* Menu */
        name: 							string(STR_NAME_E7_SERIES);
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
        /* Availability */
        climates_available:             ALL_CLIMATES;
		introduction_date:              date(2014,03,15);
		model_life:                     VEHICLE_NEVER_EXPIRES;
		vehicle_life:                   30;
		track_type:                     SHINKANSEN;
        /* Cargo */
        reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		ai_special_flag:                AI_FLAG_PASSENGER;
        cargo_capacity:                 1;                          // Overwritten by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		/* Stats */
        speed:                          275 km/h;				    // Per https://en.wikipedia.org/wiki/E7_and_W7_Series_Shinkansen
		power:                          12000 kW;                   // Per https://en.wikipedia.org/wiki/E7_and_W7_Series_Shinkansen					
		weight:                         540 tons;	                // Per https://en.wikipedia.org/wiki/E7_and_W7_Series_Shinkansen				
		tractive_effort_coefficient:    0.3;
		air_drag_coefficient:			0;
	}
	graphics {
		/* Menu */
        additional_text:                string(STR_DESC_E7_SERIES);
        cargo_subtype_text:             sw_e7_series_subtype_text;
		can_attach_wagon:				sw_full_jreast_attach_vehid;
        /* Graphics */
        default:                        sw_e7_series_graphics;
		purchase:                       ss_e7_series_buy;
		articulated_part:               sw_e7_series_articulated_part;
		visual_effect_and_powered:      sw_visual_effect_and_powered;
        /* Stats */
        length:                         sw_length_2_8_2;
        //power:                          sw_e7_series_power;
        //weight:                         sw_e7_series_weight;
		cargo_capacity:                 sw_e7_series_cargo_capacity;
		loading_speed:					sw_e7_series_loading_speed;
		cargo_age_period:				param_decay_express;
		cost_factor:                    402;
		running_cost_factor:            sw_e7_series_running_costs;
		purchase_running_cost_factor:   running_cost_e7_series * 12;		
	}
}

/* End E7 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e8_series/e8_series.pnml" 1
// Begin E8_series

# 1 "src/trains/e8_series/e8_series_gfx.pnml" 1
// Begin E8_series GRAPHICS

    // Purchase Sprites
        spriteset (spriteset_e8_series_purchase,	        	"src/gfx/dummy/purchase.png") {tmpl_purchase_dh(0, 0)}
        alternative_sprites(spriteset_e8_series_purchase,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/purchase.png") {tmpl_purchase_dh_32bpp(0, 0)}

    // E8 Series
        spriteset(ss_e8_series_cab_original,                    "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_cab_rev_original,                "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_coach_original,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_coach_rev_original,              "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_panto_original,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_panto_rev_original,              "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e8_series_cab_original,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e8_series_cab_rev_original,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e8_series_coach_original,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e8_series_coach_rev_original,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e8_series_panto_original,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e8_series_panto_rev_original,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_reversed(1,81)}
# 1 "src/trains/e8_series/e8_series.pnml" 3
# 1 "src/trains/e8_series/e8_series_liveries.pnml" 1
// Begin E8_series LIVERIES

    // Cab Livery (Yelow Lights)
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_cab_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_cab_original;
    }
    // Cab Reversed Livery (Red lights)
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_cab_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_cab_rev_original;
    }
    // Coach Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_coach_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_coach_original;
    }
    // Coach Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_coach_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_coach_rev_original;
    }
    // Panto Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_panto_original;
    }
    // Panto Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_panto_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_panto_rev_original;

    }
# 1 "src/trains/e8_series/e8_series.pnml" 3
# 1 "src/trains/e8_series/e8_series_stats.pnml" 1
// Begin E8_series STATS

/* CARGO CAPACITY */

  // Passenger Capacities for each parameter level
  switch(FEAT_TRAINS, SELF, sw_e8_series_cargo_capacity, param_basecapacity) {
          0: return 48;       // 1x Real World Capacity
          2: return 72;       // Double Real World Capacity (1.5x for Mini-Shinkansen)
          return 60;          // Long Sprite Adjusted Capacity (1.25x for Mini-Shinkansen)
  }

// Loading Speed

// Loading Speeds for each parameter level
  switch(FEAT_TRAINS, SELF, sw_e8_series_loading_speed, param_basecapacity) {
      // Loading Capacity for a 1 door
      0: return 48 / param_loading_1D;       // Low Capacity
      2: return 72 / param_loading_1D;       // High Capacity
      return 60 / param_loading_1D;          // Normal Capacity 
  }
# 1 "src/trains/e8_series/e8_series.pnml" 3

/* COACH and PANTO flipping */

    // Check if Coach is flipped
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_coach_flippedcheck, vehicle_is_flipped) {
        1 : sw_e8_series_gfx_coach_livery;
        default : sw_e8_series_gfx_coach_rev_livery;
    }
    // Check if Panto is flipped
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_panto_flippedcheck, vehicle_is_flipped) {
        1 : sw_e8_series_gfx_panto_livery;
    default : sw_e8_series_gfx_panto_rev_livery;
    }

/* PANTOGRAPH CHECKS */

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_pantograph_pos_original_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e8_series_gfx_panto_flippedcheck;
 default : sw_e8_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_pantograph_pos_original_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e8_series_gfx_panto_flippedcheck;
 //4 : sw_e8_series_gfx_panto_flippedcheck;
 7 : sw_e8_series_gfx_panto_flippedcheck;
 default : sw_e8_series_gfx_coach_flippedcheck;
}

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_pantograph_pos_original, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e8_series_gfx_rev_pantograph_pos_original_sw1;
  default : sw_e8_series_gfx_rev_pantograph_pos_original_sw2;
}

switch(FEAT_TRAINS,SELF, sw_e8_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : sw_e8_series_gfx_rev_pantograph_pos_original;
}

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e8_series_gfx_cab_rev_livery;
 0 : sw_e8_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e8_series_gfx_cab_livery;
 0 : sw_e8_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1111 : sw_e8_series_gfx_rev_frontback_aftermucars;         // From above switch
 default : sw_e8_series_gfx_rev_frontback_nomucars;         // From above switch
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2008 : sw_e8_series_gfx_rev_frontback_mucarcheck;
 1111 : sw_e8_series_gfx_cab_rev_livery;
 default : sw_e8_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2008 : sw_e8_series_gfx_rev_frontback_sameid;
 1111 : sw_e8_series_gfx_cab_livery;
 default : sw_e8_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1111 : sw_e8_series_gfx_rev_pantograph_pos;        
 2008 : sw_e8_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_pantograph_pos_original_sw1, position_in_vehid_chain){
 0 : ss_e8_series_panto_original;
 default : ss_e8_series_coach_original;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_pantograph_pos_original_sw2, position_in_vehid_chain%10){
 1 : ss_e8_series_panto_original;
 //4 : ss_e8_series_panto_original;
 7 : ss_e8_series_panto_original;
 default : ss_e8_series_coach_original;
}

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_pantograph_pos_original, num_vehs_in_vehid_chain){
  0..2 : sw_e8_series_gfx_pantograph_pos_original_sw1;
  default : sw_e8_series_gfx_pantograph_pos_original_sw2;
}

/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/

// Original Set
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_cab_flipcheck_original, vehicle_is_flipped){
 0: ss_e8_series_cab_original;                             // Cab
 default: ss_e8_series_cab_rev_original;                   // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e8_series_gfx_cab_original, vehicle_is_reversed){
 0: sw_e8_series_gfx_cab_flipcheck_original;               // Above switch
 default: sw_e8_series_gfx_rev_idcheck;             // 
}


/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_e8_series_gfx_mucar_revcheck_mid_original, vehicle_is_reversed){
 0: sw_e8_series_gfx_pantograph_pos_original;
 default: sw_e8_series_gfx_rev_idcheck;
}

/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_mucar,  cargo_subtype) {
0 : sw_e8_series_gfx_mucar_revcheck_mid_original;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_main,  cargo_subtype) {
0 : sw_e8_series_gfx_cab_original;
}
/*---END OF SECTION---*/
/*---GFX: Livery Menu Switches---*/
/*
switch(FEAT_TRAINS, SELF, sw_e8_series_subtypetext_mucar, cargo_subtype) {
0 : string(LV_E8_SERIES_ORIGINAL);
}
switch(FEAT_TRAINS, SELF, sw_e8_series_subtypetext_main, cargo_subtype) {
0 : string(LV_E8_SERIES_ORIGINAL);
}
*/
/*---END OF SECTION---*/
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e8_series_attach_vehid, [vehicle_type_id == series_e8 || vehicle_type_id == mu_car_ms]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

item(FEAT_TRAINS, series_e8) {
    property {
        name:                           string(STR_NAME_E8_SERIES);
        introduction_date:              date(2024,01,01);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    175;
        running_cost_factor:            120;
        speed:                          300 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          400 * 4 hp;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e8_series_gfx_main;
	      purchase:                       spriteset_e8_series_purchase;
		    additional_text:	              return string(STR_DESC_E8_SERIES);
        //cargo_subtype_text:             sw_e8_series_subtypetext_main;
        cargo_age_period:				        param_decay_express;
        can_attach_wagon:			          sw_e8_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car_ms){
        default:                        sw_e8_series_gfx_mucar;
        cargo_capacity:                 sw_e8_series_cargo_capacity;
        cargo_age_period:				        param_decay_express;
        loading_speed:                  sw_e8_series_loading_speed;
        //cargo_subtype_text:             sw_e8_series_subtypetext_mucar;
        power:                          400 * 4;
        weight:                         42;
        running_cost_factor:            120;
      }

}

// End E8_series
# 1 "JPplusShinkansen.pnml" 4

// #include "src/trains/WIP/e5e6_series_fixed.pnml"

// GRF OVERRIDES
# 1 "src/grfoverrides.pnml" 1
if (param_japansetdisable == 0) {
	disable_item(FEAT_TRAINS, 0, 115); //Disables original vehicles
}

//JPSet3 DUPLICATION 

if (param_japansetdisable == 1) {
	engine_override("SZ\0D\00");

	item(FEAT_TRAINS, japanset_0_series, 0x17) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_100_series, 0x3a) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_300_series, 0x3d) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_500_series, 0x46) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_700_series, 0x4b) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_n700_series, 0x5f) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_800_series, 0x4f) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_200_series, 0x4c) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_400_series, 0x400) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e1_series, 0x45) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e2_series, 0x65) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e3_series, 0x401) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e4_series, 0x6d) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e5_series, 0x6e) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e6_series, 0x402) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_e7_series, 0x72) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_pax_car, 0x59) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

	item(FEAT_TRAINS, japanset_mail_car, 0x5a) {
		property {
			climates_available: NO_CLIMATE;
		}
	} 

}
# 1 "JPplusShinkansen.pnml" 4
