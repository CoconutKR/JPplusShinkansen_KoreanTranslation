# 1 "JPplusShinkansen.pnml"
/*---HEADER--*/

//Define the GRF
# 1 "src/header.pnml" 1
 grf {
	grfid:					"KR03";
	name:					string(STR_GRF_NAME);
	desc:					string(STR_GRF_DESC);
	version:				1;
	min_compatible_version: 1;
		//japanset3 removal
		param 4 {
			 param_japansetdisable {
					name: string(STR_PARAM_NAME_JAPANSETDISABLE);
					desc: string(STR_PARAM_DESC_JAPANSETDISABLE);
					type: bool;
					bit:  0;
					def_value: 0;
			 }
		}
		//basecosts
		param 0 {
				param_basecostbuy {
						type: int;
						name: string(STR_PARAM_NAME_BASECOSTMODBUY);
						desc: string(STR_PARAM_DESC_BASECOSTMODBUY);
						min_value: 0;
						max_value: 2;
						def_value: 1;
						names: {
												0: string(STR_PARAM_LOW);
												1: string(STR_PARAM_NORMAL);
												2: string(STR_PARAM_HIGH);
						};
				}
		}
		//runningcosts
		param 1 {
				param_basecostrun {
						type: int;
						name: string(STR_PARAM_NAME_BASECOSTMODRUN);
						desc: string(STR_PARAM_DESC_BASECOSTMODRUN);
						min_value: 0;
						max_value: 4;
						def_value: 2;
						names: {
												0: string(STR_PARAM_VLOW);
												1: string(STR_PARAM_LOW);
												2: string(STR_PARAM_NORMAL);
												3: string(STR_PARAM_HIGH);
												4: string(STR_PARAM_VHIGH);
						};
				}
		}
		//pax capacity
		param 2 {
				param_basecapacity {
						type: int;
						name: string(STR_PARAM_NAME_BASECAPACITY);
						desc: string(STR_PARAM_DESC_BASECAPACITY);
						min_value: 0;
						max_value: 3;
						def_value: 1;
						names: {
												0: string(STR_PARAM_LOW);
												1: string(STR_PARAM_NORMAL);
												2: string(STR_PARAM_HIGH);
												3: string(STR_PARAM_VHIGH);
												//4: string(STR_PARAM_REAL);
						};
				}
		}
		//extra capacity for locals
		param 3 {
			 param_boostcapacity {
					name: string(STR_PARAM_NAME_BOOSTCAPACITY);
					desc: string(STR_PARAM_DESC_BOOSTCAPACITY);
					type: bool;
					bit:  0;
			 }
		}
		//cargo decay
		param 5 {
			 param_cargodecay {
						type: int;
						name: string(STR_PARAM_NAME_DECAY);
						desc: string(STR_PARAM_DESC_DECAY);
						min_value: 0;
						max_value: 2;
						def_value: 0;
						names: {
												0: string(STR_PARAM_NORMAL);
												1: string(STR_PARAM_LOW);
												2: string(STR_PARAM_VLOW);
				};
			 
		}
		
		
	}
}

// Cargo table - Passengers only
cargotable {
	PASS,
}
# 1 "JPplusShinkansen.pnml" 4

//Helpers
# 1 "src/basecosts.pnml" 1
basecost {
		 PR_BUILD_VEHICLE : param_basecostbuy -1;
		 PR_BUILD_VEHICLE_WAGON: param_basecostbuy +3;
		 PR_RUNNING: param_basecostrun +1; //3
}
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/railtypetable.pnml" 1
// Begin railtypetable

// https://newgrf-specs.tt-wiki.net/wiki/TracktypeLabels

railtypetable {

	SHINKANSEN: [
		SADE, 		// JapanSet Tracks - International Mode - Highspeed line
		SAEE, 		// JapanSet Tracks - Japanese Mode - Shinkansen highspeed
		SBEE, 		// JapanSet Tracks - Japanese Mode - Modern Shinkansen highspeed
		SUBE,		// JapanSet Tracks - Japanese Mode - Urban Standard Guage (Electrified)
		SDAE, 		// U&ReRMM 2 - High-Speed Line
		SEAE,		// U&ReRMM 2 - Modern High-Speed Line
		SFAE,		// U&ReRMM 2 - Very High-Speed Line
		SHAE]		// SUKTS - Very High Speed
		,
	MINI_SHINKANSEN: [
		SACE,		// JapanSet Tracks - Modern Standard Guage (Electrified)
		SADE, 		// JapanSet Tracks - International Mode - Highspeed line
		SAEE, 		// JapanSet Tracks - Japanese Mode - Shinkansen highspeed
		SBEE, 		// JapanSet Tracks - Japanese Mode - Modern Shinkansen highspeed
		SUBE,		// JapanSet Tracks - Japanese Mode - Urban Standard Guage (Electrified)
		SDAE, 		// U&ReRMM 2 - High-Speed Line
		SEAE,		// U&ReRMM 2 - Modern High-Speed Line
		SFAE,		// U&ReRMM 2 - Very High-Speed Line
		SHAE],		// SUKTS - Very High Speed
}

// End railtypetable
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/functions.pnml" 1
/* Begin Functions */

switch (FEAT_TRAINS, SELF, func_running_costs, cost, current_speed) {
	0: return cost / 10; 		// Stopped
	1..15: return cost / 4; 	// Moving below ~33.5 mph
	return cost; 				// Track speed
}

switch (FEAT_TRAINS, PARENT, func_is_reversed, vehicle_is_reversed) {return;}

/* End Functions */ 
# 1 "JPplusShinkansen.pnml" 4

// Templates
# 1 "src/template.pnml" 1
// Begin template

/* Dummy Template */

template template_dummy (x, y) {
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
  [0, 0, 2, 2, 0, 0, CROP]
}

/* Purchase Templates */

template template_purchase (x, y) {
		[]
	 	[]
	 	[]
	 	[]
	 	[]
	 	[]
    	[x, y, 75, 15, -28, -10]
		[]
}

template tmpl_purchase_dh (x, y) {
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
        [x, y, 76, 15, -14, -10]
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty.png"]
}
template tmpl_purchase_dh_32bpp (x, y) {
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
	 	[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
        [x, y, 75, 15, -14, -10]
		[1 , 1, 1, 1, 0, 0, "src/gfx/dummy/empty_32bpp.png"]
}

/* EMU Templates */

// STANDARD

template template_12_standard(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y,		8,		36,		-3,			-18]
    [ x+16,		y,		30,		29,		-18,		-19]
    [ x+54,		y,		48,		16,		-24,		-12]
    [ x+110,	y,		30,		29,		-10,		-19]
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+164,	y,		30,		29,		-18,		-19]
    [ x+202,	y,		48,		16,		-24,		-12]
    [ x+258,	y,		30,		29,		-10,		-19]
}

template template_12_reversed(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+164,	y,		30,		29,		-18,		-19]
    [ x+202,	y,		48,		16,		-24,		-12]
    [ x+258,	y,		30,		29,		-10,		-19]
    [ x,		y,		8,		36,		-3,			-18]
    [ x+16,		y,		30,		29,		-18,		-19]
    [ x+54,		y,		48,		16,		-24,		-12]
    [ x+110,	y,		30,		29,		-10,		-19]
}

template template_8_standard(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x,		y,		8,		36,		-3,			-18]
    [ x+20,		y,		22,		27,		-15,		-19]
    [ x+62,		y,		32,		16,		-16,		-12]
    [ x+114,	y,		22,		27,		-08,		-20]
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+168,	y,		22,		27,		-15,		-19]
    [ x+210,	y,		32,		16,		-16,		-12]
    [ x+262,	y,		22,		27,		-08,		-20]
}

template template_8_reversed(x, y) {
    //left_x, upper_y, width, height, offset_x, offset_y
	//							more negative to shift left
	//											more negative to shift up
    [ x+148,	y,		8,		36,		-3,			-18]
    [ x+168,	y,		22,		27,		-15,		-19]
    [ x+210,	y,		32,		16,		-16,		-12]
    [ x+262,	y,		22,		27,		-08,		-20]
    [ x,		y,		8,		36,		-3,			-18]
    [ x+20,		y,		22,		27,		-15,		-19]
    [ x+62,		y,		32,		16,		-16,		-12]
    [ x+114,	y,		22,		27,		-08,		-20]
}

// End template
# 1 "JPplusShinkansen.pnml" 4

//IDs
# 1 "src/vehicleid.pnml" 1

// Assign IDs
item(FEAT_TRAINS, mu_car, 1000) {}
item(FEAT_TRAINS, series_0, 0) {}
item(FEAT_TRAINS, series_100, 100) {}
item(FEAT_TRAINS, series_200, 200) {}
item(FEAT_TRAINS, series_300, 300) {}
item(FEAT_TRAINS, series_400, 400) {}
item(FEAT_TRAINS, series_500, 500) {}
item(FEAT_TRAINS, series_700, 700) {}
item(FEAT_TRAINS, series_800, 800) {}
item(FEAT_TRAINS, series_e1, 2001) {}
item(FEAT_TRAINS, series_e2, 2002) {}
item(FEAT_TRAINS, series_e3, 2003) {}
item(FEAT_TRAINS, series_e4, 2004) {} 
item(FEAT_TRAINS, series_e5, 2005) {} 
item(FEAT_TRAINS, series_e6, 2006) {}
item(FEAT_TRAINS, series_e5e6, 2056) {}
item(FEAT_TRAINS, series_e7, 2007) {}
item(FEAT_TRAINS, series_e8, 2008) {}

// Sort the Order in the Purchase Menu below
sort(FEAT_TRAINS, [

/* Not JR East */
0,      // 0 Series Shinkansen
100,    // 100 Series Shinkansen
300,    // 300 Series Shinkansen
500,    // 500 Series Shinkansen
700,    // 700 Series Shinkansen
800,    // 800 Series Shinkansen

/* JR East */
200,    // 200 Series Shinkansen
400,    // 400 Series Shinkansen
2001,   // E1 Series Shinkansen (Max)
2002,   // E2 Series Shinkansen
2003,   // E3 Series Shinkansen
2004,   // E4 Series Shinkansen (Max)
2005,   // E5 Series Shinkansen
2006,   // E6 Series Shinkansen
2056,   // E5 & E6 Series Shinkansen
2007,   // E7/W7 Series Shinkansen
2008,   // E8 Series Shinkansen

/*MU Cars*/
mu_car,
]);
# 1 "JPplusShinkansen.pnml" 4

// Dummy
# 1 "src/dummy.pnml" 1
 // begin dummy

 // https://www.tt-forums.net/viewtopic.php?f=68&t=53511

spriteset (dummy_sprites, "src/gfx/dummy/empty.png")
{
  [0, 0, 2, 2, 0, 0, CROP]
}

 // end dummy
# 1 "JPplusShinkansen.pnml" 4
// Mucar
# 1 "src/mucar.pnml" 1
// Begin mucar

/*---GFX: Spritesets---*/
spriteset (set_mu_car_purchase,	    "src/gfx/dummy/mucarbuy.png") 	{template_purchase (0, 0)}
spriteset (set_mu_car_base,       	"src/gfx/dummy/mucar.png")     	{template_8_standard(1,1)}


item(FEAT_TRAINS, mu_car) {
    /* Define properties first, make sure to set all of them */
    property {
        name:                         string(MUCAR);
        introduction_date:            date(1800,1,1);
        climates_available:           ALL_CLIMATES;
        model_life:                   VEHICLE_NEVER_EXPIRES;
        vehicle_life:                 60;
        loading_speed:                0;
        cost_factor:                  64;
        running_cost_factor:          6;
        speed:                        0 km/h;
        power:                        0 hp;
        cargo_capacity:               1;
        weight:                       0 ton;
        tractive_effort_coefficient:  0.3;
        air_drag_coefficient:         0;
        reliability_decay:            20;
        refittable_cargo_classes:     bitmask(CC_PASSENGERS);
        cargo_age_period:             185;
        refit_cost:                   0;
        track_type:                   MINI_SHINKANSEN;
        ai_special_flag:              AI_FLAG_PASSENGER;
        running_cost_base:            RUNNING_COST_DIESEL;
        engine_class:                 ENGINE_CLASS_STEAM;
        visual_effect_and_powered:    visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
        sprite_id:                    SPRITE_ID_NEW_TRAIN;
        dual_headed:                  0;
        length:                       8;
        extra_power_per_wagon:        0;
        bitmask_vehicle_info:         0;
    }
    /* Define graphics and callbacks
     * Setting all callbacks is not needed, only define what is used */
    graphics {
		  purchase:                     set_mu_car_purchase;
      additional_text:			        return string(MUCAR_DESC);
      set_mu_car_base;
    }

}

// End mucar
# 1 "JPplusShinkansen.pnml" 4

//Final Settings
# 1 "src/grfintegration.pnml" 1
// Begin grfintegration

//set depot vehicle width to 32px to avoid overlap
train_width_32_px = 1;
//align train properly in depot window
traininfo_y_offset = 2;

// TTD check //
if (ttd_platform != PLATFORM_OPENTTD || openttd_version < version_openttd(1, 2, 0, 22723)) {
	error(FATAL, REQUIRES_OPENTTD, string(GRF_OTTDVER));
}

// 8bpp //
if (ttd_platform != PLATFORM_OPENTTD || openttd_version < version_openttd(1, 2, 0, 22723)) {
	error(FATAL, string(GRF_OTTDVER));
}

// Warn if "JapanSet3: Trains isn't optimal" //
/*
if (((grf_current_status("SZ\0D\00") == 0) && (grf_current_status("DP\30\00") == 0)) || ((grf_future_status("SZ\0D\00") == 0) && (grf_future_status("DP\30\00") == 0)) || ((grf_order_behind("SZ\0D\00") == 0) && (grf_order_behind("DP\30\00") == 0))) {
	error( WARNING, string(GRF_JAPANSET));
}
*/
if (grf_order_behind("BS\42\13") == 0) {
	error(FATAL, string(GRF_JPPLUSSET));
}
/*
if (((grf_order_behind("EN\21\01") == 0) && (grf_order_behind("BS\07\20") != 0)) || ((grf_future_status("EN\21\01") == 0) && (grf_future_status("BS\07\20") == 0)) || ((grf_current_status("EN\21\01") != 0) && (grf_current_status("BS\07\20") == 0))) {
	error(WARNING, string(GRF_NATSSET));
}*/

if (grf_order_behind("SZ\0D\00") == 0) {
	error(WARNING, string(GRF_JAPANSETTRAINS));
}

if (grf_order_behind("JD\A1\E1") == 0) {
	error(WARNING, string(GRF_JAPANSECRETORDER));
}

// End grfintegration
# 1 "JPplusShinkansen.pnml" 4

/*---NON-JR EAST TRAINS---*/
# 1 "src/trains/0_series_fixed.pnml" 1
/* Begin 0 Series */

/* SPRITES */

/* Purchase Menu */
spriteset (ss_0_series_buy_original_livery,	        	        "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_0_series_buy_kodama_livery,	        	        "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_0_series_buy_original_1987,	        	        "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

alternative_sprites(ss_0_series_buy_original_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/purchase_original.png") {template_purchase(0, 0)}
alternative_sprites(ss_0_series_buy_kodama_livery,     	        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/purchase_kodama.png") {template_purchase(0, 0)}
alternative_sprites(ss_0_series_buy_original_1987,              ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/purchase_original_v2.png") {template_purchase(0, 0)}

/* EMU Parts */

/* "CAB" */
spriteset(ss_0_series_cab_original_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_cab_rev_original_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_cab_kodama_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_cab_rev_kodama_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_cab_nose_livery,             		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_cab_rev_nose_livery,    		            "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 0 Series Original Strip Livery
alternative_sprites(ss_0_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_standard(1,1)}
alternative_sprites(ss_0_series_cab_rev_original_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_reversed(1,41)}		

// 0 Series Kodama Strip Livery
alternative_sprites(ss_0_series_cab_kodama_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_standard(1,1)}
alternative_sprites(ss_0_series_cab_rev_kodama_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_reversed(1,41)}	

// 0 Series Nose Livery
alternative_sprites(ss_0_series_cab_nose_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_standard(1,1)}
alternative_sprites(ss_0_series_cab_rev_nose_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_reversed(1,41)}

/* COACH */
spriteset(ss_0_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_coach_kodama_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_coach_rev_kodama_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_coach_nose_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_coach_rev_nose_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 0 Series Original Strip Livery
alternative_sprites(ss_0_series_coach_original_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_0_series_coach_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_reversed(1,121)}

// 0 Series Kodama Strip Livery
alternative_sprites(ss_0_series_coach_kodama_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_standard(1,121)}
alternative_sprites(ss_0_series_coach_rev_kodama_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_reversed(1,121)}	

// 0 Series Nose Livery
alternative_sprites(ss_0_series_coach_nose_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_standard(1,121)}
alternative_sprites(ss_0_series_coach_rev_nose_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_reversed(1,121)}

// PANTO COACH
spriteset(ss_0_series_panto_original_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_panto_rev_original_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_panto_kodama_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_panto_rev_kodama_livery, 		            "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_panto_nose_livery,          		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_0_series_panto_rev_nose_livery, 		            "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 0 Series Original Strip Livery
alternative_sprites(ss_0_series_panto_original_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_0_series_panto_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/original.png") {template_12_reversed(1,81)}	

// 0 Series Kodama Strip Livery
alternative_sprites(ss_0_series_panto_kodama_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_standard(1,81)}
alternative_sprites(ss_0_series_panto_rev_kodama_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/kodama.png") {template_12_reversed(1,81)}	

// 0 Series Nose Livery
alternative_sprites(ss_0_series_panto_nose_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_standard(1,81)}
alternative_sprites(ss_0_series_panto_rev_nose_livery,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/0_series/nose.png") {template_12_reversed(1,81)}	

/* CARGO SUBTYPE MENU */

// From 1964 to 1985
switch(FEAT_TRAINS, SELF, sw_0_series_1964_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_0_SERIES_ORIGINAL);
    2: return string(LV_0_SERIES_NOSE);
       return CB_RESULT_NO_TEXT;
    }

// From 1985 to 1997 - introduction of 6 car R Sets
switch(FEAT_TRAINS, SELF, sw_0_series_1985_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_0_SERIES_ORIGINAL);
    2: return string(LV_0_SERIES_NOSE);
    3: return string(LV_0_SERIES_R);
       return CB_RESULT_NO_TEXT;
    }

// From 1997 to 2002 - introduction of 4 car Q Sets
switch(FEAT_TRAINS, SELF, sw_0_series_1997_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_0_SERIES_ORIGINAL);
    2: return string(LV_0_SERIES_NOSE);
    3: return string(LV_0_SERIES_R);
    4: return string(LV_0_SERIES_Q);
       return CB_RESULT_NO_TEXT;
    }

// From 2002 onwards - introduction of Kodama Livery
switch(FEAT_TRAINS, SELF, sw_0_series_2002_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_0_SERIES_ORIGINAL);
    2: return string(LV_0_SERIES_NOSE);
    3: return string(LV_0_SERIES_R);
    4: return string(LV_0_SERIES_Q);
    5: return string(LV_0_SERIES_KODAMA);
       return CB_RESULT_NO_TEXT;
    }

/* PICK THE LIVERY */

// CAB

switch(FEAT_TRAINS, SELF, sw_0_series_cab_year_dep_livery, build_year) {
    0..2002: ss_0_series_cab_original_livery;
    2002..9999: ss_0_series_cab_kodama_livery;
    ss_0_series_cab_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_1964_livery, cargo_subtype) {
    1: ss_0_series_cab_original_livery;
    2: ss_0_series_cab_nose_livery;
    sw_0_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_1985_livery, cargo_subtype) {
    1: ss_0_series_cab_original_livery;
    2: ss_0_series_cab_nose_livery;
    3: ss_0_series_cab_original_livery;
    sw_0_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_1997_livery, cargo_subtype) {
    1: ss_0_series_cab_original_livery;
    2: ss_0_series_cab_nose_livery;
    3: ss_0_series_cab_original_livery;
    4: ss_0_series_cab_original_livery;
    sw_0_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_2002_livery, cargo_subtype) {
    1: ss_0_series_cab_original_livery;
    2: ss_0_series_cab_nose_livery;
    3: ss_0_series_cab_original_livery;
    4: ss_0_series_cab_original_livery;
    5: ss_0_series_cab_kodama_livery;
    sw_0_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_0_series_cab, current_year) {
    0..1984: sw_0_series_cab_1964_livery;
    1985..1996: sw_0_series_cab_1985_livery;
    1997..2001: sw_0_series_cab_1997_livery;
    sw_0_series_cab_2002_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev_year_dep_livery, build_year) {
    0..2002: ss_0_series_cab_rev_original_livery;
    2002..9999: ss_0_series_cab_rev_kodama_livery;
    ss_0_series_cab_rev_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev_1964_livery, cargo_subtype) {
    1: ss_0_series_cab_rev_original_livery;
    2: ss_0_series_cab_rev_nose_livery;
    sw_0_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev_1985_livery, cargo_subtype) {
    1: ss_0_series_cab_rev_original_livery;
    2: ss_0_series_cab_rev_nose_livery;
    3: ss_0_series_cab_rev_original_livery;
    sw_0_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev_1997_livery, cargo_subtype) {
    1: ss_0_series_cab_rev_original_livery;
    2: ss_0_series_cab_rev_nose_livery;
    3: ss_0_series_cab_rev_original_livery;
    4: ss_0_series_cab_rev_original_livery;
    sw_0_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_cab_rev_2002_livery, cargo_subtype) {
    1: ss_0_series_cab_rev_original_livery;
    2: ss_0_series_cab_rev_nose_livery;
    3: ss_0_series_cab_rev_original_livery;
    4: ss_0_series_cab_rev_original_livery;
    5: ss_0_series_cab_rev_kodama_livery;
    sw_0_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_0_series_cab_rev, current_year) {
    0..1984: sw_0_series_cab_rev_1964_livery;
    1985..1996: sw_0_series_cab_rev_1985_livery;
    1997..2001: sw_0_series_cab_rev_1997_livery;
    sw_0_series_cab_rev_2002_livery;
}

// COACH

switch(FEAT_TRAINS, SELF, sw_0_series_coach_year_dep_livery, build_year) {
    0..2002: ss_0_series_coach_original_livery;
    2002..9999: ss_0_series_coach_kodama_livery;
    ss_0_series_coach_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_1964_livery, cargo_subtype) {
    1: ss_0_series_coach_original_livery;
    2: ss_0_series_coach_nose_livery;
    sw_0_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_1985_livery, cargo_subtype) {
    1: ss_0_series_coach_original_livery;
    2: ss_0_series_coach_nose_livery;
    3: ss_0_series_coach_original_livery;
    sw_0_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_1997_livery, cargo_subtype) {
    1: ss_0_series_coach_original_livery;
    2: ss_0_series_coach_nose_livery;
    3: ss_0_series_coach_original_livery;
    4: ss_0_series_coach_original_livery;
    sw_0_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_2002_livery, cargo_subtype) {
    1: ss_0_series_coach_original_livery;
    2: ss_0_series_coach_nose_livery;
    3: ss_0_series_coach_original_livery;
    4: ss_0_series_coach_original_livery;
    5: ss_0_series_coach_kodama_livery;
    sw_0_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_0_series_coach, current_year) {
    0..1984: sw_0_series_coach_1964_livery;
    1985..1996: sw_0_series_coach_1985_livery;
    1997..2001: sw_0_series_coach_1997_livery;
    sw_0_series_coach_2002_livery;
}

// COACH REVERSED

switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev_year_dep_livery, build_year) {
    0..2002: ss_0_series_coach_rev_original_livery;
    2002..9999: ss_0_series_coach_rev_kodama_livery;
    ss_0_series_coach_rev_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev_1964_livery, cargo_subtype) {
    1: ss_0_series_coach_rev_original_livery;
    2: ss_0_series_coach_rev_nose_livery;
    sw_0_series_coach_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev_1985_livery, cargo_subtype) {
    1: ss_0_series_coach_rev_original_livery;
    2: ss_0_series_coach_rev_nose_livery;
    3: ss_0_series_coach_rev_original_livery;
    sw_0_series_coach_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev_1997_livery, cargo_subtype) {
    1: ss_0_series_coach_rev_original_livery;
    2: ss_0_series_coach_rev_nose_livery;
    3: ss_0_series_coach_rev_original_livery;
    4: ss_0_series_coach_rev_original_livery;
    sw_0_series_coach_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_coach_rev_2002_livery, cargo_subtype) {
    1: ss_0_series_coach_rev_original_livery;
    2: ss_0_series_coach_rev_nose_livery;
    3: ss_0_series_coach_rev_original_livery;
    4: ss_0_series_coach_rev_original_livery;
    5: ss_0_series_coach_rev_kodama_livery;
    sw_0_series_coach_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_0_series_coach_rev, current_year) {
    0..1984: sw_0_series_coach_rev_1964_livery;
    1985..1996: sw_0_series_coach_rev_1985_livery;
    1997..2001: sw_0_series_coach_rev_1997_livery;
    sw_0_series_coach_rev_2002_livery;
}

// PANTO

switch(FEAT_TRAINS, SELF, sw_0_series_panto_year_dep_livery, build_year) {
    0..2002: ss_0_series_panto_original_livery;
    2002..9999: ss_0_series_panto_kodama_livery;
    ss_0_series_panto_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_1964_livery, cargo_subtype) {
    1: ss_0_series_panto_original_livery;
    2: ss_0_series_panto_nose_livery;
    sw_0_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_1985_livery, cargo_subtype) {
    1: ss_0_series_panto_original_livery;
    2: ss_0_series_panto_nose_livery;
    3: ss_0_series_panto_original_livery;
    sw_0_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_1997_livery, cargo_subtype) {
    1: ss_0_series_panto_original_livery;
    2: ss_0_series_panto_nose_livery;
    3: ss_0_series_panto_original_livery;
    4: ss_0_series_panto_original_livery;
    sw_0_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_2002_livery, cargo_subtype) {
    1: ss_0_series_panto_original_livery;
    2: ss_0_series_panto_nose_livery;
    3: ss_0_series_panto_original_livery;
    4: ss_0_series_panto_original_livery;
    5: ss_0_series_panto_kodama_livery;
    sw_0_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_0_series_panto, current_year) {
    0..1984: sw_0_series_panto_1964_livery;
    1985..1996: sw_0_series_panto_1985_livery;
    1997..2001: sw_0_series_panto_1997_livery;
    sw_0_series_panto_2002_livery;
}

// PANTO REVERSED

switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev_year_dep_livery, build_year) {
    0..2002: ss_0_series_panto_rev_original_livery;
    2002..9999: ss_0_series_panto_rev_kodama_livery;
    ss_0_series_panto_rev_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev_1964_livery, cargo_subtype) {
    1: ss_0_series_panto_rev_original_livery;
    2: ss_0_series_panto_rev_nose_livery;
    sw_0_series_panto_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev_1985_livery, cargo_subtype) {
    1: ss_0_series_panto_rev_original_livery;
    2: ss_0_series_panto_rev_nose_livery;
    3: ss_0_series_panto_rev_original_livery;
    sw_0_series_panto_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev_1997_livery, cargo_subtype) {
    1: ss_0_series_panto_rev_original_livery;
    2: ss_0_series_panto_rev_nose_livery;
    3: ss_0_series_panto_rev_original_livery;
    4: ss_0_series_panto_rev_original_livery;
    sw_0_series_panto_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_0_series_panto_rev_2002_livery, cargo_subtype) {
    1: ss_0_series_panto_rev_original_livery;
    2: ss_0_series_panto_rev_nose_livery;
    3: ss_0_series_panto_rev_original_livery;
    4: ss_0_series_panto_rev_original_livery;
    5: ss_0_series_panto_rev_kodama_livery;
    sw_0_series_panto_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_0_series_panto_rev, current_year) {
    0..1984: sw_0_series_panto_rev_1964_livery;
    1985..1996: sw_0_series_panto_rev_1985_livery;
    1997..2001: sw_0_series_panto_rev_1997_livery;
    sw_0_series_panto_rev_2002_livery;
}

/* Purchase Menu Sprites */

switch(FEAT_TRAINS, SELF, sw_0_series_year_dep_purchase, current_year) {
    0..1986: ss_0_series_buy_original_livery;       // JNR
    1987..2002: ss_0_series_buy_original_1987;      // JR West & JR Central
    ss_0_series_buy_kodama_livery;                  // JR West
}

switch(FEAT_TRAINS, SELF, sw_0_series_year_dep_subtype_text, current_year) {
    0..1984: sw_0_series_1964_subtype_text;
    1985..1996: sw_0_series_1985_subtype_text;
    1997..2001: sw_0_series_1997_subtype_text;
    sw_0_series_2002_subtype_text;
}

/* REVERSERS */

    // Coach-Panto
    switch (FEAT_TRAINS, PARENT, sw_0_series_reverser_C_P, vehicle_is_reversed) {
	    0: ss_0_series_coach;
	    ss_0_series_panto_rev;
    }
    // Panto - Coach
    switch (FEAT_TRAINS, PARENT, sw_0_series_reverser_P_C, vehicle_is_reversed) {
	    0: ss_0_series_panto;
	    ss_0_series_coach_rev;
    }

/* LENGTH*/

    // Make the Middle long sprite length 8 and the dummy sprites length 2
    switch (FEAT_TRAINS, SELF, sw_0_series_length_standard, position_in_consist%3) {
        1: return 8;
        return 2;
    }

    // Make a 12 car set by adjusting sprite sizes
    switch(FEAT_TRAINS, SELF, sw_0_series_shorten_12_car_vehicle, position_in_consist%4) {
        2: return 8;
        3: return 2;
        return 1;
    }

    // Make a 6 car set by adjusting sprite sizes
    switch(FEAT_TRAINS, SELF, sw_0_series_shorten_6_car_vehicle, position_in_consist%8) {
        2: return 5;
        return 1;
    }

switch(FEAT_TRAINS, SELF, sw_0_series_length, cargo_subtype) {
    2: sw_0_series_shorten_12_car_vehicle;      // Nose Set
    3: sw_0_series_shorten_6_car_vehicle;       // R Set
    4: return 1;                                // Q Set
    sw_0_series_length_standard;                // All other 16-length sets
}

/* PUT TOGETHER THE EMU*/

/* 16-car sent */
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_16car, position_in_articulated_veh) {
                                    // 16-car   
    1:  ss_0_series_cab; 	        // Car 1    	
	4:  sw_0_series_reverser_P_C;	// Car 2	
	7:  sw_0_series_reverser_C_P;   // Car 3    
	10: sw_0_series_reverser_P_C;   // Car 4    
    13: sw_0_series_reverser_C_P;   // Car 5    
    16: sw_0_series_reverser_P_C;   // Car 6   
    19: sw_0_series_reverser_C_P;   // Car 7    
	22: sw_0_series_reverser_P_C;   // Car 8    
    25: sw_0_series_reverser_C_P;   // Car 9    
    28: sw_0_series_reverser_P_C;   // Car 10   
    31: sw_0_series_reverser_C_P;   // Car 11   
    34: sw_0_series_reverser_P_C;   // Car 12   
    37: sw_0_series_reverser_C_P;   // Car 13   
    40: sw_0_series_reverser_P_C;   // Car 14   
    43: sw_0_series_reverser_C_P;   // Car 15   
    46: ss_0_series_cab_rev;           // Car 16   
	dummy_sprites;
}

// For 12-car set
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_12car, position_in_articulated_veh) {
                                    // 12-car
    2:  ss_0_series_cab; 	        // Car 1	
	6:  sw_0_series_reverser_P_C;   // Car 2
    10: sw_0_series_reverser_C_P;   // Car 3
    14: sw_0_series_reverser_P_C;   // Car 4 
    18: sw_0_series_reverser_C_P;   // Car 5
    22: sw_0_series_reverser_P_C;   // Car 6
    26: sw_0_series_reverser_C_P;   // Car 7
    30: sw_0_series_reverser_P_C;   // Car 8
    34: sw_0_series_reverser_C_P;   // Car 9
    38: sw_0_series_reverser_P_C;   // Car 10
    42: sw_0_series_reverser_C_P;   // Car 11
    46: ss_0_series_cab_rev;        // Car 12
	dummy_sprites;
}

// For 4-car set
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_4car, position_in_articulated_veh) {
                                    // 4-car
    4:  ss_0_series_cab; 	        // Car 1	
	16: sw_0_series_reverser_P_C;   // Car 2
    28: sw_0_series_reverser_C_P;   // Car 3
    10: ss_0_series_cab_rev;           // Car 4
	dummy_sprites;
}

// For 6-car set
switch (FEAT_TRAINS, SELF, sw_0_series_graphics_6car, position_in_articulated_veh) {
                                    // 6-car
    2:  ss_0_series_cab; 	        // Car 1	
	10: sw_0_series_reverser_P_C;   // Car 2
    18: sw_0_series_reverser_C_P;   // Car 3
    26: sw_0_series_reverser_P_C;   // Car 4
    34: sw_0_series_reverser_C_P;   // Car 5
    42: ss_0_series_cab_rev;        // Car 6
	dummy_sprites;
}

/* Choose which Graphics based on which Cargo Subtype */
switch(FEAT_TRAINS, SELF, sw_0_series_graphics, cargo_subtype) {
    2: sw_0_series_graphics_12car;
    3: sw_0_series_graphics_6car;
    4: sw_0_series_graphics_4car;
    sw_0_series_graphics_16car;
}

/* Assemble an 48 part articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_0_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_0;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
 
switch (FEAT_TRAINS, SELF, sw_0_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// CARGO CAPACITY

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_0_series_param_cargo_capacity, param_basecapacity) {
        // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
        0: return 52;       // Low Capacity
        2: return 78;       // High Capacity
        3: return 91;       // Very High Capacity
        return 65;          // Normal Capacity 
    }

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_0_series_cargo_capacity_factor, cargo_subtype) {
        2: return 3750;     // Length 12 (9 tiles)
        3: return 1875;     // Length 6 (4.5 tiles)
        4: return 1250;     // Length 4 (3 tiles)
        return 5000;        // Length 16 (12 tiles)
    }

    switch(FEAT_TRAINS, SELF, sw_0_series_cargo_capacity, (sw_0_series_param_cargo_capacity() * sw_0_series_cargo_capacity_factor() ) / 10000 )
        {return;}

// RUNNING COSTS
    switch(FEAT_TRAINS, SELF, sw_0_series_running_costs, cargo_subtype) {
        2: return 225; 
        3: return 187;
        4: return 113;
        return 300;
    }

// WEIGHT
    switch(FEAT_TRAINS, SELF, sw_0_series_weight, cargo_subtype) {
        2: return 1098;     // Weight of a 9.0 tile long JapanSet 0 Series
        3: return 549;      // Weight of a 4.5 tile long JapanSet 0 Series
        4: return 366;      // Weight of a 3.0 tile long JapanSet 0 Series
        return 1464;        // Weight of a 12.0 tile long JapanSet 0 Series
    }

// POWER
    switch(FEAT_TRAINS, SELF, sw_0_series_power, cargo_subtype) {
        2: return 18750;    // 12-car    
        3: return 9375;     // 6-car 
        4: return 6250;     // 4-car    
        return 25000;       // 16-car       
    }

// SPEED
    switch (FEAT_TRAINS, SELF, sw_0_series_speed, current_year) {
	    0..1986: return 210;                        // Until 1986, Speed = 210 km/h
	    return 220;                                 // After 1986, Speed = 220 km/h
}

item(FEAT_TRAINS, series_0) {
	property {
		name: 							string(STR_NAME_0_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1964,10,01);           // Date of launch
		model_life:                     34;		                    // Until 2008
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          210 km/h;                   // Changed by callback
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_0_series_graphics;
		purchase:                       sw_0_series_year_dep_purchase;
		articulated_part:               sw_0_series_articulated_part;
		length:                         sw_0_series_length;
        weight:                         sw_0_series_weight;
        power:                          sw_0_series_power;
        speed:							sw_0_series_speed;
		cargo_capacity:                 sw_0_series_cargo_capacity;
		cargo_subtype_text:             sw_0_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            sw_0_series_running_costs;              // Varies depending on length
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_0_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_0_SERIES);
	}
}

/* End 0 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/700_series_fixed.pnml" 1
/* Begin 700 Series */

/* CARGO SUBTYPE MENU*/

    switch(FEAT_TRAINS, SELF, sw_700_series_subtype_text, cargo_subtype) {
	    0: return string(LV_700_SERIES_ORIGINAL);
        1: return string(LV_700_SERIES_HIKARI);
        return CB_RESULT_NO_TEXT;
        }

/* SPRITES */

    /* Purchase Menu */
    spriteset (ss_700_series_buy,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    alternative_sprites(ss_700_series_buy,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/700_series/purchase.png") {template_purchase(0, 0)}

    /* EMU Parts */

    /* "CAB" */
    spriteset(ss_700_series_cab_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_cab_rev_original_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_cab_hikari_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_cab_rev_hikari_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 700 Series Original Strip Livery
    alternative_sprites(ss_700_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_standard(1,1)}
    alternative_sprites(ss_700_series_cab_rev_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_reversed(1,41)}		

    // 700 Series Hikari Strip Livery
    alternative_sprites(ss_700_series_cab_hikari_livery,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_standard(1,1)}
    alternative_sprites(ss_700_series_cab_rev_hikari_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_reversed(1,41)}

    /* COACH */
    spriteset(ss_700_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_coach_hikari_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_coach_rev_hikari_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 700 Series Original Strip Livery
    alternative_sprites(ss_700_series_coach_original_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_standard(1,121)}
    alternative_sprites(ss_700_series_coach_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/original.png") {template_12_reversed(1,121)}

    // 700 Series Hikari Strip Livery
    alternative_sprites(ss_700_series_coach_hikari_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_standard(1,121)}
    alternative_sprites(ss_700_series_coach_rev_hikari_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_reversed(1,121)}	

    // Coach Panto
    spriteset(ss_700_series_panto_original_livery,          		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_panto_rev_original_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_panto_hikari_livery,          		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
    spriteset(ss_700_series_panto_rev_hikari_livery, 		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

    // 700 Series Original Strip Livery
    alternative_sprites(ss_700_series_panto_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/700_series/original.png") {template_12_standard(1,81)}
    alternative_sprites(ss_700_series_panto_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/700_series/original.png") {template_12_reversed(1,81)}	

    // 700 Series Hikari Strip Livery
    alternative_sprites(ss_700_series_panto_hikari_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_standard(1,81)}
    alternative_sprites(ss_700_series_panto_rev_hikari_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/700_series/hikari.png") {template_12_reversed(1,81)}	

/* PICK THE LIVERY */

    // CAB

    switch(FEAT_TRAINS, SELF, ss_700_series_cab, cargo_subtype) {
        1: ss_700_series_cab_hikari_livery;
        ss_700_series_cab_original_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_700_series_cab_rev, cargo_subtype) {
        1: ss_700_series_cab_rev_hikari_livery;
        ss_700_series_cab_rev_original_livery;
    }

    // COACH

    switch(FEAT_TRAINS, SELF, ss_700_series_coach, cargo_subtype) {
        1: ss_700_series_coach_hikari_livery;
        ss_700_series_coach_original_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_700_series_coach_rev, cargo_subtype) {
        1: ss_700_series_coach_rev_hikari_livery;
        ss_700_series_coach_rev_original_livery;
    }

    // PANTO

    switch(FEAT_TRAINS, SELF, ss_700_series_panto, cargo_subtype) {
        1: ss_700_series_panto_hikari_livery;
        ss_700_series_panto_original_livery;
    }

    switch(FEAT_TRAINS, SELF, ss_700_series_panto_rev, cargo_subtype) {
        1: ss_700_series_panto_rev_hikari_livery;
        ss_700_series_panto_rev_original_livery;
    }

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_700_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_700_series_coach;
	    ss_700_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_700_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_700_series_panto;
	    ss_700_series_panto_rev;
    }

/* LENGTH*/

    /* Make the Middle long sprite length 8 and the dummy sprites length 2*/
    switch (FEAT_TRAINS, SELF, sw_700_series_length_standard, position_in_consist%3) {
        1: return 8;
        return 2;
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_shorten_8_car_vehicle, position_in_consist%6) {
        2: return 7;
        return 1;
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_length, cargo_subtype) {
        1: sw_700_series_shorten_8_car_vehicle;
        sw_700_series_length_standard;
    }

/* PUT TOGETHER THE EMU*/

    /* Select the correct part of the train */
    switch (FEAT_TRAINS, SELF, sw_700_series_graphics_16car, position_in_articulated_veh) {					
	    1:  ss_700_series_cab; 	                // Car 1	Car 16								
	    4:  sw_700_series_reverser_C_C;	        // Car 2	Car 15	    						
	    7:  sw_700_series_reverser_C_C;         // Car 3    Car 14
	    10: sw_700_series_reverser_C_C;         // Car 4    Car 13
        13: sw_700_series_reverser_P_P;         // Car 5    Car 12
        16: sw_700_series_reverser_C_C;         // Car 6    Car 11
        19: sw_700_series_reverser_C_C;         // Car 7    Car 10
	    22: sw_700_series_reverser_C_C;         // Car 8    Car 9
        25: sw_700_series_reverser_C_C;         // Car 9    Car 8
        28: sw_700_series_reverser_C_C;         // Car 10   Car 7
        31: sw_700_series_reverser_C_C;         // Car 11   Car 6
        34: sw_700_series_reverser_P_P;         // Car 12   Car 5
        37: sw_700_series_reverser_C_C;         // Car 13   Car 4
        40: sw_700_series_reverser_C_C;         // Car 14   Car 3
        43: sw_700_series_reverser_C_C;         // Car 15   Car 2
        46: ss_700_series_cab_rev;              // Car 16   Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_graphics_8car, position_in_articulated_veh) {					
	    2:  ss_700_series_cab; 	                // Car 1	Car 8								
	    8:  sw_700_series_reverser_P_P;	        // Car 2	Car 7	    						
	    14: sw_700_series_reverser_C_C;         // Car 3    Car 6
	    20: sw_700_series_reverser_C_C;         // Car 4    Car 5
        26: sw_700_series_reverser_C_C;         // Car 5    Car 4
        32: sw_700_series_reverser_C_C;         // Car 6    Car 3
        38: sw_700_series_reverser_P_P;         // Car 7    Car 2
        44: ss_700_series_cab_rev;              // Car 8    Car 1
	    dummy_sprites;
    }

    switch (FEAT_TRAINS, SELF, sw_700_series_graphics, cargo_subtype) {
        1: sw_700_series_graphics_8car;
        sw_700_series_graphics_16car;
    }

/* Assemble an 16-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_700_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_700;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_700_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_700_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 100 capacity per car (same as JapanSet)
    0: return 52;       // Low Capacity
    2: return 78;       // High Capacity
    3: return 91;       // Very High Capacity
    return 65;          // Normal Capacity 
}

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_700_series_cargo_capacity_factor, cargo_subtype) {
        1: return 25;     // Length 8 (6.0 tiles)
        return 50;        // Length 16 (12.0 tiles)
    }

    switch(FEAT_TRAINS, SELF, sw_700_series_cargo_capacity, (sw_700_series_param_cargo_capacity() * sw_700_series_cargo_capacity_factor() ) / 100 ) {return;}

item(FEAT_TRAINS, series_700) {
	property {
		name: 							string(STR_NAME_700_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1999,03,13);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          286 km/h;				// Operational Top Speed
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					// Agreed to Wikipedia
		weight:                         648 tons;					// Agreed to Wikipedia 
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_700_series_graphics;
		purchase:                       ss_700_series_buy;
		articulated_part:               sw_700_series_articulated_part;
		length:                         sw_700_series_length;
		cargo_capacity:                 sw_700_series_cargo_capacity;
		cargo_subtype_text:             sw_700_series_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_700_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_700_SERIES);
	}
}

/* End 700 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/500_series_fixed.pnml" 1
/* Begin 500 Series */

/* CARGO SUBTYPE MENU*/

    // None (for now)

/* SPRITES */

    // Purchase Menu
    spriteset (ss_500_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_500_series_buy,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_500_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_500_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_500_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_500_series_cab_rev,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_500_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_500_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_500_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_500_series_coach_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_500_series_panto,          		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_500_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_500_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_500_series_panto_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/500_series/500_series.png") {template_12_reversed(1,81)}	

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_C_P, vehicle_is_reversed) {
	    0: ss_500_series_coach;
	    ss_500_series_panto_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_500_series_coach;
	    ss_500_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_500_series_reverser_P_C, vehicle_is_reversed) {
	    0: ss_500_series_panto;
	    ss_500_series_coach_rev;
    }

/* LENGTH*/

    // Make the Middle long sprite length 8 and the dummy sprites length 2
    switch (FEAT_TRAINS, SELF, sw_500_series_length, position_in_consist%3) {
        1: return 8;
        return 2;
    }

/* PUT TOGETHER THE EMU*/

    // 16 Car Set
    switch (FEAT_TRAINS, SELF, sw_500_series_graphics, position_in_articulated_veh) {					
	    1:  ss_500_series_cab; 	            // Car 1	Car 16								
	    4:  sw_500_series_reverser_C_C;	    // Car 2	Car 15	    						
	    7:  sw_500_series_reverser_C_C;     // Car 3    Car 14
	    10: sw_500_series_reverser_C_C;     // Car 4    Car 13
        13: sw_500_series_reverser_C_P;     // Car 5    Car 12
        16: sw_500_series_reverser_P_C;     // Car 6    Car 11
        19: sw_500_series_reverser_C_C;     // Car 7    Car 10
	    22: sw_500_series_reverser_C_C;     // Car 8    Car 9
        25: sw_500_series_reverser_C_C;     // Car 9    Car 8
        28: sw_500_series_reverser_C_C;     // Car 10   Car 7
        31: sw_500_series_reverser_C_P;     // Car 11   Car 6
        34: sw_500_series_reverser_P_C;     // Car 12   Car 5
        37: sw_500_series_reverser_C_C;     // Car 13   Car 4
        40: sw_500_series_reverser_C_C;     // Car 14   Car 3
        43: sw_500_series_reverser_C_C;     // Car 15   Car 2
        46: ss_500_series_cab_rev;          // Car 16   Car 1 
	    dummy_sprites;
    }

    /* Assemble an articulated vehicle. */
    switch (FEAT_TRAINS, SELF, sw_500_series_articulated_part, extra_callback_info1) {
	    1 .. 47: return series_500;										// Should be same as range above
	    return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }

    switch (FEAT_TRAINS, SELF, sw_500_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	    1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	    return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
    }

/* CARGO CAPACITY */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_500_series_param_cargo_capacity, param_basecapacity) {
        // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
        0: return 52;       // Low Capacity
        2: return 78;       // High Capacity
        3: return 92;       // Very High Capacity
        return 66;          // Normal Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_500_series_cargo_capacity, (sw_500_series_param_cargo_capacity()  / 2 ) ){return;}     // Half since n * 1.5 (long)/ 3 (3 parts per car)


item(FEAT_TRAINS, series_500) {
	property {
		name: 							string(STR_NAME_500_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          300 km/h;				
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          25000 kW;					
		weight:                         1056 tons;					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_500_series_graphics;
		purchase:                       ss_500_series_buy;
		articulated_part:               sw_500_series_articulated_part;
		length:                         sw_500_series_length;
        //power:                          sw_500_series_power;
        //weight:                         sw_500_series_weight;
		cargo_capacity:                 sw_500_series_cargo_capacity;
		//cargo_subtype_text:             sw_500_series_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_500_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_500_SERIES);
	}
}

/* End 500 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/300_series_fixed.pnml" 1
/* Begin 300 Series */

/* CARGO SUBTYPE MENU*/

    // None

/* SPRITES */

    // Purchase Menu
    spriteset (ss_300_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_300_series_buy,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_300_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_300_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_300_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_300_series_cab_rev,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_300_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_300_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_300_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_300_series_coach_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_300_series_panto,          		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_300_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_300_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_300_series_panto_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/300_series/300_series.png") {template_12_reversed(1,81)}	

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_C_P, vehicle_is_reversed) {
	    0: ss_300_series_coach;
	    ss_300_series_panto_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_300_series_coach;
	    ss_300_series_coach_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_300_series_reverser_P_C, vehicle_is_reversed) {
	    0: ss_300_series_panto;
	    ss_300_series_coach_rev;
    }

/* LENGTH*/

    // Make the Middle long sprite length 8 and the dummy sprites length 2
    switch (FEAT_TRAINS, SELF, sw_300_series_length, position_in_consist%3) {
        1: return 8;
        return 2;
    }

/* PUT TOGETHER THE EMU*/

    // 16 Car Set
    switch (FEAT_TRAINS, SELF, sw_300_series_graphics, position_in_articulated_veh) {					
	    1:  ss_300_series_cab; 	            // Car 1	Car 16								
	    4:  sw_300_series_reverser_C_C;	    // Car 2	Car 15	    						
	    7:  sw_300_series_reverser_C_C;     // Car 3    Car 14
	    10: sw_300_series_reverser_C_C;     // Car 4    Car 13
        13: sw_300_series_reverser_C_P;     // Car 5    Car 12
        16: sw_300_series_reverser_P_C;     // Car 6    Car 11
        19: sw_300_series_reverser_C_C;     // Car 7    Car 10
	    22: sw_300_series_reverser_C_C;     // Car 8    Car 9
        25: sw_300_series_reverser_C_C;     // Car 9    Car 8
        28: sw_300_series_reverser_C_C;     // Car 10   Car 7
        31: sw_300_series_reverser_C_P;     // Car 11   Car 6
        34: sw_300_series_reverser_P_C;     // Car 12   Car 5
        37: sw_300_series_reverser_C_C;     // Car 13   Car 4
        40: sw_300_series_reverser_C_C;     // Car 14   Car 3
        43: sw_300_series_reverser_C_C;     // Car 15   Car 2
        46: ss_300_series_cab_rev;          // Car 16   Car 1 
	    dummy_sprites;
    }

    /* Assemble an articulated vehicle. */
    switch (FEAT_TRAINS, SELF, sw_300_series_articulated_part, extra_callback_info1) {
	    1 .. 47: return series_300;										// Should be same as range above
	    return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }

    switch (FEAT_TRAINS, SELF, sw_300_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	    1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	    return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
    }

/* CARGO CAPACITY */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_300_series_param_cargo_capacity, param_basecapacity) {
        // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
        0: return 52;       // Low Capacity
        2: return 78;       // High Capacity
        3: return 92;       // Very High Capacity
        return 66;          // Normal Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_300_series_cargo_capacity, (sw_300_series_param_cargo_capacity()  / 2 ) ){return;}     // Half since n * 1.5 (long)/ 3 (3 parts per car)


item(FEAT_TRAINS, series_300) {
	property {
		name: 							string(STR_NAME_300_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1992,03,01);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          270 km/h;				
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          25000 kW;					
		weight:                         1056 tons;					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_300_series_graphics;
		purchase:                       ss_300_series_buy;
		articulated_part:               sw_300_series_articulated_part;
		length:                         sw_300_series_length;
        //power:                          sw_300_series_power;
        //weight:                         sw_300_series_weight;
		cargo_capacity:                 sw_300_series_cargo_capacity;
		//cargo_subtype_text:             sw_300_series_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_300_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_300_SERIES);
	}
}

/* End 300 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/100_series_fixed.pnml" 1
/* Begin 100 Series */

/* CARGO SUBTYPE MENU*/

// From 1985 to 1988
switch(FEAT_TRAINS, SELF, sw_100_series_1985_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_100_SERIES_X);       // 16-car set
       return CB_RESULT_NO_TEXT;
    }

// From 1988 to 2000 - introduction of V set with more double decker cars
switch(FEAT_TRAINS, SELF, sw_100_series_1988_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_100_SERIES_X);      // 16-car set
    2: return string(LV_100_SERIES_V);
       return CB_RESULT_NO_TEXT;
    }

// From 2000 to 2002 - introduction of 4-car P Set
switch(FEAT_TRAINS, SELF, sw_100_series_2000_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_100_SERIES_X);      // 16-car set
    2: return string(LV_100_SERIES_V);
    3: return string(LV_100_SERIES_P);
       return CB_RESULT_NO_TEXT;
    }

// From 2002 onwards - introduction of 6-car K Set
switch(FEAT_TRAINS, SELF, sw_100_series_2002_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_100_SERIES_X);      // 16-car set
    2: return string(LV_100_SERIES_V);
    3: return string(LV_100_SERIES_P);
    4: return string(LV_100_SERIES_K);
       return CB_RESULT_NO_TEXT;
    }

/* SPRITES */

/* Purchase Menu */
spriteset (ss_100_series_buy_original_jnr,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_original_jrc,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_original_c_w,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_kodama_c_w,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_100_series_buy_kodama_jrw,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

alternative_sprites(ss_100_series_buy_original_jnr,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_original_jnr.png") {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_original_jrc,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_original_jrc.png") {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_original_c_w,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_original_c&w.png") {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_kodama_c_w,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_kodama_c&w.png")   {template_purchase(0, 0)}
alternative_sprites(ss_100_series_buy_kodama_jrw,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/purchase_kodama_jrw.png")   {template_purchase(0, 0)}


switch(FEAT_TRAINS, SELF, sw_100_series_year_dep_purchase, current_year) {
    0..1986: ss_100_series_buy_original_jnr;        // JNR (Original Livery)
    1987..1988: ss_100_series_buy_original_jrc;     // JR Central (Original Livery)
    1989..1999: ss_100_series_buy_original_c_w;     // JR Central & West (Original Livery)
    2000..2001: ss_100_series_buy_kodama_c_w;       // JR Central & West (Kodama Livery)
    ss_100_series_buy_kodama_jrw;                   // JR West (Kodama Livery)
}

switch(FEAT_TRAINS, SELF, sw_100_series_year_dep_subtype_text, current_year) {
    0..1987: sw_100_series_1985_subtype_text;
    1988..1999: sw_100_series_1988_subtype_text;
    2000..2001: sw_100_series_2000_subtype_text;
    sw_100_series_2002_subtype_text;
}

/* EMU Parts */

/* "CAB" */

spriteset(ss_100_series_cab_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_cab_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_cab_kodama_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_cab_rev_kodama_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_100_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,1)}
alternative_sprites(ss_100_series_cab_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,41)}		

// 200 Series Kodama Strip Livery
alternative_sprites(ss_100_series_cab_kodama_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_standard(1,1)}
alternative_sprites(ss_100_series_cab_rev_kodama_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_reversed(1,41)}	

// Livery Selection
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_year_dep_livery, build_year) {
    0..1999: ss_100_series_cab_original_livery;
    2000..9999: ss_100_series_cab_kodama_livery;
    ss_100_series_cab_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev_year_dep_livery, build_year) {
    0..1999: ss_100_series_cab_rev_original_livery;
    2000..9999: ss_100_series_cab_rev_kodama_livery;
    ss_100_series_cab_rev_original_livery;
}

// 1985 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_1985_livery, cargo_subtype) {
    1: ss_100_series_cab_original_livery;       // Original
    sw_100_series_cab_year_dep_livery;          // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev_1985_livery, cargo_subtype) {
    1: ss_100_series_cab_rev_original_livery;   // Original
    sw_100_series_cab_rev_year_dep_livery;      // Year-dependent Livery
}

// 1988 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_1988_livery, cargo_subtype) {
    1: ss_100_series_cab_original_livery;       // Original
    2: ss_100_series_cab_original_livery;       // Original 
    sw_100_series_cab_year_dep_livery;          // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev_1988_livery, cargo_subtype) {
    1: ss_100_series_cab_rev_original_livery;   // Original
    2: ss_100_series_cab_rev_original_livery;   // Original 
    sw_100_series_cab_rev_year_dep_livery;      // Year-dependent Livery
}

// 2000 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_2000_livery, cargo_subtype) {
    1: ss_100_series_cab_original_livery;       // Original
    2: ss_100_series_cab_original_livery;       // Original
    3: ss_100_series_cab_kodama_livery;         // Kodama
    sw_100_series_cab_year_dep_livery;          // Year-dependent Livery
}
switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev_2000_livery, cargo_subtype) {
    1: ss_100_series_cab_rev_original_livery;   // Original
    2: ss_100_series_cab_rev_original_livery;   // Original
    3: ss_100_series_cab_rev_kodama_livery;     // Kodama
    sw_100_series_cab_rev_year_dep_livery;      // Year-dependent Livery
}

// 2002 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_cab_2002_livery, cargo_subtype) {
    1: ss_100_series_cab_original_livery;       // Original
    2: ss_100_series_cab_original_livery;       // Original
    3: ss_100_series_cab_kodama_livery;         // Kodama
    4: ss_100_series_cab_kodama_livery;         // Kodama
    sw_100_series_cab_year_dep_livery;          // Year-dependent Livery
}
switch(FEAT_TRAINS, SELF, sw_100_series_cab_rev_2002_livery, cargo_subtype) {
    1: ss_100_series_cab_rev_original_livery;   // Original
    2: ss_100_series_cab_rev_original_livery;   // Original
    3: ss_100_series_cab_rev_kodama_livery;     // Kodama
    4: ss_100_series_cab_rev_kodama_livery;     // Kodama
    sw_100_series_cab_rev_year_dep_livery;      // Year-dependent Livery
}

// Choose the Cab Livery for the current year
switch(FEAT_TRAINS, SELF, ss_100_series_cab, current_year) {
    0..1987: sw_100_series_cab_1985_livery;
    1988..1999: sw_100_series_cab_1988_livery;
    2000..2001: sw_100_series_cab_2000_livery;
    sw_100_series_cab_2002_livery;
}
switch(FEAT_TRAINS, SELF, ss_100_series_cab_rev, current_year) {
    0..1987: sw_100_series_cab_rev_1985_livery;
    1988..1999: sw_100_series_cab_rev_1988_livery;
    2000..2001: sw_100_series_cab_rev_2000_livery;
    sw_100_series_cab_rev_2002_livery;
}

/* "COACH" */

spriteset(ss_100_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_coach_kodama_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_coach_rev_kodama_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_100_series_coach_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_100_series_coach_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,121)}		

// 200 Series Kodama Strip Livery
alternative_sprites(ss_100_series_coach_kodama_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_standard(1,121)}
alternative_sprites(ss_100_series_coach_rev_kodama_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_reversed(1,121)}	

// Livery Selection
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_year_dep_livery, build_year) {
    0..1999: ss_100_series_coach_original_livery;
    2000..9999: ss_100_series_coach_kodama_livery;
    ss_100_series_coach_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev_year_dep_livery, build_year) {
    0..1999: ss_100_series_coach_rev_original_livery;
    2000..9999: ss_100_series_coach_rev_kodama_livery;
    ss_100_series_coach_rev_original_livery;
}

// 1985 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_1985_livery, cargo_subtype) {
    1: ss_100_series_coach_original_livery;       // Original
    sw_100_series_coach_year_dep_livery;          // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev_1985_livery, cargo_subtype) {
    1: ss_100_series_coach_rev_original_livery;   // Original
    sw_100_series_coach_rev_year_dep_livery;      // Year-dependent Livery
}

// 1988 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_1988_livery, cargo_subtype) {
    1: ss_100_series_coach_original_livery;       // Original
    2: ss_100_series_coach_original_livery;       // Original 
    sw_100_series_coach_year_dep_livery;          // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev_1988_livery, cargo_subtype) {
    1: ss_100_series_coach_rev_original_livery;   // Original
    2: ss_100_series_coach_rev_original_livery;   // Original 
    sw_100_series_coach_rev_year_dep_livery;      // Year-dependent Livery
}

// 2000 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_2000_livery, cargo_subtype) {
    1: ss_100_series_coach_original_livery;       // Original
    2: ss_100_series_coach_original_livery;       // Original
    3: ss_100_series_coach_kodama_livery;         // Kodama
    sw_100_series_coach_year_dep_livery;          // Year-dependent Livery
}
switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev_2000_livery, cargo_subtype) {
    1: ss_100_series_coach_rev_original_livery;   // Original
    2: ss_100_series_coach_rev_original_livery;   // Original
    3: ss_100_series_coach_rev_kodama_livery;     // Kodama
    sw_100_series_coach_rev_year_dep_livery;      // Year-dependent Livery
}

// 2002 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_coach_2002_livery, cargo_subtype) {
    1: ss_100_series_coach_original_livery;       // Original
    2: ss_100_series_coach_original_livery;       // Original
    3: ss_100_series_coach_kodama_livery;         // Kodama
    4: ss_100_series_coach_kodama_livery;         // Kodama
    sw_100_series_coach_year_dep_livery;          // Year-dependent Livery
}
switch(FEAT_TRAINS, SELF, sw_100_series_coach_rev_2002_livery, cargo_subtype) {
    1: ss_100_series_coach_rev_original_livery;   // Original
    2: ss_100_series_coach_rev_original_livery;   // Original
    3: ss_100_series_coach_rev_kodama_livery;     // Kodama
    4: ss_100_series_coach_rev_kodama_livery;     // Kodama
    sw_100_series_coach_rev_year_dep_livery;      // Year-dependent Livery
}

// Choose the coach Livery for the current year
switch(FEAT_TRAINS, SELF, ss_100_series_coach, current_year) {
    0..1987: sw_100_series_coach_1985_livery;
    1988..1999: sw_100_series_coach_1988_livery;
    2000..2001: sw_100_series_coach_2000_livery;
    sw_100_series_coach_2002_livery;
}
switch(FEAT_TRAINS, SELF, ss_100_series_coach_rev, current_year) {
    0..1987: sw_100_series_coach_rev_1985_livery;
    1988..1999: sw_100_series_coach_rev_1988_livery;
    2000..2001: sw_100_series_coach_rev_2000_livery;
    sw_100_series_coach_rev_2002_livery;
}

/* "PANTO" */

spriteset(ss_100_series_panto_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_panto_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_panto_kodama_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_panto_rev_kodama_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_100_series_panto_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_100_series_panto_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,81)}		

// 200 Series Kodama Strip Livery
alternative_sprites(ss_100_series_panto_kodama_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_standard(1,81)}
alternative_sprites(ss_100_series_panto_rev_kodama_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/kodama.png") {template_12_reversed(1,81)}	

// Livery Selection
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_year_dep_livery, build_year) {
    0..1999: ss_100_series_panto_original_livery;
    2000..9999: ss_100_series_panto_kodama_livery;
    ss_100_series_panto_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev_year_dep_livery, build_year) {
    0..1999: ss_100_series_panto_rev_original_livery;
    2000..9999: ss_100_series_panto_rev_kodama_livery;
    ss_100_series_panto_rev_original_livery;
}

// 1985 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_1985_livery, cargo_subtype) {
    1: ss_100_series_panto_original_livery;       // Original
    sw_100_series_panto_year_dep_livery;          // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev_1985_livery, cargo_subtype) {
    1: ss_100_series_panto_rev_original_livery;   // Original
    sw_100_series_panto_rev_year_dep_livery;      // Year-dependent Livery
}

// 1988 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_1988_livery, cargo_subtype) {
    1: ss_100_series_panto_original_livery;       // Original
    2: ss_100_series_panto_original_livery;       // Original 
    sw_100_series_panto_year_dep_livery;          // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev_1988_livery, cargo_subtype) {
    1: ss_100_series_panto_rev_original_livery;   // Original
    2: ss_100_series_panto_rev_original_livery;   // Original 
    sw_100_series_panto_rev_year_dep_livery;      // Year-dependent Livery
}

// 2000 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_2000_livery, cargo_subtype) {
    1: ss_100_series_panto_original_livery;       // Original
    2: ss_100_series_panto_original_livery;       // Original
    3: ss_100_series_panto_kodama_livery;         // Kodama
    sw_100_series_panto_year_dep_livery;          // Year-dependent Livery
}
switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev_2000_livery, cargo_subtype) {
    1: ss_100_series_panto_rev_original_livery;   // Original
    2: ss_100_series_panto_rev_original_livery;   // Original
    3: ss_100_series_panto_rev_kodama_livery;     // Kodama
    sw_100_series_panto_rev_year_dep_livery;      // Year-dependent Livery
}

// 2002 Livery
switch(FEAT_TRAINS, SELF, sw_100_series_panto_2002_livery, cargo_subtype) {
    1: ss_100_series_panto_original_livery;       // Original
    2: ss_100_series_panto_original_livery;       // Original
    3: ss_100_series_panto_kodama_livery;         // Kodama
    4: ss_100_series_panto_kodama_livery;         // Kodama
    sw_100_series_panto_year_dep_livery;          // Year-dependent Livery
}
switch(FEAT_TRAINS, SELF, sw_100_series_panto_rev_2002_livery, cargo_subtype) {
    1: ss_100_series_panto_rev_original_livery;   // Original
    2: ss_100_series_panto_rev_original_livery;   // Original
    3: ss_100_series_panto_rev_kodama_livery;     // Kodama
    4: ss_100_series_panto_rev_kodama_livery;     // Kodama
    sw_100_series_panto_rev_year_dep_livery;      // Year-dependent Livery
}

// Choose the panto Livery for the current year
switch(FEAT_TRAINS, SELF, ss_100_series_panto, current_year) {
    0..1987: sw_100_series_panto_1985_livery;
    1988..1999: sw_100_series_panto_1988_livery;
    2000..2001: sw_100_series_panto_2000_livery;
    sw_100_series_panto_2002_livery;
}
switch(FEAT_TRAINS, SELF, ss_100_series_panto_rev, current_year) {
    0..1987: sw_100_series_panto_rev_1985_livery;
    1988..1999: sw_100_series_panto_rev_1988_livery;
    2000..2001: sw_100_series_panto_rev_2000_livery;
    sw_100_series_panto_rev_2002_livery;
}

/* "DOUBLE DECKER" */

spriteset(ss_100_series_2deck,             	                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_2deck_rev,    		                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_2dec2,             	                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_100_series_2dec2_rev,    		                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 100 Series Original Livery
alternative_sprites(ss_100_series_2deck,                        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,161)}
alternative_sprites(ss_100_series_2deck_rev,                    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,161)}	
alternative_sprites(ss_100_series_2dec2,                        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_standard(1,201)}
alternative_sprites(ss_100_series_2dec2_rev,                    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/100_series/original.png") {template_12_reversed(1,201)}

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_100_series_coach;
	ss_100_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_100_series_panto;
	ss_100_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_B_D, vehicle_is_reversed) {
	0: ss_100_series_2dec2;
	ss_100_series_2deck_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_D_B, vehicle_is_reversed) {
	0: ss_100_series_2deck;
	ss_100_series_2dec2_rev;
}

switch (FEAT_TRAINS, PARENT, sw_100_series_reverser_D_D, vehicle_is_reversed) {
	0: ss_100_series_2deck;
	ss_100_series_2deck_rev;
}

/* LENGTH*/

// Make the Middle long sprite length 8 and the dummy sprites length 2
switch (FEAT_TRAINS, SELF, sw_100_series_length_standard, position_in_consist%3) {
    1: return 8;
    return 2;
}

// Make a 6 car set by adjusting sprite sizes
switch(FEAT_TRAINS, SELF, sw_100_series_shorten_6_car_vehicle, position_in_consist%8) {
    2: return 5;
    return 1;
}

switch(FEAT_TRAINS, SELF, ss_100_series_year_dep_length, current_year) {
    0..1999: sw_100_series_length_standard;
    return 1;
}

switch(FEAT_TRAINS, SELF, sw_100_series_length, cargo_subtype) {
    0: ss_100_series_year_dep_length;           // Year Dependent length
    3: return 1;                                // 4-car 
    4: sw_100_series_shorten_6_car_vehicle;     // 6-car
    sw_100_series_length_standard;              // All other 16-length sets
}


/* PUT TOGETHER THE EMU*/

/* 16-car sets */
switch (FEAT_TRAINS, SELF, sw_100_series_graphics_16car_x, position_in_articulated_veh) {
                                        // 16-car   
    1:  ss_100_series_cab; 	            // Car 1    Car 16  	
	4:  sw_100_series_reverser_P_C;	    // Car 2    Car 15     	
	7:  sw_100_series_reverser_C_P;     // Car 3    Car 14   
	10: sw_100_series_reverser_P_C;     // Car 4    Car 13  
    13: sw_100_series_reverser_C_P;     // Car 5    Car 12  
    16: sw_100_series_reverser_P_C;     // Car 6    Car 11  
    19: sw_100_series_reverser_C_P;     // Car 7    Car 10   
	22: sw_100_series_reverser_D_B;     // Car 8    Car 9  
    25: sw_100_series_reverser_B_D;     // Car 9    Car 8    
    28: sw_100_series_reverser_P_C;     // Car 10   Car 7 
    31: sw_100_series_reverser_C_P;     // Car 11   Car 6  
    34: sw_100_series_reverser_P_C;     // Car 12   Car 5
    37: sw_100_series_reverser_C_P;     // Car 13   Car 4  
    40: sw_100_series_reverser_P_C;     // Car 14   Car 3   
    43: sw_100_series_reverser_C_P;     // Car 15   Car 2  
    46: ss_100_series_cab_rev;          // Car 16   Car 1  
	dummy_sprites;
}

switch (FEAT_TRAINS, SELF, sw_100_series_graphics_16car_v, position_in_articulated_veh) {
                                        // 16-car   
    1:  ss_100_series_cab; 	            // Car 1    Car 16  	
	4:  sw_100_series_reverser_P_C;	    // Car 2    Car 15     	
	7:  sw_100_series_reverser_C_P;     // Car 3    Car 14   
	10: sw_100_series_reverser_P_C;     // Car 4    Car 13  
    13: sw_100_series_reverser_C_P;     // Car 5    Car 12  
    16: sw_100_series_reverser_P_C;     // Car 6    Car 11  
    19: sw_100_series_reverser_D_D;     // Car 7    Car 10   
	22: sw_100_series_reverser_D_B;     // Car 8    Car 9  
    25: sw_100_series_reverser_B_D;     // Car 9    Car 8    
    28: sw_100_series_reverser_D_D;     // Car 10   Car 7 
    31: sw_100_series_reverser_C_P;     // Car 11   Car 6  
    34: sw_100_series_reverser_P_C;     // Car 12   Car 5
    37: sw_100_series_reverser_C_P;     // Car 13   Car 4  
    40: sw_100_series_reverser_P_C;     // Car 14   Car 3   
    43: sw_100_series_reverser_C_P;     // Car 15   Car 2  
    46: ss_100_series_cab_rev;          // Car 16   Car 1  
	dummy_sprites;
}

// For 6-car set
switch (FEAT_TRAINS, SELF, sw_100_series_graphics_6car, position_in_articulated_veh) {
                                        // 6-car
    2:  ss_100_series_cab; 	 	        // Car 1    Car 6	
	10: sw_100_series_reverser_P_C;     // Car 2    Car 5
    18: sw_100_series_reverser_C_P;     // Car 3    Car 4
    26: sw_100_series_reverser_P_C;     // Car 4    Car 3
    34: sw_100_series_reverser_C_P;     // Car 5    Car 2
    42: ss_100_series_cab_rev;          // Car 6    Car 1
	dummy_sprites;
}

// For 4-car set
switch (FEAT_TRAINS, SELF, sw_100_series_graphics_4car, position_in_articulated_veh) {
                                        // 4-car
    2:  ss_100_series_cab; 	 	        // Car 1    Car 4	
	14: sw_100_series_reverser_P_C;     // Car 2    Car 3
    26: sw_100_series_reverser_C_P;     // Car 3    Car 2
    38: ss_100_series_cab_rev;          // Car 4    Car 1
	dummy_sprites;
}

/* Choose which Graphics based on which Cargo Subtype */

switch(FEAT_TRAINS, SELF, sw_100_series_graphics_year_dep, current_year) {
    0..1987: sw_100_series_graphics_16car_x;
    1988..1999: sw_100_series_graphics_16car_v;
    sw_100_series_graphics_4car;
}


switch(FEAT_TRAINS, SELF, sw_100_series_graphics, cargo_subtype) {
    1: sw_100_series_graphics_16car_x;
    2: sw_100_series_graphics_16car_v;
    3: sw_100_series_graphics_4car;
    4: sw_100_series_graphics_6car;
    sw_100_series_graphics_year_dep;
}

/* Assemble an 48 part articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_100_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_100;										
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
 
switch (FEAT_TRAINS, SELF, sw_100_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_100_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
    0: return 52;       // Low Capacity
    2: return 78;       // High Capacity
    3: return 91;       // Very High Capacity
    return 65;          // Normal Capacity 
}

// Scaling factor for each length of consist
switch(FEAT_TRAINS, SELF, sw_100_series_cargo_capacity_factor, cargo_subtype) {
    3: return 1250;     // Length 4 (3 tiles)
    4: return 1875;     // Length 6 (4.5 tiles)
    return 5000;        // Length 16 (12 tiles)
}

switch(FEAT_TRAINS, SELF, sw_100_series_cargo_capacity, (sw_100_series_param_cargo_capacity() * sw_100_series_cargo_capacity_factor() ) / 10000 )
    {return;}

// Running Costs

switch(FEAT_TRAINS, SELF, sw_100_series_running_costs, cargo_subtype) {
    3: return 113;
    4: return 75;
    return 300;
}

// Weight

switch(FEAT_TRAINS, SELF, sw_100_series_weight, cargo_subtype) {
    3: return 318;      // Weight of a 3.0 tile long JapanSet 100 Series
    4: return 477;      // Weight of a 4.5 tile long JapanSet 100 Series
    return 1272;        // Weight of a 12.0 tile long JapanSet 100 Series
}

// Power

switch(FEAT_TRAINS, SELF, sw_100_series_power, cargo_subtype) {
    3: return 5962;
    4: return 8943;
    return 23847;    
}

// Speed

switch(FEAT_TRAINS, SELF, sw_100_series_speed, cargo_subtype) {
    1..2: return 220;   // Original speed
    return 230;         // Kodama speed
}

item(FEAT_TRAINS, series_100) {
	property {
		name: 							string(STR_NAME_100_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1985,10,01);           // Date of launch
		model_life:                     34;		                    // 
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          210 km/h;                   // Changed by callback
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_100_series_graphics;
		purchase:                       sw_100_series_year_dep_purchase;
		articulated_part:               sw_100_series_articulated_part;
		length:                         sw_100_series_length;
        weight:                         sw_100_series_weight;
        power:                          sw_100_series_power;
        speed:							sw_100_series_speed;
		cargo_capacity:                 sw_100_series_cargo_capacity;
		//colour_mapping:                 sw_cc_blue_white;s
		cargo_subtype_text:             sw_100_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            sw_100_series_running_costs;              // Varies depending on length
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_100_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_100_SERIES);
	}
}

/* End 100 Series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/800_series_fixed.pnml" 1
/* Begin 800 Series */

/* CARGO SUBTYPE MENU*/

    // None (for now)

/* SPRITES */

    // Purchase Menu
    spriteset (ss_800_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_800_series_buy,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_800_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_800_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_800_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_800_series_cab_rev,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_800_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_800_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_800_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_800_series_coach_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_800_series_panto,          		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_800_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_800_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_800_series_panto_rev,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/800_series/800_series.png") {template_12_reversed(1,81)}	

/* REVERSERS */

    switch (FEAT_TRAINS, PARENT, sw_800_series_reverser_P_P, vehicle_is_reversed) {
	    0: ss_800_series_panto;
	    ss_800_series_panto_rev;
    }

    switch (FEAT_TRAINS, PARENT, sw_800_series_reverser_C_C, vehicle_is_reversed) {
	    0: ss_800_series_coach;
	    ss_800_series_coach_rev;
    }

/* LENGTH*/

    // Make the Middle long sprite length 8 and the dummy sprites length 2
    switch (FEAT_TRAINS, SELF, sw_800_series_length, position_in_consist%3) {
        1: return 8;
        return 2;
    }

/* PUT TOGETHER THE EMU*/

    // 6 Car Set
    switch (FEAT_TRAINS, SELF, sw_800_series_graphics, position_in_articulated_veh) {					
	    1:  ss_800_series_cab; 	            // Car 1	Car 6								
	    4:  sw_800_series_reverser_P_P;	    // Car 2	Car 5	    						
	    7:  sw_800_series_reverser_C_C;     // Car 3    Car 4
	    10: sw_800_series_reverser_C_C;     // Car 4    Car 3
        13: sw_800_series_reverser_P_P;     // Car 5    Car 2
        16: ss_800_series_cab_rev;          // Car 6    Car 1
	    dummy_sprites;
    }

    /* Assemble an articulated vehicle. */
    switch (FEAT_TRAINS, SELF, sw_800_series_articulated_part, extra_callback_info1) {
	    1 .. 17: return series_800;										// Should be same as range above
	    return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
    }

    switch (FEAT_TRAINS, SELF, sw_800_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	    1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	    return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
    }

/* CARGO CAPACITY */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_800_series_param_cargo_capacity, param_basecapacity) {
        // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
        0: return 52;       // Low Capacity
        2: return 78;       // High Capacity
        3: return 92;       // Very High Capacity
        return 66;          // Normal Capacity 
    }

    switch(FEAT_TRAINS, SELF, sw_800_series_cargo_capacity, (sw_800_series_param_cargo_capacity()  / 2 ) ){return;}     // Half since n * 1.5 (long)/ 3 (3 parts per car)

item(FEAT_TRAINS, series_800) {
	property {
		name: 							string(STR_NAME_800_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2004,03,13);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          261 km/h;				
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          14500 kW;					
		weight:                         396 tons;					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_800_series_graphics;
		purchase:                       ss_800_series_buy;
		articulated_part:               sw_800_series_articulated_part;
		length:                         sw_800_series_length;
        //power:                          sw_800_series_power;
        //weight:                         sw_800_series_weight;
		cargo_capacity:                 sw_800_series_cargo_capacity;
		//cargo_subtype_text:             sw_800_series_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_800_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_800_SERIES);
	}
}

/* End 800 series */
# 1 "JPplusShinkansen.pnml" 4

/*---JR EAST TRAINS---*/
# 1 "src/trains/200_series_fixed.pnml" 1
/* Begin 200 Series */

/* CARGO SUBTYPE MENU*/

// From 1982 to 1987
switch(FEAT_TRAINS, SELF, sw_200_series_1982_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
       return CB_RESULT_NO_TEXT;
    }

// From 1987 to 1990 - introduction of 10-car and 8-car sets
switch(FEAT_TRAINS, SELF, sw_200_series_1987_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
    2: return string(LV_200_SERIES_10CAR);              // Original 10-car
    3: return string(LV_200_SERIES_08CAR);              // Original 8-car
       return CB_RESULT_NO_TEXT;
    }

// From 1990 to 1992 - introduction of Sharknose sets
switch(FEAT_TRAINS, SELF, sw_200_series_1990_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
    2: return string(LV_200_SERIES_10CAR);              // Original 10-car
    3: return string(LV_200_SERIES_08CAR);              // Original 8-car
    4: return string(LV_200_SERIES_SHARK12);            // Sharknose 12-car
    5: return string(LV_200_SERIES_SHARK16);            // Sharknose 16-car
       return CB_RESULT_NO_TEXT;
    }

// From 1992 onwards - introduction of Refurbished Livery
switch(FEAT_TRAINS, SELF, sw_200_series_1992_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_200_SERIES_ORIGINAL);           // Original 12-car
    2: return string(LV_200_SERIES_10CAR);              // Original 10-car
    3: return string(LV_200_SERIES_08CAR);              // Original 8-car
    4: return string(LV_200_SERIES_SHARK12);            // Sharknose 12-car         
    5: return string(LV_200_SERIES_SHARK16);            // Sharknose 16-car
    6: return string(LV_200_SERIES_REFURB10);           // Refurbished 10-car
    7: return string(LV_200_SERIES_REFURB08);           // Refurbished 8-car
       return CB_RESULT_NO_TEXT;
    }

/* SPRITES */

/* Purchase Menu */
spriteset (ss_200_series_buy_original_jnr,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_200_series_buy_original_jre,	        	    "src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_200_series_buy_sharknose_livery,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

alternative_sprites(ss_200_series_buy_original_jnr,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/purchase_original_jnr.png") {template_purchase(0, 0)}
alternative_sprites(ss_200_series_buy_original_jre,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/purchase_original_jre.png") {template_purchase(0, 0)}
alternative_sprites(ss_200_series_buy_sharknose_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/purchase_sharknose.png") {template_purchase(0, 0)}

switch(FEAT_TRAINS, SELF, sw_200_series_year_dep_purchase, current_year) {
    0..1986: ss_200_series_buy_original_jnr;        // JNR
    1987..1990: ss_200_series_buy_original_jre;     // JR East
    ss_200_series_buy_sharknose_livery;             // UPDATE!!!
}

switch(FEAT_TRAINS, SELF, sw_200_series_year_dep_subtype_text, current_year) {
    0..1986: sw_200_series_1982_subtype_text;
    1987..1989: sw_200_series_1987_subtype_text;
    1990..1991: sw_200_series_1990_subtype_text;
    sw_200_series_1992_subtype_text;
}

/* EMU Parts */

/* "CAB" */

spriteset(ss_200_series_cab_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_sharknose_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_rev_sharknose_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_refurb_livery,             		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_cab_rev_refurb_livery,    		        "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_200_series_cab_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,1)}
alternative_sprites(ss_200_series_cab_rev_original_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,41)}		

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_cab_sharknose_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_standard(1,1)}
alternative_sprites(ss_200_series_cab_rev_sharknose_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_reversed(1,41)}	

// 200 Series Refurbished Livery
alternative_sprites(ss_200_series_cab_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_standard(1,1)}
alternative_sprites(ss_200_series_cab_rev_refurb_livery,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_reversed(1,41)}

// Livery Selection
switch(FEAT_TRAINS, SELF, sw_200_series_cab_year_dep_livery, build_year) {
    0..1986: ss_200_series_cab_original_livery;
    1987..9999: ss_200_series_cab_sharknose_livery;
    ss_200_series_cab_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_200_series_cab_1982_livery, cargo_subtype) {
    1: ss_200_series_cab_original_livery;      // Original 12-car
    sw_200_series_cab_year_dep_livery;         // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_200_series_cab_1987_livery, cargo_subtype) {
    1: ss_200_series_cab_original_livery;      // Original 12-car
    2: ss_200_series_cab_original_livery;      // Original 10-car
    3: ss_200_series_cab_original_livery;      // Original 8-car
    sw_200_series_cab_year_dep_livery;         // Year-dependent Livery
}

switch(FEAT_TRAINS, SELF, sw_200_series_cab_1990_livery, cargo_subtype) {
    1: ss_200_series_cab_original_livery;      // Original 12-car
    2: ss_200_series_cab_original_livery;      // Original 10-car
    3: ss_200_series_cab_original_livery;      // Original 8-car
    4: ss_200_series_cab_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_cab_sharknose_livery;     // Sharknose 16-car
    sw_200_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_200_series_cab_1992_livery, cargo_subtype) {
    1: ss_200_series_cab_original_livery;      // Original 12-car
    2: ss_200_series_cab_original_livery;      // Original 10-car
    3: ss_200_series_cab_original_livery;      // Original 8-car
    4: ss_200_series_cab_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_cab_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_cab_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_cab_refurb_livery;        // Refurbished 8-car
    sw_200_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_200_series_cab, current_year) {
    0..1986: sw_200_series_cab_1982_livery;
    1987..1989: sw_200_series_cab_1987_livery;
    1990..1991: sw_200_series_cab_1990_livery;
    sw_200_series_cab_1992_livery;
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev_year_dep_livery, build_year) {
    0..1986: ss_200_series_cab_rev_original_livery;
    1987..9999: ss_200_series_cab_rev_sharknose_livery;
    ss_200_series_cab_rev_original_livery;
}
// 1982 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev_1982_livery, cargo_subtype) {
    1: ss_200_series_cab_rev_original_livery;      // Original 12-car
    sw_200_series_cab_rev_year_dep_livery;         // Year-dependent Livery
}
// 1987 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev_1987_livery, cargo_subtype) {
    1: ss_200_series_cab_rev_original_livery;      // Original 12-car
    2: ss_200_series_cab_rev_original_livery;      // Original 10-car
    3: ss_200_series_cab_rev_original_livery;      // Original 8-car
    sw_200_series_cab_rev_year_dep_livery;         // Year-dependent Livery
}
// 1990 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev_1990_livery, cargo_subtype) {
    1: ss_200_series_cab_rev_original_livery;      // Original 12-car
    2: ss_200_series_cab_rev_original_livery;      // Original 10-car
    3: ss_200_series_cab_rev_original_livery;      // Original 8-car
    4: ss_200_series_cab_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_cab_rev_sharknose_livery;     // Sharknose 16-car
    sw_200_series_cab_rev_year_dep_livery;
}
// 1992 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_cab_rev_1992_livery, cargo_subtype) {
    1: ss_200_series_cab_rev_original_livery;      // Original 12-car
    2: ss_200_series_cab_rev_original_livery;      // Original 10-car
    3: ss_200_series_cab_rev_original_livery;      // Original 8-car
    4: ss_200_series_cab_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_cab_rev_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_cab_rev_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_cab_rev_refurb_livery;        // Refurbished 8-car
    sw_200_series_cab_rev_year_dep_livery;
}
// Choose the relevant menu for the current year
switch(FEAT_TRAINS, SELF, ss_200_series_cab_rev, current_year) {
    0..1986: sw_200_series_cab_rev_1982_livery;
    1987..1989: sw_200_series_cab_rev_1987_livery;
    1990..1991: sw_200_series_cab_rev_1990_livery;
    sw_200_series_cab_rev_1992_livery;
}

/* "COACH" */

spriteset(ss_200_series_coach_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_sharknose_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_rev_sharknose_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_refurb_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_coach_rev_refurb_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_200_series_coach_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_200_series_coach_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,121)}		

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_coach_sharknose_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,121)}
alternative_sprites(ss_200_series_coach_rev_sharknose_livery,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,121)}	

// 200 Series Refurbished Livery
alternative_sprites(ss_200_series_coach_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_standard(1,121)}
alternative_sprites(ss_200_series_coach_rev_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_reversed(1,121)}

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_coach_year_dep_livery, build_year) {
    0..1986: ss_200_series_coach_original_livery;
    1987..9999: ss_200_series_coach_sharknose_livery;
    ss_200_series_coach_original_livery;
}
// 1982 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_1982_livery, cargo_subtype) {
    1: ss_200_series_coach_original_livery;      // Original 12-car
    sw_200_series_coach_year_dep_livery;         // Year-dependent Livery
}
// 1987 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_1987_livery, cargo_subtype) {
    1: ss_200_series_coach_original_livery;      // Original 12-car
    2: ss_200_series_coach_original_livery;      // Original 10-car
    3: ss_200_series_coach_original_livery;      // Original 8-car
    sw_200_series_coach_year_dep_livery;         // Year-dependent Livery
}
// 1990 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_1990_livery, cargo_subtype) {
    1: ss_200_series_coach_original_livery;      // Original 12-car
    2: ss_200_series_coach_original_livery;      // Original 10-car
    3: ss_200_series_coach_original_livery;      // Original 8-car
    4: ss_200_series_coach_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_coach_sharknose_livery;     // Sharknose 16-car
    sw_200_series_coach_year_dep_livery;
}
// 1992 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_1992_livery, cargo_subtype) {
    1: ss_200_series_coach_original_livery;      // Original 12-car
    2: ss_200_series_coach_original_livery;      // Original 10-car
    3: ss_200_series_coach_original_livery;      // Original 8-car
    4: ss_200_series_coach_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_coach_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_coach_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_coach_refurb_livery;        // Refurbished 8-car
    sw_200_series_coach_year_dep_livery;
}
// Choose the relevant menu for the current year
switch(FEAT_TRAINS, SELF, ss_200_series_coach, current_year) {
    0..1986: sw_200_series_coach_1982_livery;
    1987..1989: sw_200_series_coach_1987_livery;
    1990..1991: sw_200_series_coach_1990_livery;
    sw_200_series_coach_1992_livery;
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev_year_dep_livery, build_year) {
    0..1986: ss_200_series_coach_rev_original_livery;
    1987..9999: ss_200_series_coach_rev_sharknose_livery;
    ss_200_series_coach_rev_original_livery;
}
// 1982 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev_1982_livery, cargo_subtype) {
    1: ss_200_series_coach_rev_original_livery;      // Original 12-car
    sw_200_series_coach_rev_year_dep_livery;         // Year-dependent Livery
}
// 1987 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev_1987_livery, cargo_subtype) {
    1: ss_200_series_coach_rev_original_livery;      // Original 12-car
    2: ss_200_series_coach_rev_original_livery;      // Original 10-car
    3: ss_200_series_coach_rev_original_livery;      // Original 8-car
    sw_200_series_coach_rev_year_dep_livery;         // Year-dependent Livery
}
// 1990 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev_1990_livery, cargo_subtype) {
    1: ss_200_series_coach_rev_original_livery;      // Original 12-car
    2: ss_200_series_coach_rev_original_livery;      // Original 10-car
    3: ss_200_series_coach_rev_original_livery;      // Original 8-car
    4: ss_200_series_coach_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_coach_rev_sharknose_livery;     // Sharknose 16-car
    sw_200_series_coach_rev_year_dep_livery;
}
// 1992 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_coach_rev_1992_livery, cargo_subtype) {
    1: ss_200_series_coach_rev_original_livery;      // Original 12-car
    2: ss_200_series_coach_rev_original_livery;      // Original 10-car
    3: ss_200_series_coach_rev_original_livery;      // Original 8-car
    4: ss_200_series_coach_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_coach_rev_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_coach_rev_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_coach_rev_refurb_livery;        // Refurbished 8-car
    sw_200_series_coach_rev_year_dep_livery;
}
// Choose the relevant menu for the current year
switch(FEAT_TRAINS, SELF, ss_200_series_coach_rev, current_year) {
    0..1986: sw_200_series_coach_rev_1982_livery;
    1987..1989: sw_200_series_coach_rev_1987_livery;
    1990..1991: sw_200_series_coach_rev_1990_livery;
    sw_200_series_coach_rev_1992_livery;
}

/* "PANTO" */

spriteset(ss_200_series_panto_original_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_rev_original_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_sharknose_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_rev_sharknose_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_refurb_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_panto_rev_refurb_livery,    		    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Original Strip Livery
alternative_sprites(ss_200_series_panto_original_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_panto_rev_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,81)}		

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_panto_sharknose_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_panto_rev_sharknose_livery,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/original.png") {template_12_reversed(1,81)}	

// 200 Series Refurbished Livery
alternative_sprites(ss_200_series_panto_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_panto_rev_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/refurb.png") {template_12_reversed(1,81)}

// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_panto_year_dep_livery, build_year) {
    0..1986: ss_200_series_panto_original_livery;
    1987..9999: ss_200_series_panto_sharknose_livery;
    ss_200_series_panto_original_livery;
}
// 1982 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_1982_livery, cargo_subtype) {
    1: ss_200_series_panto_original_livery;      // Original 12-car
    sw_200_series_panto_year_dep_livery;         // Year-dependent Livery
}
// 1987 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_1987_livery, cargo_subtype) {
    1: ss_200_series_panto_original_livery;      // Original 12-car
    2: ss_200_series_panto_original_livery;      // Original 10-car
    3: ss_200_series_panto_original_livery;      // Original 8-car
    sw_200_series_panto_year_dep_livery;         // Year-dependent Livery
}
// 1990 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_1990_livery, cargo_subtype) {
    1: ss_200_series_panto_original_livery;      // Original 12-car
    2: ss_200_series_panto_original_livery;      // Original 10-car
    3: ss_200_series_panto_original_livery;      // Original 8-car
    4: ss_200_series_panto_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_panto_sharknose_livery;     // Sharknose 16-car
    sw_200_series_panto_year_dep_livery;
}
// 1992 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_1992_livery, cargo_subtype) {
    1: ss_200_series_panto_original_livery;      // Original 12-car
    2: ss_200_series_panto_original_livery;      // Original 10-car
    3: ss_200_series_panto_original_livery;      // Original 8-car
    4: ss_200_series_panto_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_panto_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_panto_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_panto_refurb_livery;        // Refurbished 8-car
    sw_200_series_panto_year_dep_livery;
}
// Choose the relevant menu for the current year
switch(FEAT_TRAINS, SELF, ss_200_series_panto, current_year) {
    0..1986: sw_200_series_panto_1982_livery;
    1987..1989: sw_200_series_panto_1987_livery;
    1990..1991: sw_200_series_panto_1990_livery;
    sw_200_series_panto_1992_livery;
}

// Reversed
// Year Dependent Livery
switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev_year_dep_livery, build_year) {
    0..1986: ss_200_series_panto_rev_original_livery;
    1987..9999: ss_200_series_panto_rev_sharknose_livery;
    ss_200_series_panto_rev_original_livery;
}
// 1982 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev_1982_livery, cargo_subtype) {
    1: ss_200_series_panto_rev_original_livery;      // Original 12-car
    sw_200_series_panto_rev_year_dep_livery;         // Year-dependent Livery
}
// 1987 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev_1987_livery, cargo_subtype) {
    1: ss_200_series_panto_rev_original_livery;      // Original 12-car
    2: ss_200_series_panto_rev_original_livery;      // Original 10-car
    3: ss_200_series_panto_rev_original_livery;      // Original 8-car
    sw_200_series_panto_rev_year_dep_livery;         // Year-dependent Livery
}
// 1990 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev_1990_livery, cargo_subtype) {
    1: ss_200_series_panto_rev_original_livery;      // Original 12-car
    2: ss_200_series_panto_rev_original_livery;      // Original 10-car
    3: ss_200_series_panto_rev_original_livery;      // Original 8-car
    4: ss_200_series_panto_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_panto_rev_sharknose_livery;     // Sharknose 16-car
    sw_200_series_panto_rev_year_dep_livery;
}
// 1992 Menu
switch(FEAT_TRAINS, SELF, sw_200_series_panto_rev_1992_livery, cargo_subtype) {
    1: ss_200_series_panto_rev_original_livery;      // Original 12-car
    2: ss_200_series_panto_rev_original_livery;      // Original 10-car
    3: ss_200_series_panto_rev_original_livery;      // Original 8-car
    4: ss_200_series_panto_rev_sharknose_livery;     // Sharknose 12-car
    5: ss_200_series_panto_rev_sharknose_livery;     // Sharknose 16-car
    6: ss_200_series_panto_rev_refurb_livery;        // Refurbished 10-car
    7: ss_200_series_panto_rev_refurb_livery;        // Refurbished 8-car
    sw_200_series_panto_rev_year_dep_livery;
}
// Choose the relevant menu for the current year
switch(FEAT_TRAINS, SELF, ss_200_series_panto_rev, current_year) {
    0..1986: sw_200_series_panto_rev_1982_livery;
    1987..1989: sw_200_series_panto_rev_1987_livery;
    1990..1991: sw_200_series_panto_rev_1990_livery;
    sw_200_series_panto_rev_1992_livery;
}

/* "DOUBLE DECKER" */

spriteset(ss_200_series_2deck,             	                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_200_series_2deck_rev,    		                    "src/gfx/dummy/empty.png") {template_dummy(0,0)}

// 200 Series Sharknose Strip Livery
alternative_sprites(ss_200_series_2deck,                        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_standard(1,81)}
alternative_sprites(ss_200_series_2deck_rev,                    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/200_series/sharknose.png") {template_12_reversed(1,81)}	


/* REVERSERS */

/* COACHES 
  Switches to allow;
1) Coach Car going forwards and a Panto Car going backwards
2) Coach Car going forwards and a Coach Car going backwards
3) Panto Car going forwards and a Coach Car going backwards
4) Panto Car going forwards and a Panto Car going backwards
5) Panto Car going forwards and a 2deck Car going backwards
6) Coach Car going forwards and a 2deck Car going backwards
7) 2deck Car going forwards and a Panto Car going backwards
8) 2deck Car going forwards and a Coach Car going backwards

   1) check reversed */ 

switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_200_series_coach;
	ss_200_series_panto_rev;
}

/* 2) check reversed */ 
/*
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_200_series_coach;
	ss_200_series_coach_rev;
}
*/

/* 3) check reversed */ 
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_200_series_panto;
	ss_200_series_coach_rev;
}

/* 4) check reversed */ 
/*
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_P_P, vehicle_is_reversed) {
	0: ss_200_series_panto;
	ss_200_series_panto_rev;
}
*/

/* 5) check reversed */ 
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_P_D, vehicle_is_reversed) {
	0: ss_200_series_panto;
	ss_200_series_2deck_rev;
}

/* 6) check reversed */ 
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_C_D, vehicle_is_reversed) {
	0: ss_200_series_coach;
	ss_200_series_2deck_rev;
}

/* 7) check reversed */ 
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_D_P, vehicle_is_reversed) {
	0: ss_200_series_2deck;
	ss_200_series_panto_rev;
}

/* 8) check reversed */ 
switch (FEAT_TRAINS, PARENT, sw_200_series_reverser_D_C, vehicle_is_reversed) {
	0: ss_200_series_2deck;
	ss_200_series_coach_rev;
}

/* LENGTH*/

// Make the Middle long sprite length 8 and the dummy sprites length 2
switch (FEAT_TRAINS, SELF, sw_200_series_length_standard, position_in_consist%3) {
    1: return 8;
    return 2;
}

// Make a 12 car set by adjusting sprite sizes
switch(FEAT_TRAINS, SELF, sw_200_series_shorten_12_car_vehicle, position_in_consist%4) {
    2: return 8;
    3: return 2;
    return 1;
}

// Make a 10 car set by adjusting sprite sizes
switch(FEAT_TRAINS, SELF, sw_200_series_shorten_10_car_vehicle_majority, position_in_consist%5) {
    2: return 8;
    return 1;
}

switch(FEAT_TRAINS, SELF, sw_200_series_shorten_10_car_vehicle, position_in_consist) {
    0..44: sw_200_series_shorten_10_car_vehicle_majority;
    46: return 8;
    return 2;
}

// Make a 8 car set by adjusting sprite sizes
switch(FEAT_TRAINS, SELF, sw_200_series_shorten_8_car_vehicle, position_in_consist%6) {
    2: return 7;
    return 1;
}

switch(FEAT_TRAINS, SELF, sw_200_series_length, cargo_subtype) {
    2: sw_200_series_shorten_10_car_vehicle;        // 10-car Original
    3: sw_200_series_shorten_8_car_vehicle;         // 8-car Original
    5: sw_200_series_length_standard;               // 16-car Sharknose
    6: sw_200_series_shorten_10_car_vehicle;        // 10-car Refurbished
    7: sw_200_series_shorten_8_car_vehicle;         // 8-car Refurbished
    sw_200_series_shorten_12_car_vehicle;           // All other 12-length sets
}

/* PUT TOGETHER THE EMU*/

/* 16-car sent */
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_16car, position_in_articulated_veh) {
                                        // 16-car   
    1:  ss_200_series_cab; 	            // Car 1    Car 16  	
	4:  sw_200_series_reverser_P_C;	    // Car 2    Car 15     	
	7:  sw_200_series_reverser_C_P;     // Car 3    Car 14   
	10: sw_200_series_reverser_P_C;     // Car 4    Car 13  
    13: sw_200_series_reverser_C_P;     // Car 5    Car 12  
    16: sw_200_series_reverser_P_D;     // Car 6    Car 11  
    19: sw_200_series_reverser_C_D;     // Car 7    Car 10   
	22: sw_200_series_reverser_P_C;     // Car 8    Car 9  
    25: sw_200_series_reverser_C_P;     // Car 9    Car 8    
    28: sw_200_series_reverser_D_C;     // Car 10   Car 7 
    31: sw_200_series_reverser_D_P;     // Car 11   Car 6  
    34: sw_200_series_reverser_P_C;     // Car 12   Car 5
    37: sw_200_series_reverser_C_P;     // Car 13   Car 4  
    40: sw_200_series_reverser_P_C;     // Car 14   Car 3   
    43: sw_200_series_reverser_C_P;     // Car 15   Car 2  
    46: ss_200_series_cab_rev;          // Car 16   Car 1  
	dummy_sprites;
}

// For 12-car set
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_12car, position_in_articulated_veh) {
                                        // 12-car
    2:  ss_200_series_cab; 	            // Car 1    Car 12	
	6:  sw_200_series_reverser_P_C;     // Car 2    Car 11
    10: sw_200_series_reverser_C_P;     // Car 3    Car 10
    14: sw_200_series_reverser_P_C;     // Car 4    Car 9
    18: sw_200_series_reverser_C_P;     // Car 5    Car 8
    22: sw_200_series_reverser_P_C;     // Car 6    Car 7
    26: sw_200_series_reverser_C_P;     // Car 7    Car 6
    30: sw_200_series_reverser_P_C;     // Car 8    Car 5
    34: sw_200_series_reverser_C_P;     // Car 9    Car 4
    38: sw_200_series_reverser_P_C;     // Car 10   Car 3
    42: sw_200_series_reverser_C_P;     // Car 11   Car 2
    46: ss_200_series_cab_rev;          // Car 12   Car 1
	dummy_sprites;
}

// For 10-car set
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_10car, position_in_articulated_veh) {
                                        // 10-car
    2:  ss_200_series_cab; 		        // Car 1    Car 10	
	7:  sw_200_series_reverser_P_C;     // Car 2    Car 9
    12: sw_200_series_reverser_C_P;     // Car 3    Car 8
    17: sw_200_series_reverser_P_C;     // Car 4    Car 4
    22: sw_200_series_reverser_C_P;     // Car 5    Car 6
    27: sw_200_series_reverser_P_C;     // Car 6    Car 5
    32: sw_200_series_reverser_C_P;     // Car 7    Car 4
    37: sw_200_series_reverser_P_C;     // Car 8    Car 3
    42: sw_200_series_reverser_C_P;     // Car 9    Car 2
    46: ss_200_series_cab_rev;          // Car 10   Car 1
	dummy_sprites;
}

// For 8-car set
switch (FEAT_TRAINS, SELF, sw_200_series_graphics_8car, position_in_articulated_veh) {
                                        // 8-car
    2:  ss_200_series_cab; 	 	        // Car 1    Car 8	
	8:  sw_200_series_reverser_P_C;     // Car 2    Car 7
    14: sw_200_series_reverser_C_P;     // Car 3    Car 6
    20: sw_200_series_reverser_P_C;     // Car 4    Car 5
    26: sw_200_series_reverser_C_P;     // Car 5    Car 4
    32: sw_200_series_reverser_P_C;     // Car 6    Car 3
    38: sw_200_series_reverser_C_P;     // Car 7    Car 2
    44: ss_200_series_cab_rev;          // Car 8    Car 1
	dummy_sprites;
}

/* Choose which Graphics based on which Cargo Subtype */
switch(FEAT_TRAINS, SELF, sw_200_series_graphics, cargo_subtype) {
    2: sw_200_series_graphics_10car;
    3: sw_200_series_graphics_8car;
    5: sw_200_series_graphics_16car;
    6: sw_200_series_graphics_10car;
    7: sw_200_series_graphics_8car;
    sw_200_series_graphics_12car;
}

/* Assemble an 48 part articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_200_series_articulated_part, extra_callback_info1) {
	1 .. 47: return series_200;										
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}
 
switch (FEAT_TRAINS, SELF, sw_200_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_200_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
    0: return 52;       // Low Capacity
    2: return 78;       // High Capacity
    3: return 91;       // Very High Capacity
    return 65;          // Normal Capacity 
}

// Scaling factor for each length of consist
switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity_factor, cargo_subtype) {
    2: return 3125;     // Length 10 (7.5 tiles)
    3: return 2500;     // Length 8 (6 tiles)
    5: return 5000;     // Length 16 (12 tiles)
    6: return 3125;     // Length 10 (7.5 tiles)
    7: return 2500;     // Length 8 (6 tiles)
    return 3750;        // Length 12 (9 tiles)
}

switch(FEAT_TRAINS, SELF, sw_200_series_cargo_capacity, (sw_200_series_param_cargo_capacity() * sw_200_series_cargo_capacity_factor() ) / 10000 )
    {return;}

// Running Costs

switch(FEAT_TRAINS, SELF, sw_200_series_running_costs, cargo_subtype) {
    2: return 187; 
    3: return 150;
    5: return 300;
    6: return 187;
    7: return 150;
    return 225;
}

// Weight

switch(FEAT_TRAINS, SELF, sw_200_series_weight, cargo_subtype) {
    2: return 870;      // Weight of a 7.5 tile long JapanSet 200 Series
    3: return 696;      // Weight of a 6.0 tile long JapanSet 200 Series
    5: return 1392;     // Weight of a 12.0 tile long JapanSet 200 Series
    6: return 870;      // Weight of a 7.5 tile long JapanSet 200 Series
    7: return 696;      // Weight of a 6.0 tile long JapanSet 200 Series 
    return 1044;        // Weight of a 9.0 tile long JapanSet 200 Series
}

// Power
switch(FEAT_TRAINS, SELF, sw_200_series_power, cargo_subtype) {
    2: return 19011; 
    3: return 15209;
    5: return 30417;
    6: return 19011;
    7: return 15209;
    return 22813;    
}

// Speed
switch(FEAT_TRAINS, SELF, sw_200_series_speed, cargo_subtype) {
    1..3: return 210;   // Original speed
    return 240;         // Sharknose and Refurbished Speed
}

item(FEAT_TRAINS, series_200) {
	property {
		name: 							string(STR_NAME_200_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1982,06,23);           // Date of launch
		model_life:                     34;		                    // Until 2008
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// Changed by callback
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          210 km/h;                   // Changed by callback
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					// Changed by callback
		weight:                         1464 ton;                   // Changed by callback					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_200_series_graphics;
		purchase:                       sw_200_series_year_dep_purchase;
		articulated_part:               sw_200_series_articulated_part;
		length:                         sw_200_series_length;
        weight:                         sw_200_series_weight;
        power:                          sw_200_series_power;
        speed:							sw_200_series_speed;
		cargo_capacity:                 sw_200_series_cargo_capacity;
		//colour_mapping:                 sw_cc_blue_white;s
		cargo_subtype_text:             sw_200_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            sw_200_series_running_costs;              // Varies depending on length
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_200_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_200_SERIES);
	}
}

/* End 200 Series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/400_series.pnml" 1
// Begin 400_series

/* GFX */

    // Purchase Sprites
        spriteset (spriteset_400_series_purchase,	        	"src/gfx/dummy/purchase.png") {tmpl_purchase_dh(0, 0)}
        alternative_sprites(spriteset_400_series_purchase,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/buy_400.png") {tmpl_purchase_dh_32bpp(0, 0)}

    // 400 Series Original
        spriteset(ss_400_series_cab_original,                   "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_cab_rev_original,               "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_original,                 "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_rev_original,             "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_original,                 "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_rev_original,             "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_400_series_cab_original,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,1)}
        alternative_sprites(ss_400_series_cab_rev_original,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,41)}
        alternative_sprites(ss_400_series_coach_original,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,121)}
        alternative_sprites(ss_400_series_coach_rev_original,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_400_series_panto_original,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_standard(1,81)}
        alternative_sprites(ss_400_series_panto_rev_original,   ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_original.png") {template_8_reversed(1,81)}

    // 400 Series Refurbished
        spriteset(ss_400_series_cab_refurb,                     "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_cab_rev_refurb,                 "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_refurb,                   "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_coach_rev_refurb,               "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_refurb,                   "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_400_series_panto_rev_refurb,               "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_400_series_cab_refurb,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,1)}
        alternative_sprites(ss_400_series_cab_rev_refurb,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,41)}
        alternative_sprites(ss_400_series_coach_refurb,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,121)}
        alternative_sprites(ss_400_series_coach_rev_refurb,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_400_series_panto_refurb,         ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_standard(1,81)}
        alternative_sprites(ss_400_series_panto_rev_refurb,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/400_series/400_series_refurb.png") {template_8_reversed(1,81)}    

/* LIVERIES */

    // Cab Livery (Yelow Lights)
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_cab_original;
        1 : ss_400_series_cab_refurb;
    }
    // Cab Reversed Livery (Red lights)
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_cab_rev_original;
        1 : ss_400_series_cab_rev_refurb;
    }
    // Coach Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_coach_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_coach_original;
        1 : ss_400_series_coach_refurb;
    }
    // Coach Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_coach_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_coach_rev_original;
        1 : ss_400_series_coach_rev_refurb;
    }
    // Panto Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_panto_original;
        1 : ss_400_series_panto_refurb;
    }
    // Panto Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_panto_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_400_series_panto_rev_original;
        1 : ss_400_series_panto_rev_refurb;
    }

/* COACH and PANTO flipping */

    // Check if Coach is flipped
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_coach_flippedcheck, vehicle_is_flipped) {
        1 : sw_400_series_gfx_coach_livery;
        default : sw_400_series_gfx_coach_rev_livery;
    }
    // Check if Panto is flipped
    switch(FEAT_TRAINS, SELF, sw_400_series_gfx_panto_flippedcheck, vehicle_is_flipped) {
        1 : sw_400_series_gfx_panto_livery;
    default : sw_400_series_gfx_panto_rev_livery;
    }

/* PANTOGRAPH CHECKS */

switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_original_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_400_series_gfx_panto_flippedcheck;
 default : sw_400_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_original_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_400_series_gfx_panto_flippedcheck;
 //4 : sw_400_series_gfx_panto_flippedcheck;
 7 : sw_400_series_gfx_panto_flippedcheck;
 default : sw_400_series_gfx_coach_flippedcheck;
}

switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_original, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_400_series_gfx_rev_pantograph_pos_original_sw1;
  default : sw_400_series_gfx_rev_pantograph_pos_original_sw2;
}

switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_refurb_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_400_series_gfx_panto_flippedcheck;
 default : sw_400_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_refurb_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_400_series_gfx_panto_flippedcheck;
 //4 : sw_400_series_gfx_panto_flippedcheck;
 7 : sw_400_series_gfx_panto_flippedcheck;
 default : sw_400_series_gfx_coach_flippedcheck;
}

switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_pantograph_pos_refurb, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_400_series_gfx_rev_pantograph_pos_refurb_sw1;
  default : sw_400_series_gfx_rev_pantograph_pos_refurb_sw2;
}

switch(FEAT_TRAINS,SELF, sw_400_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
    0 : sw_400_series_gfx_rev_pantograph_pos_original;
    1 : sw_400_series_gfx_rev_pantograph_pos_refurb;
}

switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_400_series_gfx_cab_rev_livery;
 0 : sw_400_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_400_series_gfx_cab_livery;
 0 : sw_400_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_400_series_gfx_rev_frontback_aftermucars;         // From above switch
 default : sw_400_series_gfx_rev_frontback_nomucars;         // From above switch
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 400 : sw_400_series_gfx_rev_frontback_mucarcheck;
 1000 : sw_400_series_gfx_cab_rev_livery;
 default : sw_400_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 400 : sw_400_series_gfx_rev_frontback_sameid;
 1000 : sw_400_series_gfx_cab_livery;
 default : sw_400_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_400_series_gfx_rev_pantograph_pos;        
 400 : sw_400_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_original_sw1, position_in_vehid_chain){
 0 : ss_400_series_panto_original;
 default : ss_400_series_coach_original;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_original_sw2, position_in_vehid_chain%10){
 1 : ss_400_series_panto_original;
 //4 : ss_400_series_panto_original;
 7 : ss_400_series_panto_original;
 default : ss_400_series_coach_original;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_original, num_vehs_in_vehid_chain){
  0..2 : sw_400_series_gfx_pantograph_pos_original_sw1;
  default : sw_400_series_gfx_pantograph_pos_original_sw2;
}

switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_refurb_sw1, position_in_vehid_chain){
 0 : ss_400_series_panto_refurb;
 default : ss_400_series_coach_refurb;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_refurb_sw2, position_in_vehid_chain%10){
 1 : ss_400_series_panto_refurb;
 //4 : ss_400_series_panto_refurb;
 7 : ss_400_series_panto_refurb;
 default : ss_400_series_coach_refurb;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_pantograph_pos_refurb, num_vehs_in_vehid_chain){
  0..2 : sw_400_series_gfx_pantograph_pos_refurb_sw1;
  default : sw_400_series_gfx_pantograph_pos_refurb_sw2;
}

/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/

// Original Set
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_flipcheck_original, vehicle_is_flipped){
 0: ss_400_series_cab_original;                             // Cab
 default: ss_400_series_cab_rev_original;                   // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_cab_original, vehicle_is_reversed){
 0: sw_400_series_gfx_cab_flipcheck_original;               // Above switch
 default: sw_400_series_gfx_rev_idcheck;             // 
}

// Refurbished Set
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_cab_flipcheck_refurb, vehicle_is_flipped){
 0: ss_400_series_cab_refurb;                             // Cab
 default: ss_400_series_cab_rev_refurb;                   // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_cab_refurb, vehicle_is_reversed){
 0: sw_400_series_gfx_cab_flipcheck_refurb;               // Above switch
 default: sw_400_series_gfx_rev_idcheck;             // 
}


/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_mucar_revcheck_mid_original, vehicle_is_reversed){
 0: sw_400_series_gfx_pantograph_pos_original;
 default: sw_400_series_gfx_rev_idcheck;
}

switch(FEAT_TRAINS, PARENT, sw_400_series_gfx_mucar_revcheck_mid_refurb, vehicle_is_reversed){
 0: sw_400_series_gfx_pantograph_pos_refurb;
 default: sw_400_series_gfx_rev_idcheck;
}

/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_mucar,  cargo_subtype) {
0 : sw_400_series_gfx_mucar_revcheck_mid_original;
1 : sw_400_series_gfx_mucar_revcheck_mid_refurb;
}
switch(FEAT_TRAINS, SELF, sw_400_series_gfx_main,  cargo_subtype) {
0 : sw_400_series_gfx_cab_original;
1 : sw_400_series_gfx_cab_refurb;
}
/*---END OF SECTION---*/
/*---GFX: Livery Menu Switches---*/
switch(FEAT_TRAINS, SELF, sw_400_series_subtypetext_mucar, cargo_subtype) {
0 : string(LV_400_SERIES_ORIGINAL);
1 : string(LV_400_SERIES_REFURB);
}
switch(FEAT_TRAINS, SELF, sw_400_series_subtypetext_main, cargo_subtype) {
0 : string(LV_400_SERIES_ORIGINAL);
1 : string(LV_400_SERIES_REFURB);
}
/*---END OF SECTION---*/
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_400_series_attach_vehid, [vehicle_type_id == series_400 || vehicle_type_id == mu_car]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_400_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 50 capacity per car (same as JapanSet)
    0: return 40;       // Low Capacity
    2: return 60;       // High Capacity
    3: return 70;       // Very High Capacity
    return 50;          // Normal Capacity 
}

// Loading Speed

// Loading Speeds for each parameter level
switch(FEAT_TRAINS, SELF, sw_400_series_param_loading_speed, param_basecapacity) {
    // Loading Capacity for a 2 door
    0: return 10;       // Low Capacity
    2: return 30;       // High Capacity
    3: return 40;       // Very High Capacity
    return 20;          // Normal Capacity 
}

item(FEAT_TRAINS, series_400) {
    property {
        name:                           string(STR_NAME_400_SERIES);
        introduction_date:              date(1992,07,01);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    18;
        running_cost_factor:            48;
        speed:                          240 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          2000 kW;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.2;
        air_drag_coefficient:           0.07;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_400_series_gfx_main;
	    purchase:                       spriteset_400_series_purchase;
		additional_text:	            return string(STR_DESC_400_SERIES);
        cargo_subtype_text:             sw_400_series_subtypetext_main;
        can_attach_wagon:			    sw_400_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car){
        default:                        sw_400_series_gfx_mucar;
        cargo_capacity:                 sw_400_series_param_cargo_capacity;
        loading_speed:                  sw_400_series_param_loading_speed;
        cargo_subtype_text:             sw_400_series_subtypetext_mucar;
        power:                          400/2;
        weight:                         30;
      }

}

// End 400_series
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e1_series_fixed.pnml" 1
/* Begin e1 Series */

/* SPRITES */

/* Purchase Menu */
    spriteset (ss_e1_series_buy_original_livery,	        	    "src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    spriteset (ss_e1_series_buy_refurb_livery,	        	        "src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}

    alternative_sprites(ss_e1_series_buy_original_livery,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/buy_e1_original.png") {template_purchase(0, 0)}
    alternative_sprites(ss_e1_series_buy_refurb_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/buy_e1_refurb.png")   {template_purchase(0, 0)}

    switch(FEAT_TRAINS, SELF, sw_e1_series_year_dep_purchase, current_year) {
        0..2003: ss_e1_series_buy_original_livery;
        ss_e1_series_buy_refurb_livery;
    }

/* EMU Parts */

/* "CAB" */
spriteset(ss_e1_series_cab_original_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_cab_rev_original_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_cab_refurb_livery,             		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_cab_rev_refurb_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

// E1 Series Original Livery
alternative_sprites(ss_e1_series_cab_original_livery,     	        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_standard(1,1)}
alternative_sprites(ss_e1_series_cab_rev_original_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_reversed(1,41)}		

// E1 Series Refurbished Livery
alternative_sprites(ss_e1_series_cab_refurb_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_standard(1,1)}
alternative_sprites(ss_e1_series_cab_rev_refurb_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_reversed(1,41)}

/* COACH */
spriteset(ss_e1_series_coach_original_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_coach_reversed_original_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_coach_refurb_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_coach_reversed_refurb_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

// E1 Series Original Livery
alternative_sprites(ss_e1_series_coach_original_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_standard(1,121)}
alternative_sprites(ss_e1_series_coach_reversed_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_reversed(1,121)}

// E1 Series Refurbished Livery
alternative_sprites(ss_e1_series_coach_refurb_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_standard(1,121)}
alternative_sprites(ss_e1_series_coach_reversed_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_reversed(1,121)}	

// Coach Panto
spriteset(ss_e1_series_panto_original_livery,          		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_panto_reversed_original_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_panto_refurb_livery,          		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e1_series_panto_reversed_refurb_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

// E1 Series Original Livery
alternative_sprites(ss_e1_series_panto_original_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_standard(1,81)}
alternative_sprites(ss_e1_series_panto_reversed_original_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_original.png") {template_12_reversed(1,81)}	

// E1 Series Refurbished Livery
alternative_sprites(ss_e1_series_panto_refurb_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_standard(1,81)}
alternative_sprites(ss_e1_series_panto_reversed_refurb_livery,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e1_series/e1_refurb.png") {template_12_reversed(1,81)}	

/* PICK THE LIVERY */

// CAB

switch(FEAT_TRAINS, SELF, sw_e1_series_cab_year_dep_livery, build_year) {
    0..2003: ss_e1_series_cab_original_livery;
    2004..9999: ss_e1_series_cab_refurb_livery;
    ss_e1_series_cab_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_cab_old_livery, cargo_subtype) {
    1: ss_e1_series_cab_original_livery;
    sw_e1_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_cab_new_livery, cargo_subtype) {
    1: ss_e1_series_cab_original_livery;
    2: ss_e1_series_cab_refurb_livery;
    sw_e1_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e1_series_cab, current_year) {
    0..2003: sw_e1_series_cab_old_livery;
    sw_e1_series_cab_new_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_e1_series_cab_rev_year_dep_livery, build_year) {
    0..2003: ss_e1_series_cab_rev_original_livery;
    2004..9999: ss_e1_series_cab_rev_refurb_livery;
    ss_e1_series_cab_rev_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_cab_rev_old_livery, cargo_subtype) {
    1: ss_e1_series_cab_rev_original_livery;
    sw_e1_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_cab_rev_new_livery, cargo_subtype) {
    1: ss_e1_series_cab_rev_original_livery;
    2: ss_e1_series_cab_rev_refurb_livery;
    sw_e1_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e1_series_cab_rev, current_year) {
    0..2003: sw_e1_series_cab_rev_old_livery;
    sw_e1_series_cab_rev_new_livery;
}

// Coach

switch(FEAT_TRAINS, SELF, sw_e1_series_coach_year_dep_livery, build_year) {
    0..2003: ss_e1_series_coach_original_livery;
    2004..9999: ss_e1_series_coach_refurb_livery;
    ss_e1_series_coach_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_coach_old_livery, cargo_subtype) {
    1: ss_e1_series_coach_original_livery;
    sw_e1_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_coach_new_livery, cargo_subtype) {
    1: ss_e1_series_coach_original_livery;
    2: ss_e1_series_coach_refurb_livery;
    sw_e1_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e1_series_coach, current_year) {
    0..2003: sw_e1_series_coach_old_livery;
    sw_e1_series_coach_new_livery;
}

// Coach Reversed

switch(FEAT_TRAINS, SELF, sw_e1_series_coach_reversed_year_dep_livery, build_year) {
    0..2003: ss_e1_series_coach_reversed_original_livery;
    2004..9999: ss_e1_series_coach_reversed_refurb_livery;
    ss_e1_series_coach_reversed_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_coach_reversed_old_livery, cargo_subtype) {
    1: ss_e1_series_coach_reversed_original_livery;
    sw_e1_series_coach_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_coach_reversed_new_livery, cargo_subtype) {
    1: ss_e1_series_coach_reversed_original_livery;
    2: ss_e1_series_coach_reversed_refurb_livery;
    sw_e1_series_coach_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e1_series_coach_reversed, current_year) {
    0..2003: sw_e1_series_coach_reversed_old_livery;
    sw_e1_series_coach_reversed_new_livery;
}

// Panto

switch(FEAT_TRAINS, SELF, sw_e1_series_panto_year_dep_livery, build_year) {
    0..2003: ss_e1_series_panto_original_livery;
    2004..9999: ss_e1_series_panto_refurb_livery;
    ss_e1_series_panto_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_panto_old_livery, cargo_subtype) {
    1: ss_e1_series_panto_original_livery;
    sw_e1_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_panto_new_livery, cargo_subtype) {
    1: ss_e1_series_panto_original_livery;
    2: ss_e1_series_panto_refurb_livery;
    sw_e1_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e1_series_panto, current_year) {
    0..2003: sw_e1_series_panto_old_livery;
    sw_e1_series_panto_new_livery;
}

// Panto Reversed

switch(FEAT_TRAINS, SELF, sw_e1_series_panto_reversed_year_dep_livery, build_year) {
    0..2003: ss_e1_series_panto_reversed_original_livery;
    2004..9999: ss_e1_series_panto_reversed_refurb_livery;
    ss_e1_series_panto_reversed_original_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_panto_reversed_old_livery, cargo_subtype) {
    1: ss_e1_series_panto_reversed_original_livery;
    sw_e1_series_panto_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e1_series_panto_reversed_new_livery, cargo_subtype) {
    1: ss_e1_series_panto_reversed_original_livery;
    2: ss_e1_series_panto_reversed_refurb_livery;
    sw_e1_series_panto_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e1_series_panto_reversed, current_year) {
    0..2003: sw_e1_series_panto_reversed_old_livery;
    sw_e1_series_panto_reversed_new_livery;
}

// Pre 2003 subtype text
switch(FEAT_TRAINS, SELF, sw_e1_series_old_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E1_SERIES_ORIGINAL); 
       return CB_RESULT_NO_TEXT;
    }

// Post 2003 subtype text
switch(FEAT_TRAINS, SELF, sw_e1_series_new_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E1_SERIES_ORIGINAL);
    2: return string(LV_E1_SERIES_REFURB);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e1_series_year_dep_subtype_text, current_year) {
    0..2003: sw_e1_series_old_livery_subtype_text;
    sw_e1_series_new_livery_subtype_text;
}

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e1_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e1_series_coach;
	ss_e1_series_panto_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e1_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e1_series_coach;
	ss_e1_series_coach_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e1_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e1_series_panto;
	ss_e1_series_coach_reversed;
}

/* LENGTH*/

/* Make the Middle long sprite length 8 and the dummy sprites length 2*/
switch (FEAT_TRAINS, SELF, sw_e1_series_length, position_in_consist%3) {
    1: return 8;
    return 2;
}

/* PUT TOGETHER THE EMU*/

/* Select the correct part of the train */
switch (FEAT_TRAINS, SELF, sw_e1_series_graphics, position_in_articulated_veh) {					
	1:  ss_e1_series_cab; 	            // Car 1    Car 12									
	4:  sw_e1_series_reverser_C_C;	    // Car 2	Car 11							
	7:  sw_e1_series_reverser_C_P;      // Car 3    Car 10
	10: sw_e1_series_reverser_C_C;      // Car 4    Car 9
    13: sw_e1_series_reverser_C_C;      // Car 5    Car 8
    16: sw_e1_series_reverser_P_C;      // Car 6    Car 7
    19: sw_e1_series_reverser_C_P;      // Car 7    Car 6
	22: sw_e1_series_reverser_C_C;      // Car 8    Car 5 
    25: sw_e1_series_reverser_C_C;      // Car 9    Car 4
    28: sw_e1_series_reverser_P_C;      // Car 10   Car 3
    31: sw_e1_series_reverser_C_C;      // Car 11   Car 2
    34: ss_e1_series_cab_rev;           // Car 12   Car 1
	dummy_sprites;
}

/* Assemble an 12-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e1_series_articulated_part, extra_callback_info1) {
	1 .. 35: return series_e1;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_e1_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e1_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 100 capacity per car (same as JapanSet)
    0: return 40;       // Low Capacity
    2: return 60;       // High Capacity
    3: return 70;       // Very High Capacity
    return 50;          // Normal Capacity 
}

item(FEAT_TRAINS, series_e1) {
	property {
		name: 							string(STR_NAME_E1_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1994,07,15);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          241 km/h;				// Operational Top Speed
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          11300 kW;					// 
		weight:                         1044 tons;					// Agreed to 9.0 tile JapanSet E1 Series
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_e1_series_graphics;
		purchase:                       sw_e1_series_year_dep_purchase;
		articulated_part:               sw_e1_series_articulated_part;
		length:                         sw_e1_series_length;
		cargo_capacity:                 sw_e1_series_param_cargo_capacity;                                         
		cargo_subtype_text:             sw_e1_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_e1_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_E1_SERIES);
	}
}

/* End e1 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e2_series_fixed.pnml" 1
/* Begin e2 Series */

/* CARGO SUBTYPE MENU*/

    // From 1997 to 2002
    switch(FEAT_TRAINS, SELF, sw_e2_series_1997_subtype_text, cargo_subtype) {
        0: return string(LV_E2_SERIES_08CAR);
        return CB_RESULT_NO_TEXT;
        }

    // From 2002 onwards - introduction of 10-car sets
    switch(FEAT_TRAINS, SELF, sw_e2_series_2002_subtype_text, cargo_subtype) {
        0: return string(LV_E2_SERIES_08CAR);
	    1: return string(LV_E2_SERIES_10CAR);
        return CB_RESULT_NO_TEXT;
        }

    switch(FEAT_TRAINS, SELF, sw_e2_series_year_dep_subtype_text, current_year) {
        0..2001: sw_e2_series_1997_subtype_text;
        sw_e2_series_2002_subtype_text;
}

/* SPRITES */

    // Purchase Menu
    spriteset (ss_e2_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_e2_series_buy,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_e2_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/e2_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e2_series_cab_rev,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/e2_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_e2_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/e2_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e2_series_coach_rev,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/e2_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_e2_series_panto,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e2_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e2_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/e2_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e2_series_panto_rev,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e2_series/e2_series.png") {template_12_reversed(1,81)}	

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e2_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e2_series_coach;
	ss_e2_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e2_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e2_series_coach;
	ss_e2_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e2_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e2_series_panto;
	ss_e2_series_coach_rev;
}

/* LENGTH*/

    // Make the Middle long sprite length 8 and the dummy sprites length 2
    switch (FEAT_TRAINS, SELF, sw_e2_series_length_standard, position_in_consist%3) {
        1: return 8;
        return 2;
    }

    switch (FEAT_TRAINS, SELF, sw_e2_series_length_08car_majority, position_in_consist%4) {
        0: return 2;
        1: return 8;
        return 1;
    }

    switch (FEAT_TRAINS, SELF, sw_e2_series_length_08car, position_in_consist) {
        24: return 2;
        25: return 8;
        26: return 2;
        27: return 2;
        28: return 8;
        29: return 2;
        return sw_e2_series_length_08car_majority;
    }

    switch(FEAT_TRAINS, SELF, sw_e2_series_length, cargo_subtype) {
        1: sw_e2_series_length_standard;        // 10-car Set
        sw_e2_series_length_08car;               // 8-car Set
    }
 
/* PUT TOGETHER THE EMU*/

    // 10 Car Set
    switch (FEAT_TRAINS, SELF, sw_e2_series_graphics_10car, position_in_articulated_veh) {					
	    1:  ss_e2_series_cab; 	            // Car 1	Car 10								
	    4:  sw_e2_series_reverser_C_C;	    // Car 2	Car 9	    						
	    7:  sw_e2_series_reverser_C_C;      // Car 3    Car 8
	    10: sw_e2_series_reverser_P_C;      // Car 4    Car 7
        13: sw_e2_series_reverser_C_P;      // Car 5    Car 6
        16: sw_e2_series_reverser_P_C;      // Car 6    Car 5
        19: sw_e2_series_reverser_C_P;      // Car 7    Car 4
	    22: sw_e2_series_reverser_C_C;      // Car 8    Car 3
        25: sw_e2_series_reverser_C_C;      // Car 9    Car 2
        28: ss_e2_series_cab_rev;           // Car 10   Car 1
	    dummy_sprites;
    }
    // 8 Car Set
    switch (FEAT_TRAINS, SELF, sw_e2_series_graphics_08car, position_in_articulated_veh) {					
	    1:  ss_e2_series_cab; 	            // Car 1	Car 8								
	    5:  sw_e2_series_reverser_C_C;	    // Car 2	Car 7	    						
	    9:  sw_e2_series_reverser_C_P;      // Car 3    Car 6
	    13: sw_e2_series_reverser_P_C;      // Car 4    Car 5
        17: sw_e2_series_reverser_C_P;      // Car 5    Car 4
        21: sw_e2_series_reverser_P_C;      // Car 6    Car 3
        25: sw_e2_series_reverser_C_C;      // Car 7    Car 2
        28: ss_e2_series_cab_rev;           // Car 8    Car 1
	    dummy_sprites;
    }
    // Graphics selection per cargo subtype
    switch(FEAT_TRAINS, SELF, sw_e2_series_graphics, cargo_subtype) {
        1: sw_e2_series_graphics_10car;         // 10-car Set
        sw_e2_series_graphics_08car;            // 8-car Set
    }

/* Assemble an articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e2_series_articulated_part, extra_callback_info1) {
	1 .. 29: return series_e2;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_e2_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

/* CARGO CAPACITY */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_e2_series_param_cargo_capacity, param_basecapacity) {
        // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
        0: return 52;       // Low Capacity
        2: return 78;       // High Capacity
        3: return 91;       // Very High Capacity
        return 65;          // Normal Capacity 
    }

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_e2_series_cargo_capacity_factor, cargo_subtype) {
        1: return 5;     // Length 10 (7.5 tiles)
        return 4;        // Length 8 (6 tiles)
    }

    switch(FEAT_TRAINS, SELF, sw_e2_series_cargo_capacity, (sw_e2_series_param_cargo_capacity() * sw_e2_series_cargo_capacity_factor() ) / 10 ){return;}

/* WEIGHT */
    switch(FEAT_TRAINS, SELF, sw_e2_series_weight, cargo_subtype) {
        1: return 690;      // Weight of a 7.5 tile long JapanSet E2 Series
        return 552;         // Weight of a 6.0 tile long JapanSet E2 Series
    }

/* POWER */
    switch(FEAT_TRAINS, SELF, sw_e2_series_power, cargo_subtype) {
        1: return 18250; 
        return 14600;    
    }

item(FEAT_TRAINS, series_e2) {
	property {
		name: 							string(STR_NAME_E2_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,03,22);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          275 km/h;				// Operational Top Speed
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					
		weight:                         648 tons;					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_e2_series_graphics;
		purchase:                       ss_e2_series_buy;
		articulated_part:               sw_e2_series_articulated_part;
		length:                         sw_e2_series_length;
        power:                          sw_e2_series_power;
        weight:                         sw_e2_series_weight;
		cargo_capacity:                 sw_e2_series_cargo_capacity;
		cargo_subtype_text:             sw_e2_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_e2_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_E2_SERIES);
	}
}

/* End e2 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e3_series.pnml" 1
// Begin e3_series

/* GFX */

    // Purchase Sprites
        spriteset (spriteset_e3_series_purchase,	        	"src/gfx/dummy/purchase.png") {tmpl_purchase_dh(0, 0)}
        alternative_sprites(spriteset_e3_series_purchase,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/buy_e3_r.png") {tmpl_purchase_dh_32bpp(0, 0)}

    // E3 Series R Set
        spriteset(ss_e3_series_cab_r,                           "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_cab_rev_r,                       "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_r,                         "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_rev_r,                     "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_r,                         "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_rev_r,                     "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e3_series_cab_r,                 ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e3_series_cab_rev_r,             ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e3_series_coach_r,               ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e3_series_coach_rev_r,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e3_series_panto_r,               ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e3_series_panto_rev_r,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_r.png") {template_8_reversed(1,81)}

    // E3-1000 Series
        spriteset(ss_e3_series_cab_1000,                        "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_cab_rev_1000,                    "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_1000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_rev_1000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_1000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_rev_1000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e3_series_cab_1000,              ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e3_series_cab_rev_1000,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e3_series_coach_1000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e3_series_coach_rev_1000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e3_series_panto_1000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e3_series_panto_rev_1000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_1000.png") {template_8_reversed(1,81)}

    // E3-2000 Series
        spriteset(ss_e3_series_cab_2000,                        "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_cab_rev_2000,                    "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_2000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_coach_rev_2000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_2000,                      "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e3_series_panto_rev_2000,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e3_series_cab_2000,              ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e3_series_cab_rev_2000,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e3_series_coach_2000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e3_series_coach_rev_2000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e3_series_panto_2000,            ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e3_series_panto_rev_2000,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e3_series/e3_2000.png") {template_8_reversed(1,81)}

/* LIVERIES */

    // Cab Livery (Yelow Lights)
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_cab_r;
        1 : ss_e3_series_cab_1000;
        2 : ss_e3_series_cab_2000;
    }
    // Cab Reversed Livery (Red lights)
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_cab_rev_r;
        1 : ss_e3_series_cab_rev_1000;
        2 : ss_e3_series_cab_rev_2000;
    }
    // Coach Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_coach_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_coach_r;
        1 : ss_e3_series_coach_1000;
        2 : ss_e3_series_coach_2000;
    }
    // Coach Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_coach_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_coach_rev_r;
        1 : ss_e3_series_coach_rev_1000;
        2 : ss_e3_series_coach_rev_2000;
    }
    // Panto Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_panto_r;
        1 : ss_e3_series_panto_1000;
        2 : ss_e3_series_panto_2000;
    }
    // Panto Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_panto_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e3_series_panto_rev_r;
        1 : ss_e3_series_panto_rev_1000;
        2 : ss_e3_series_panto_rev_2000;
    }

/* COACH and PANTO flipping */

    // Check if Coach is flipped
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_coach_flippedcheck, vehicle_is_flipped) {
        1 : sw_e3_series_gfx_coach_livery;
        default : sw_e3_series_gfx_coach_rev_livery;
    }
    // Check if Panto is flipped
    switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_panto_flippedcheck, vehicle_is_flipped) {
        1 : sw_e3_series_gfx_panto_livery;
    default : sw_e3_series_gfx_panto_rev_livery;
    }

/* PANTOGRAPH CHECKS */

switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_r_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_r_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e3_series_gfx_panto_flippedcheck;
 //4 : sw_e3_series_gfx_panto_flippedcheck;
 7 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_1000_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_1000_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e3_series_gfx_panto_flippedcheck;
 //4 : sw_e3_series_gfx_panto_flippedcheck;
 7 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_2000_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_2000_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e3_series_gfx_panto_flippedcheck;
 //4 : sw_e3_series_gfx_panto_flippedcheck;
 7 : sw_e3_series_gfx_panto_flippedcheck;
 default : sw_e3_series_gfx_coach_flippedcheck;
}

switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_r, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e3_series_gfx_rev_pantograph_pos_r_sw1;
  default : sw_e3_series_gfx_rev_pantograph_pos_r_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_1000, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e3_series_gfx_rev_pantograph_pos_1000_sw1;
  default : sw_e3_series_gfx_rev_pantograph_pos_1000_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_pantograph_pos_2000, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e3_series_gfx_rev_pantograph_pos_2000_sw1;
  default : sw_e3_series_gfx_rev_pantograph_pos_2000_sw2;
}

switch(FEAT_TRAINS,SELF, sw_e3_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : sw_e3_series_gfx_rev_pantograph_pos_r;
1 : sw_e3_series_gfx_rev_pantograph_pos_1000;
2 : sw_e3_series_gfx_rev_pantograph_pos_2000;
}

switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e3_series_gfx_cab_rev_livery;
 0 : sw_e3_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e3_series_gfx_cab_livery;
 0 : sw_e3_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_e3_series_gfx_rev_frontback_aftermucars;         // From above switch
 default : sw_e3_series_gfx_rev_frontback_nomucars;         // From above switch
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2003 : sw_e3_series_gfx_rev_frontback_mucarcheck;
 1000 : sw_e3_series_gfx_cab_rev_livery;
 default : sw_e3_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2003 : sw_e3_series_gfx_rev_frontback_sameid;
 1000 : sw_e3_series_gfx_cab_livery;
 default : sw_e3_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_e3_series_gfx_rev_pantograph_pos;        
 2003 : sw_e3_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_r_sw1, position_in_vehid_chain){
 0 : ss_e3_series_panto_r;
 default : ss_e3_series_coach_r;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_r_sw2, position_in_vehid_chain%10){
 1 : ss_e3_series_panto_r;
 //4 : ss_e3_series_panto_r;
 7 : ss_e3_series_panto_r;
 default : ss_e3_series_coach_r;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_1000_sw1, position_in_vehid_chain){
 0 : ss_e3_series_panto_1000;
 default : ss_e3_series_coach_1000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_1000_sw2, position_in_vehid_chain%10){
 1 : ss_e3_series_panto_1000;
 //4 : ss_e3_series_panto_1000;
 7 : ss_e3_series_panto_1000;
 default : ss_e3_series_coach_1000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_2000_sw1, position_in_vehid_chain){
 0 : ss_e3_series_panto_2000;
 default : ss_e3_series_coach_2000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_2000_sw2, position_in_vehid_chain%10){
 1 : ss_e3_series_panto_2000;
 //4 : ss_e3_series_panto_2000;
 7 : ss_e3_series_panto_2000;
 default : ss_e3_series_coach_2000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_r, num_vehs_in_vehid_chain){
  0..2 : sw_e3_series_gfx_pantograph_pos_r_sw1;
  default : sw_e3_series_gfx_pantograph_pos_r_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_1000, num_vehs_in_vehid_chain){
  0..2 : sw_e3_series_gfx_pantograph_pos_1000_sw1;
  default : sw_e3_series_gfx_pantograph_pos_1000_sw2;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_pantograph_pos_2000, num_vehs_in_vehid_chain){
  0..2 : sw_e3_series_gfx_pantograph_pos_2000_sw1;
  default : sw_e3_series_gfx_pantograph_pos_2000_sw2;
}
/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/

// R Set
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_flipcheck_r, vehicle_is_flipped){
 0: ss_e3_series_cab_r;                             // Cab
 default: ss_e3_series_cab_rev_r;                   // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_cab_r, vehicle_is_reversed){
 0: sw_e3_series_gfx_cab_flipcheck_r;               // Above switch
 default: sw_e3_series_gfx_rev_idcheck;             // 
}

// 1000 Series
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_flipcheck_1000, vehicle_is_flipped){
 0: ss_e3_series_cab_1000;                          // Cab
 default: ss_e3_series_cab_rev_1000;                // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_cab_1000, vehicle_is_reversed){
 0: sw_e3_series_gfx_cab_flipcheck_1000;            // Above switch
 default: sw_e3_series_gfx_rev_idcheck;             // 
}

// 2000 Series
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_cab_flipcheck_2000, vehicle_is_flipped){
 0: ss_e3_series_cab_2000;                          // Cab
 default: ss_e3_series_cab_rev_2000;                // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_cab_2000, vehicle_is_reversed){
 0: sw_e3_series_gfx_cab_flipcheck_2000;            // Above switch
 default: sw_e3_series_gfx_rev_idcheck;             // 
}

/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_mucar_revcheck_mid_r, vehicle_is_reversed){
 0: sw_e3_series_gfx_pantograph_pos_r;
 default: sw_e3_series_gfx_rev_idcheck;
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_mucar_revcheck_mid_1000, vehicle_is_reversed){
 0: sw_e3_series_gfx_pantograph_pos_1000;
 default: sw_e3_series_gfx_rev_idcheck;
}
switch(FEAT_TRAINS, PARENT, sw_e3_series_gfx_mucar_revcheck_mid_2000, vehicle_is_reversed){
 0: sw_e3_series_gfx_pantograph_pos_2000;
 default: sw_e3_series_gfx_rev_idcheck;
}

/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_mucar,  cargo_subtype) {
0 : sw_e3_series_gfx_mucar_revcheck_mid_r;
1 : sw_e3_series_gfx_mucar_revcheck_mid_1000;
2 : sw_e3_series_gfx_mucar_revcheck_mid_2000;
}
switch(FEAT_TRAINS, SELF, sw_e3_series_gfx_main,  cargo_subtype) {
0 : sw_e3_series_gfx_cab_r;
1 : sw_e3_series_gfx_cab_1000;
2 : sw_e3_series_gfx_cab_2000;
}
/*---END OF SECTION---*/
/*---GFX: Livery Menu Switches---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_subtypetext_mucar, cargo_subtype) {
0 : string(LV_E3_SERIES_R);
1 : string(LV_E3_SERIES_1000);
2 : string(LV_E3_SERIES_2000); 
}
switch(FEAT_TRAINS, SELF, sw_e3_series_subtypetext_main, cargo_subtype) {
0 : string(LV_E3_SERIES_R);
1 : string(LV_E3_SERIES_1000);
2 : string(LV_E3_SERIES_2000); 
}
/*---END OF SECTION---*/
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e3_series_attach_vehid, [vehicle_type_id == series_e3 || vehicle_type_id == mu_car]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e3_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 50 capacity per car (same as JapanSet)
    0: return 40;       // Low Capacity
    2: return 60;       // High Capacity
    3: return 70;       // Very High Capacity
    return 50;          // Normal Capacity 
}

// Loading Speed

// Loading Speeds for each parameter level
switch(FEAT_TRAINS, SELF, sw_e3_series_param_loading_speed, param_basecapacity) {
    // Loading Capacity for a 2 door
    0: return 10;       // Low Capacity
    2: return 30;       // High Capacity
    3: return 40;       // Very High Capacity
    return 20;          // Normal Capacity 
}

item(FEAT_TRAINS, series_e3) {
    property {
        name:                           string(STR_NAME_E3_SERIES );
        introduction_date:              date(1997,03,22);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    18;
        running_cost_factor:            48;
        speed:                          275 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          2000 kW;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.2;
        air_drag_coefficient:           0.07;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e3_series_gfx_main;
	    purchase:                       spriteset_e3_series_purchase;
		additional_text:	            return string(STR_DESC_E3_SERIES);
        cargo_subtype_text:             sw_e3_series_subtypetext_main;
        can_attach_wagon:			    sw_e3_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car){
        default:                        sw_e3_series_gfx_mucar;
        cargo_capacity:                 sw_e3_series_param_cargo_capacity;
        loading_speed:                  sw_e3_series_param_loading_speed;
        cargo_subtype_text:             sw_e3_series_subtypetext_mucar;
        power:                          400/2;
        weight:                         30;
      }

}

// End e3_series
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e4_series_fixed.pnml" 1
/* Begin e4 Series */

/* SPRITES */

/* Purchase Menu */
    spriteset (ss_e4_series_buy_yellow_livery,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}
    spriteset (ss_e4_series_buy_pink_livery,	        	"src/gfx/dummy/purchase.png")               		{template_purchase(0, 0)}

    alternative_sprites(ss_e4_series_buy_yellow_livery,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/purchase_yellow.png") {template_purchase(0, 0)}
    alternative_sprites(ss_e4_series_buy_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/purchase_pink.png")   {template_purchase(0, 0)}

    switch(FEAT_TRAINS, SELF, sw_e4_series_year_dep_purchase, current_year) {
        0..2014: ss_e4_series_buy_yellow_livery;
        ss_e4_series_buy_pink_livery;
    }

/* EMU Parts */

/* "CAB" */
spriteset(ss_e4_series_cab_yellow_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_cab_rev_yellow_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_cab_pink_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_cab_rev_pink_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

// E4 Series Yellow Strip Livery
alternative_sprites(ss_e4_series_cab_yellow_livery,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_standard(1,1)}
alternative_sprites(ss_e4_series_cab_rev_yellow_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png")  {template_12_reversed(1,41)}		

// E4 Series Pink Strip Livery
alternative_sprites(ss_e4_series_cab_pink_livery,     		    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_standard(1,1)}
alternative_sprites(ss_e4_series_cab_rev_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_reversed(1,41)}

/* COACH */
spriteset(ss_e4_series_coach_yellow_livery,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_coach_reversed_yellow_livery,    		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_coach_pink_livery,             		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_coach_reversed_pink_livery,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

// E4 Series Yellow Strip Livery
alternative_sprites(ss_e4_series_coach_yellow_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_standard(1,121)}
alternative_sprites(ss_e4_series_coach_reversed_yellow_livery,  ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_reversed(1,121)}

// E4 Series Pink Strip Livery
alternative_sprites(ss_e4_series_coach_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_standard(1,121)}
alternative_sprites(ss_e4_series_coach_reversed_pink_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_reversed(1,121)}	

// Coach Panto
spriteset(ss_e4_series_panto_yellow_livery,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_panto_reversed_yellow_livery, 		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_panto_pink_livery,          		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
spriteset(ss_e4_series_panto_reversed_pink_livery, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}

// E4 Series Yellow Strip Livery
alternative_sprites(ss_e4_series_panto_yellow_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_standard(1,81)}
alternative_sprites(ss_e4_series_panto_reversed_yellow_livery,  ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4y.png") {template_12_reversed(1,81)}	

// E4 Series Pink Strip Livery
alternative_sprites(ss_e4_series_panto_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_standard(1,81)}
alternative_sprites(ss_e4_series_panto_reversed_pink_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e4_series/e4p.png") {template_12_reversed(1,81)}	

/* PICK THE LIVERY */

// CAB

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_year_dep_livery, build_year) {
    0..2014: ss_e4_series_cab_yellow_livery;
    2014..9999: ss_e4_series_cab_pink_livery;
    ss_e4_series_cab_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_old_livery, cargo_subtype) {
    1: ss_e4_series_cab_yellow_livery;
    sw_e4_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_new_livery, cargo_subtype) {
    1: ss_e4_series_cab_yellow_livery;
    2: ss_e4_series_cab_pink_livery;
    sw_e4_series_cab_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_cab, current_year) {
    0..2014: sw_e4_series_cab_old_livery;
    sw_e4_series_cab_new_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_rev_year_dep_livery, build_year) {
    0..2014: ss_e4_series_cab_rev_yellow_livery;
    2014..9999: ss_e4_series_cab_rev_pink_livery;
    ss_e4_series_cab_rev_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_rev_old_livery, cargo_subtype) {
    1: ss_e4_series_cab_rev_yellow_livery;
    sw_e4_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_cab_rev_new_livery, cargo_subtype) {
    1: ss_e4_series_cab_rev_yellow_livery;
    2: ss_e4_series_cab_rev_pink_livery;
    sw_e4_series_cab_rev_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_cab_rev, current_year) {
    0..2014: sw_e4_series_cab_rev_old_livery;
    sw_e4_series_cab_rev_new_livery;
}

// Coach

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_year_dep_livery, build_year) {
    0..2014: ss_e4_series_coach_yellow_livery;
    2014..9999: ss_e4_series_coach_pink_livery;
    ss_e4_series_coach_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_old_livery, cargo_subtype) {
    1: ss_e4_series_coach_yellow_livery;
    sw_e4_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_new_livery, cargo_subtype) {
    1: ss_e4_series_coach_yellow_livery;
    2: ss_e4_series_coach_pink_livery;
    sw_e4_series_coach_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_coach, current_year) {
    0..2014: sw_e4_series_coach_old_livery;
    sw_e4_series_coach_new_livery;
}

// Coach Reversed

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_reversed_year_dep_livery, build_year) {
    0..2014: ss_e4_series_coach_reversed_yellow_livery;
    2014..9999: ss_e4_series_coach_reversed_pink_livery;
    ss_e4_series_coach_reversed_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_reversed_old_livery, cargo_subtype) {
    1: ss_e4_series_coach_reversed_yellow_livery;
    sw_e4_series_coach_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_coach_reversed_new_livery, cargo_subtype) {
    1: ss_e4_series_coach_reversed_yellow_livery;
    2: ss_e4_series_coach_reversed_pink_livery;
    sw_e4_series_coach_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_coach_reversed, current_year) {
    0..2014: sw_e4_series_coach_reversed_old_livery;
    sw_e4_series_coach_reversed_new_livery;
}

// Panto

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_year_dep_livery, build_year) {
    0..2014: ss_e4_series_panto_yellow_livery;
    2014..9999: ss_e4_series_panto_pink_livery;
    ss_e4_series_panto_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_old_livery, cargo_subtype) {
    1: ss_e4_series_panto_yellow_livery;
    sw_e4_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_new_livery, cargo_subtype) {
    1: ss_e4_series_panto_yellow_livery;
    2: ss_e4_series_panto_pink_livery;
    sw_e4_series_panto_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_panto, current_year) {
    0..2014: sw_e4_series_panto_old_livery;
    sw_e4_series_panto_new_livery;
}

// Panto Reversed

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_reversed_year_dep_livery, build_year) {
    0..2014: ss_e4_series_panto_reversed_yellow_livery;
    2014..9999: ss_e4_series_panto_reversed_pink_livery;
    ss_e4_series_panto_reversed_yellow_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_reversed_old_livery, cargo_subtype) {
    1: ss_e4_series_panto_reversed_yellow_livery;
    sw_e4_series_panto_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, sw_e4_series_panto_reversed_new_livery, cargo_subtype) {
    1: ss_e4_series_panto_reversed_yellow_livery;
    2: ss_e4_series_panto_reversed_pink_livery;
    sw_e4_series_panto_reversed_year_dep_livery;
}

switch(FEAT_TRAINS, SELF, ss_e4_series_panto_reversed, current_year) {
    0..2014: sw_e4_series_panto_reversed_old_livery;
    sw_e4_series_panto_reversed_new_livery;
}

// Pre 2014 subtype text
switch(FEAT_TRAINS, SELF, sw_e4_series_old_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E4_SERIES_YELLOW); 
       return CB_RESULT_NO_TEXT;
    }

// Post 2014 subtype text
switch(FEAT_TRAINS, SELF, sw_e4_series_new_livery_subtype_text, cargo_subtype) {
    0: return string(LV_YEAR_DEP_LIVERY);
	1: return string(LV_E4_SERIES_YELLOW);
    2: return string(LV_E4_SERIES_PINK);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e4_series_year_dep_subtype_text, current_year) {
    0..2014: sw_e4_series_old_livery_subtype_text;
    sw_e4_series_new_livery_subtype_text;
}

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e4_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e4_series_coach;
	ss_e4_series_panto_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e4_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e4_series_coach;
	ss_e4_series_coach_reversed;
}

switch (FEAT_TRAINS, PARENT, sw_e4_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e4_series_panto;
	ss_e4_series_coach_reversed;
}

/* LENGTH*/

/* Make the Middle long sprite length 8 and the dummy sprites length 2*/
switch (FEAT_TRAINS, SELF, sw_e4_series_length, position_in_consist%3) {
    1: return 8;
    return 2;
}

/* PUT TOGETHER THE EMU*/

/* Select the correct part of the train */
switch (FEAT_TRAINS, SELF, sw_e4_series_graphics, position_in_articulated_veh) {
	// Car 1					
	1:  ss_e4_series_cab; 	            // Car 1									
	4:  sw_e4_series_reverser_C_C;	    // Car 2								
	7:  sw_e4_series_reverser_C_P;      // Car 3
	10: sw_e4_series_reverser_P_C;      // Car 4
    13: sw_e4_series_reverser_C_P;      // Car 5
    16: sw_e4_series_reverser_P_C;      // Car 6
    19: sw_e4_series_reverser_C_C;      // Car 7
	22: ss_e4_series_cab_rev;           // Car 8
	dummy_sprites;
}

/* Assemble an 8-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e4_series_articulated_part, extra_callback_info1) {
	1 .. 23: return series_e4;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_e4_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e4_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 100 capacity per car (same as JapanSet)
    0: return 40;       // Low Capacity
    2: return 60;       // High Capacity
    3: return 70;       // Very High Capacity
    return 50;          // Normal Capacity 
}

item(FEAT_TRAINS, series_e4, 2004) {
	property {
		name: 							string(STR_NAME_E4_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(1997,12,20);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          241 km/h;				// Operational Top Speed
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					// Agreed to Wikipedia
		weight:                         648 tons;					// Agreed to Wikipedia 
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_e4_series_graphics;
		purchase:                       sw_e4_series_year_dep_purchase;
		articulated_part:               sw_e4_series_articulated_part;
		length:                         sw_e4_series_length;
		cargo_capacity:                 sw_e4_series_param_cargo_capacity;
		//colour_mapping:                 sw_cc_blue_white;s
		cargo_subtype_text:             sw_e4_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_e4_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_E4_SERIES);
	}
}

/* End e4 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e5_series_fixed.pnml" 1
/* Begin e5 Series */

/* SPRITES */

/* Purchase Menu */
spriteset (ss_e5_series_purchase_pink_livery,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
spriteset (ss_e5_series_purchase_purple_livery,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}

alternative_sprites(ss_e5_series_purchase_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/purchase.png") {template_purchase(0, 0)}
alternative_sprites(ss_e5_series_purchase_purple_livery,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/purchase.png") {template_purchase(0, 0)}

/* EMU Parts */

/* Cab  */
spriteset(ss_e5_series_cab_pink_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5_series_cab_rev_pink_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5_series_cab_purple_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5_series_cab_rev_purple_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}


// E5 Series Pink Strip Livery
alternative_sprites(ss_e5_series_cab_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png")  {template_12_standard(1,1)}
alternative_sprites(ss_e5_series_cab_rev_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png")  {template_12_reversed(1,41)}			

// E5 Series Purple Strip Livery
alternative_sprites(ss_e5_series_cab_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/e5_series/h5purple.png") {template_12_standard(1,1)}
alternative_sprites(ss_e5_series_cab_rev_purple_livery,    	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,41)}

// Coach
spriteset(ss_e5_series_coach_pink_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5_series_coach_rev_pink_livery,    			"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5_series_coach_purple_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5_series_coach_rev_purple_livery,    			"src/gfx/dummy/empty.png") {template_dummy(0,0)}

// E5 Series Pink Strip Livery
alternative_sprites(ss_e5_series_coach_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_standard(1,121)}
alternative_sprites(ss_e5_series_coach_rev_pink_livery,		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_reversed(1,121)}

// E5 Series Purple Strip Livery
alternative_sprites(ss_e5_series_coach_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_standard(1,121)}
alternative_sprites(ss_e5_series_coach_rev_purple_livery,  	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,121)}	

// Coach Panto
spriteset(ss_e5_series_panto_pink_livery,          			"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
spriteset(ss_e5_series_panto_rev_pink_livery, 				"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
spriteset(ss_e5_series_panto_purple_livery,          		"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
spriteset(ss_e5_series_panto_rev_purple_livery, 		    "src/gfx/dummy/empty.png")     						{template_dummy(0,0)}

// E5 Series pink Strip Livery
alternative_sprites(ss_e5_series_panto_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_standard(1,81)}
alternative_sprites(ss_e5_series_panto_rev_pink_livery, 	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_reversed(1,81)}	

// E5 Series purple Strip Livery
alternative_sprites(ss_e5_series_panto_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_standard(1,81)}
alternative_sprites(ss_e5_series_panto_rev_purple_livery,  	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,81)}	

/* PICK THE LIVERY */

// CAB

switch(FEAT_TRAINS, SELF, sw_e5_series_cab_new_livery, cargo_subtype) {
    1: ss_e5_series_cab_purple_livery;
    ss_e5_series_cab_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5_series_cab, current_year) {
    0..2016: ss_e5_series_cab_pink_livery;
    sw_e5_series_cab_new_livery;
}

// COACH

switch(FEAT_TRAINS, SELF, sw_e5_series_coach_new_livery, cargo_subtype) {
    1: ss_e5_series_coach_purple_livery;
    ss_e5_series_coach_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5_series_coach, current_year) {
    0..2016: ss_e5_series_coach_pink_livery;
    sw_e5_series_coach_new_livery;
}

// Coach Reversed

switch(FEAT_TRAINS, SELF, sw_e5_series_coach_rev_new_livery, cargo_subtype) {
    1: ss_e5_series_coach_rev_purple_livery;
    ss_e5_series_coach_rev_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5_series_coach_rev, current_year) {
    0..2016: ss_e5_series_coach_rev_pink_livery;
    sw_e5_series_coach_rev_new_livery;
}

// Panto

switch(FEAT_TRAINS, SELF, sw_e5_series_panto_new_livery, cargo_subtype) { 
    1: ss_e5_series_panto_purple_livery;
    ss_e5_series_panto_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5_series_panto, current_year) {
    0..2016: ss_e5_series_panto_pink_livery;
    sw_e5_series_panto_new_livery;
}

// PANTO REVERSED

switch(FEAT_TRAINS, SELF, sw_e5_series_panto_rev_new_livery, cargo_subtype) {
    1: ss_e5_series_panto_rev_purple_livery;
    ss_e5_series_panto_rev_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5_series_panto_rev, current_year) {
    0..2016: ss_e5_series_panto_rev_pink_livery;
    sw_e5_series_panto_rev_new_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_e5_series_cab_rev_new_livery, cargo_subtype) {
    1: ss_e5_series_cab_rev_purple_livery;
    ss_e5_series_cab_rev_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5_series_cab_rev, current_year) {
    0..2016: ss_e5_series_cab_rev_pink_livery;
    sw_e5_series_cab_rev_new_livery;
}

// Pre 2016 subtype text
switch(FEAT_TRAINS, SELF, sw_e5_series_old_livery_subtype_text, cargo_subtype) {
	0: return string(LV_E5_SERIES_E5); 
       return CB_RESULT_NO_TEXT;
    }

// Post 2016 subtype text
switch(FEAT_TRAINS, SELF, sw_e5_series_new_livery_subtype_text, cargo_subtype) {
	0: return string(LV_E5_SERIES_E5);
    1: return string(LV_E5_SERIES_H5);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e5_series_year_dep_subtype_text, current_year) {
    0..2016: sw_e5_series_old_livery_subtype_text;
    sw_e5_series_new_livery_subtype_text;
}

/* Switches to set which sprite to show going forwards vs going backwards */

// Coach Car going forwards and a Panto Car going backwards
switch (FEAT_TRAINS, PARENT, sw_e5_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e5_series_coach;
	ss_e5_series_panto_rev;
}

// Coach Car going forwards and a Coach Car going backwards
switch (FEAT_TRAINS, PARENT, sw_e5_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e5_series_coach;
	ss_e5_series_coach_rev;
}

// Panto Car going forwards and a Coach Car going backwards
switch (FEAT_TRAINS, PARENT, sw_e5_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e5_series_panto;
	ss_e5_series_coach_rev;
}

/* LENGTH*/

/* Make the Middle long sprite length 8 and the dummy sprites length 2*/
switch (FEAT_TRAINS, SELF, sw_e5_series_length, position_in_consist%3) {
    1: return 8;
    return 2;
}

/* PUT TOGETHER THE EMU*/

/* Select the correct part of the train */
switch (FEAT_TRAINS, SELF, sw_e5_series_graphics, position_in_articulated_veh) {				
	1:  ss_e5_series_cab; 				// Car 1								
	4:  sw_e5_series_reverser_C_C;		// Car 2									
	7:  sw_e5_series_reverser_P_C;		// Car 3
	10: sw_e5_series_reverser_C_P;		// Car 4
    13: sw_e5_series_reverser_C_C;		// Car 5
    16: sw_e5_series_reverser_C_C;		// Car 6
    19: sw_e5_series_reverser_P_C;		// Car 7
	22: sw_e5_series_reverser_C_P;		// Car 8	
    25: sw_e5_series_reverser_C_C;		// Car 9
	28: ss_e5_series_cab_rev;			// Car 10
	dummy_sprites;
}

/* Assemble an 10-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e5_series_articulated_part, extra_callback_info1) {
	1 .. 29: return series_e5;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_e5_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

item(FEAT_TRAINS, series_e5, 2005) {
	property {
		name: 							string(STR_NAME_E5_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2011,03,05); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          321 km/h;					// Operational Top Speed
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          20380 kW;						// 7.5 tile JapanSet E5
		weight:                         675 tons;					// 45t x 10cars x 1.5longsprite
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_e5_series_graphics;
		purchase:                       ss_e5_series_purchase_pink_livery;
		articulated_part:               sw_e5_series_articulated_part;
		length:                         sw_e5_series_length;
		cargo_capacity:                 50;
		//colour_mapping:                 sw_cc_blue_white;s
		cargo_subtype_text:             sw_e5_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_e5_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_E5_SERIES);
	}
}

/* End e5 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e6_series.pnml" 1
// Begin e6_series

// Purchase Sprites
spriteset (spriteset_e6_series_purchase,	        	"src/gfx/dummy/purchase.png")               		{tmpl_purchase_dh(0, 0)}
alternative_sprites(spriteset_e6_series_purchase,     		
	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     			"src/gfx/e6_series/purchase.png")     	 	{tmpl_purchase_dh_32bpp(0, 0)}
    
// Vehicle Sprites
spriteset(spriteset_e6_series_front_std,                    "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_back_std,                     "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_mid_std,                      "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_mid_panto_std,                "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_back_panto_std,               "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}

spriteset(spriteset_e6_series_rev_front_std,                "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_back_std,                 "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_mid_std,                  "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_mid_panto_std,            "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_rev_back_panto_std,           "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}

spriteset(spriteset_e6_series_revflip_front_std,            "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_back_std,             "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_mid_std,              "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_mid_panto_std,        "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}
spriteset(spriteset_e6_series_revflip_back_panto_std,       "src/gfx/dummy/mucar.png")                  {template_8_standard(1,1)}

alternative_sprites(spriteset_e6_series_front_std,          // Front std
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,1)}
alternative_sprites(spriteset_e6_series_back_std,           // Back rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,41)}
alternative_sprites(spriteset_e6_series_mid_std,            // Coach
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,201)}
alternative_sprites(spriteset_e6_series_mid_panto_std,      // Panto rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,161)}
alternative_sprites(spriteset_e6_series_back_panto_std,     // Back Panto rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,121)}

alternative_sprites(spriteset_e6_series_rev_front_std,      // Back rev 
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,41)}
alternative_sprites(spriteset_e6_series_rev_back_std,       // Front rev
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,1)}
alternative_sprites(spriteset_e6_series_rev_mid_std,        // Coach
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,201)}
alternative_sprites(spriteset_e6_series_rev_mid_panto_std,  // Panto     
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,161)}
alternative_sprites(spriteset_e6_series_rev_back_panto_std, // Front Panto rev     
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1, 81)}

alternative_sprites(spriteset_e6_series_revflip_front_std,  // Back         
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_reversed(1,41)}
alternative_sprites(spriteset_e6_series_revflip_back_std,   // Front    
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1,1)}
alternative_sprites(spriteset_e6_series_revflip_mid_std,    // Coach rev     
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_reversed(1,201)}
alternative_sprites(spriteset_e6_series_revflip_mid_panto_std,     // Panto  
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_reversed(1,161)}
alternative_sprites(spriteset_e6_series_revflip_back_panto_std,    // Front Panto   
    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,                     "src/gfx/e6_series/e6.png")                 {template_8_standard(1, 81)}

/*---END OF SECTION---*/
/*---GFX: Train Reversing Switches---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_front_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_front_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_front_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_front_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_back_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_back_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_back_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_mid_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_mid_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_mid_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_mid_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_rev_back_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_revflip_back_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : spriteset_e6_series_revflip_back_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_front_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_front_livery;
  default : sw_e6_series_gfx_revflip_front_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_back_livery;
  default : sw_e6_series_gfx_revflip_back_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_mid_livery;
  default : sw_e6_series_gfx_revflip_mid_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_mid_panto_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_mid_panto_livery;
  default : sw_e6_series_gfx_revflip_mid_panto_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_panto_flippedcheck, vehicle_is_flipped) {
  1 : sw_e6_series_gfx_rev_back_panto_livery;
  default : sw_e6_series_gfx_revflip_back_panto_livery;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_pantograph_pos_std_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 default : sw_e6_series_gfx_rev_mid_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_pantograph_pos_std_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 4 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 7 : sw_e6_series_gfx_rev_mid_panto_flippedcheck;
 default : sw_e6_series_gfx_rev_mid_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_pantograph_pos_std, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 06, 0x000000FF, 0x41]]){
  0..1 : sw_e6_series_gfx_rev_pantograph_pos_std_sw1;
  default : sw_e6_series_gfx_rev_pantograph_pos_std_sw2;
}
switch(FEAT_TRAINS,SELF, sw_e6_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : sw_e6_series_gfx_rev_pantograph_pos_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_back_pantocheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e6_series_gfx_rev_back_flippedcheck;
 default : sw_e6_series_gfx_rev_back_panto_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e6_series_gfx_rev_front_flippedcheck;
 0 : sw_e6_series_gfx_rev_back_pantocheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e6_series_gfx_rev_back_pantocheck;
 0 : sw_e6_series_gfx_rev_front_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_e6_series_gfx_rev_frontback_aftermucars;
 default : sw_e6_series_gfx_rev_frontback_nomucars;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2006 : sw_e6_series_gfx_rev_frontback_mucarcheck;
 1000 : sw_e6_series_gfx_rev_front_flippedcheck;
 default : sw_e6_series_gfx_rev_back_pantocheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2006 : sw_e6_series_gfx_rev_frontback_sameid;
 1000 : sw_e6_series_gfx_rev_back_pantocheck;
 default : sw_e6_series_gfx_rev_front_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_e6_series_gfx_rev_pantograph_pos;
 2006 : sw_e6_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantograph_pos_std_sw1, position_in_vehid_chain){
 0 : spriteset_e6_series_mid_panto_std;
 default : spriteset_e6_series_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantograph_pos_std_sw2, position_in_vehid_chain%10){
 1 : spriteset_e6_series_mid_panto_std;
 4 : spriteset_e6_series_mid_panto_std;
 7 : spriteset_e6_series_mid_panto_std;
 default : spriteset_e6_series_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantograph_pos_std, num_vehs_in_vehid_chain){
  0..1 : sw_e6_series_gfx_pantograph_pos_std_sw1;
  default : sw_e6_series_gfx_pantograph_pos_std_sw2;
}
/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_pantocheck_std, position_in_vehid_chain){
 0: spriteset_e6_series_back_std;
default: spriteset_e6_series_back_panto_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_frontback_flipcheck_std, vehicle_is_flipped){
 0: spriteset_e6_series_front_std;
 default: sw_e6_series_gfx_pantocheck_std;
}
switch(FEAT_TRAINS, PARENT, sw_e6_series_gfx_frontback_std, vehicle_is_reversed){
 0: sw_e6_series_gfx_frontback_flipcheck_std;
 default: sw_e6_series_gfx_rev_idcheck;
}
/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_e6_series_gfx_mucar_revcheck_mid_std, vehicle_is_reversed){
 0: sw_e6_series_gfx_pantograph_pos_std;
 default: sw_e6_series_gfx_rev_idcheck;
}
/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_mucar,  cargo_subtype) {
0 : sw_e6_series_gfx_mucar_revcheck_mid_std;
}
switch(FEAT_TRAINS, SELF, sw_e6_series_gfx_main,  cargo_subtype) {
0 : sw_e6_series_gfx_frontback_std;
}
/*---END OF SECTION---*/
/*---GFX: Livery Menu Switches---*/
// switch(FEAT_TRAINS, SELF, sw_e6_series_subtypetext_mucar, cargo_subtype) {
//0 : string(emu_e6_series_LV_std);
//}
// switch(FEAT_TRAINS, SELF, sw_e6_series_subtypetext_main, cargo_subtype) {
//0 : string(emu_e6_series_LV_std);
//}
/*---END OF SECTION---*/
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e6_series_attach_vehid, [vehicle_type_id == series_e6 || vehicle_type_id == mu_car]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e6_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 50 capacity per car (same as JapanSet)
    0: return 40;       // Low Capacity
    2: return 60;       // High Capacity
    3: return 70;       // Very High Capacity
    return 50;          // Normal Capacity 
}

// Loading Speed

// Loading Speeds for each parameter level
switch(FEAT_TRAINS, SELF, sw_e6_series_param_loading_speed, param_basecapacity) {
    // Loading Capacity for a 2 door
    0: return 10;       // Low Capacity
    2: return 30;       // High Capacity
    3: return 40;       // Very High Capacity
    return 20;          // Normal Capacity 
}

item(FEAT_TRAINS, series_e6, 2006) {
    property {
        name:                           string(STR_NAME_E6_SERIES);
        introduction_date:              date(2013,03,16);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   24;
        reliability_decay:              23;

        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    17;
        running_cost_factor:            51;

        speed:                          321 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          2000 kW;
        weight:                         42 ton;

        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;

        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);

        tractive_effort_coefficient:    0.3;
        air_drag_coefficient:           0.07;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e6_series_gfx_main;
		    purchase:                       spriteset_e6_series_purchase;
		    additional_text:	              return string(STR_DESC_E6_SERIES);
        //cargo_subtype_text:           sw_e6_series_subtypetext_main;
        can_attach_wagon:			          sw_e6_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car){
        default:                        sw_e6_series_gfx_mucar;
        cargo_capacity:                 sw_e6_series_param_cargo_capacity;
        loading_speed:                  sw_e6_series_param_loading_speed;
        //cargo_subtype_text:           sw_e6_series_subtypetext_mucar;
        power:                          1140;
        weight:                         42;
      }

}

// End e6_series
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e7_series_fixed.pnml" 1
/* Begin e7 Series */

/* CARGO SUBTYPE MENU*/

    // E7 and W7 Series
    switch(FEAT_TRAINS, SELF, sw_e7_series_subtype_text, cargo_subtype) {
        0: return string(LV_E7_SERIES_E7);
	    1: return string(LV_E7_SERIES_W7);
        return CB_RESULT_NO_TEXT;
        }

/* SPRITES */

    // Purchase Menu
    spriteset (ss_e7_series_buy,	        	    "src/gfx/dummy/purchase.png")           {template_purchase(0, 0)}
    alternative_sprites(ss_e7_series_buy,           ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/purchase.png") {template_purchase(0, 0)}

    // "CAB"
    spriteset(ss_e7_series_cab,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e7_series_cab_rev,             	"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e7_series_cab,     	    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_standard(1,1)}
    alternative_sprites(ss_e7_series_cab_rev,       ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_reversed(1,41)}		

    // COACH
    spriteset(ss_e7_series_coach,             		"src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e7_series_coach_rev,    		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e7_series_coach,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_standard(1,121)}
    alternative_sprites(ss_e7_series_coach_rev,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_reversed(1,121)}

    // COACH PANTO
    spriteset(ss_e7_series_panto,          		    "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    spriteset(ss_e7_series_panto_rev, 		        "src/gfx/dummy/empty.png")     			{template_dummy(0,0)}
    alternative_sprites(ss_e7_series_panto,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_standard(1,81)}
    alternative_sprites(ss_e7_series_panto_rev,     ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,     "src/gfx/e7_series/e7_series.png") {template_12_reversed(1,81)}	

/* REVERSERS */

switch (FEAT_TRAINS, PARENT, sw_e7_series_reverser_C_P, vehicle_is_reversed) {
	0: ss_e7_series_coach;
	ss_e7_series_panto_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e7_series_reverser_C_C, vehicle_is_reversed) {
	0: ss_e7_series_coach;
	ss_e7_series_coach_rev;
}

switch (FEAT_TRAINS, PARENT, sw_e7_series_reverser_P_C, vehicle_is_reversed) {
	0: ss_e7_series_panto;
	ss_e7_series_coach_rev;
}

/* LENGTH*/

    // Make the Middle long sprite length 8 and the dummy sprites length 2
    switch (FEAT_TRAINS, SELF, sw_e7_series_length, position_in_consist%3) {
        1: return 8;
        return 2;
    }

/* PUT TOGETHER THE EMU*/

    // 10 Car Set
    switch (FEAT_TRAINS, SELF, sw_e7_series_graphics, position_in_articulated_veh) {					
	    1:  ss_e7_series_cab; 	            // Car 1	Car 12								
	    4:  sw_e7_series_reverser_C_C;	    // Car 2	Car 11	    						
	    7:  sw_e7_series_reverser_P_C;      // Car 3    Car 10
	    10: sw_e7_series_reverser_C_C;      // Car 4    Car 9
        13: sw_e7_series_reverser_C_C;      // Car 5    Car 8
        16: sw_e7_series_reverser_C_P;      // Car 6    Car 7
        19: sw_e7_series_reverser_P_C;      // Car 7    Car 6
	    22: sw_e7_series_reverser_C_C;      // Car 8    Car 5
        25: sw_e7_series_reverser_C_C;      // Car 9    Car 4
        28: sw_e7_series_reverser_C_P;      // Car 10   Car 3
        31: sw_e7_series_reverser_C_C;      // Car 11   Car 2
        34: ss_e7_series_cab_rev;           // Car 12   Car 1
	    dummy_sprites;
    }

/* Assemble an articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e7_series_articulated_part, extra_callback_info1) {
	1 .. 35: return series_e7;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_e7_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

/* CARGO CAPACITY */

    // Passenger Capacities for each parameter level
    switch(FEAT_TRAINS, SELF, sw_e7_series_param_cargo_capacity, param_basecapacity) {
        // Assuming 65 capacity per car if it was 0.5 tile (same as JapanSet)
        0: return 52;       // Low Capacity
        2: return 78;       // High Capacity
        3: return 91;       // Very High Capacity
        return 65;          // Normal Capacity 
    }

    // Scaling factor for each length of consist
    switch(FEAT_TRAINS, SELF, sw_e7_series_cargo_capacity_factor, cargo_subtype) {
        1: return 5;     // Length 10 (7.5 tiles)
        return 4;        // Length 8 (6 tiles)
    }

    switch(FEAT_TRAINS, SELF, sw_e7_series_cargo_capacity, (sw_e7_series_param_cargo_capacity() * sw_e7_series_cargo_capacity_factor() ) / 10 ){return;}

/* WEIGHT */
    switch(FEAT_TRAINS, SELF, sw_e7_series_weight, cargo_subtype) {
        1: return 690;      // Weight of a 7.5 tile long JapanSet E2 Series
        return 552;         // Weight of a 6.0 tile long JapanSet E2 Series
    }

/* POWER */
    switch(FEAT_TRAINS, SELF, sw_e7_series_power, cargo_subtype) {
        1: return 18250; 
        return 14600;    
    }

item(FEAT_TRAINS, series_e7) {
	property {
		name: 							string(STR_NAME_E7_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2014,03,15);
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						// 1.5 times normal for this expensive long-distance train
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		// required to enable new graphics
		speed:                          275 km/h;				// Operational Top Speed
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_ELECTRIC;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		power:                          8050 kW;					
		weight:                         648 tons;					
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_e7_series_graphics;
		purchase:                       ss_e7_series_buy;
		articulated_part:               sw_e7_series_articulated_part;
		length:                         sw_e7_series_length;
        power:                          sw_e7_series_power;
        weight:                         sw_e7_series_weight;
		cargo_capacity:                 sw_e7_series_cargo_capacity;
		cargo_subtype_text:             sw_e7_series_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_e7_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_E7_SERIES);
	}
}

/* End e7 series */
# 1 "JPplusShinkansen.pnml" 4
# 1 "src/trains/e8_series.pnml" 1
// Begin e8_series

/* GFX */

    // Purchase Sprites
        spriteset (spriteset_e8_series_purchase,	        	"src/gfx/dummy/purchase.png") {tmpl_purchase_dh(0, 0)}
        alternative_sprites(spriteset_e8_series_purchase,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/purchase.png") {tmpl_purchase_dh_32bpp(0, 0)}

    // E8 Series
        spriteset(ss_e8_series_cab_original,                    "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_cab_rev_original,                "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_coach_original,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_coach_rev_original,              "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_panto_original,                  "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}
        spriteset(ss_e8_series_panto_rev_original,              "src/gfx/dummy/mucar.png") {template_8_standard(1,1)}

        alternative_sprites(ss_e8_series_cab_original,          ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,1)}
        alternative_sprites(ss_e8_series_cab_rev_original,      ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,41)}
        alternative_sprites(ss_e8_series_coach_original,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,121)}
        alternative_sprites(ss_e8_series_coach_rev_original,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_reversed(1,121)}
        alternative_sprites(ss_e8_series_panto_original,        ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_standard(1,81)}
        alternative_sprites(ss_e8_series_panto_rev_original,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e8_series/e8_series.png") {template_8_reversed(1,81)}

/* LIVERIES */

    // Cab Livery (Yelow Lights)
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_cab_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_cab_original;
    }
    // Cab Reversed Livery (Red lights)
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_cab_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_cab_rev_original;
    }
    // Coach Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_coach_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_coach_original;
    }
    // Coach Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_coach_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_coach_rev_original;
    }
    // Panto Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_panto_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_panto_original;
    }
    // Panto Reversed Livery
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_panto_rev_livery, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
        0 : ss_e8_series_panto_rev_original;

    }

/* COACH and PANTO flipping */

    // Check if Coach is flipped
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_coach_flippedcheck, vehicle_is_flipped) {
        1 : sw_e8_series_gfx_coach_livery;
        default : sw_e8_series_gfx_coach_rev_livery;
    }
    // Check if Panto is flipped
    switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_panto_flippedcheck, vehicle_is_flipped) {
        1 : sw_e8_series_gfx_panto_livery;
    default : sw_e8_series_gfx_panto_rev_livery;
    }

/* PANTOGRAPH CHECKS */

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_pantograph_pos_original_sw1, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]]){
 0 : sw_e8_series_gfx_panto_flippedcheck;
 default : sw_e8_series_gfx_coach_flippedcheck;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_pantograph_pos_original_sw2, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%10]){
 1 : sw_e8_series_gfx_panto_flippedcheck;
 //4 : sw_e8_series_gfx_panto_flippedcheck;
 7 : sw_e8_series_gfx_panto_flippedcheck;
 default : sw_e8_series_gfx_coach_flippedcheck;
}

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_pantograph_pos_original, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 16, 0x000000FF, 0x41]]){
  0..2 : sw_e8_series_gfx_rev_pantograph_pos_original_sw1;
  default : sw_e8_series_gfx_rev_pantograph_pos_original_sw2;
}

switch(FEAT_TRAINS,SELF, sw_e8_series_gfx_rev_pantograph_pos, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xF2]]){
0 : sw_e8_series_gfx_rev_pantograph_pos_original;
}

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_nomucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e8_series_gfx_cab_rev_livery;
 0 : sw_e8_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_aftermucars,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x000000FF, 0x41]%2]){
 1 : sw_e8_series_gfx_cab_livery;
 0 : sw_e8_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_mucarcheck,
[STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F),STORE_TEMP(var[0x61, 0, 0x000000FF, 0x41],0),
STORE_TEMP((position_in_consist_from_end-position_in_consist-1)-LOAD_TEMP(0), 0x10F),
var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_e8_series_gfx_rev_frontback_aftermucars;         // From above switch
 default : sw_e8_series_gfx_rev_frontback_nomucars;         // From above switch
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback_sameid,
[STORE_TEMP(position_in_consist_from_end-position_in_consist+1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2008 : sw_e8_series_gfx_rev_frontback_mucarcheck;
 1000 : sw_e8_series_gfx_cab_rev_livery;
 default : sw_e8_series_gfx_cab_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_frontback,
[STORE_TEMP(position_in_consist_from_end-position_in_consist-1, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 2008 : sw_e8_series_gfx_rev_frontback_sameid;
 1000 : sw_e8_series_gfx_cab_livery;
 default : sw_e8_series_gfx_cab_rev_livery;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_rev_idcheck, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]){
 1000 : sw_e8_series_gfx_rev_pantograph_pos;        
 2008 : sw_e8_series_gfx_rev_frontback;
}
/*---END OF SECTION---*/
/*---GFX: Pantograph Positions---*/
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_pantograph_pos_original_sw1, position_in_vehid_chain){
 0 : ss_e8_series_panto_original;
 default : ss_e8_series_coach_original;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_pantograph_pos_original_sw2, position_in_vehid_chain%10){
 1 : ss_e8_series_panto_original;
 //4 : ss_e8_series_panto_original;
 7 : ss_e8_series_panto_original;
 default : ss_e8_series_coach_original;
}

switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_pantograph_pos_original, num_vehs_in_vehid_chain){
  0..2 : sw_e8_series_gfx_pantograph_pos_original_sw1;
  default : sw_e8_series_gfx_pantograph_pos_original_sw2;
}

/*---END OF SECTION---*/
/*---GFX: Front/Back Cab Car Switches---*/

// Original Set
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_cab_flipcheck_original, vehicle_is_flipped){
 0: ss_e8_series_cab_original;                             // Cab
 default: ss_e8_series_cab_rev_original;                   // Cab Reversed
}
switch(FEAT_TRAINS, PARENT, sw_e8_series_gfx_cab_original, vehicle_is_reversed){
 0: sw_e8_series_gfx_cab_flipcheck_original;               // Above switch
 default: sw_e8_series_gfx_rev_idcheck;             // 
}


/*---END OF SECTION---*/
/*---GFX: Middle Car Switches---*/
switch(FEAT_TRAINS, PARENT, sw_e8_series_gfx_mucar_revcheck_mid_original, vehicle_is_reversed){
 0: sw_e8_series_gfx_pantograph_pos_original;
 default: sw_e8_series_gfx_rev_idcheck;
}

/*---END OF SECTION---*/
/*---GFX: Livery Refitting Switches---*/
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_mucar,  cargo_subtype) {
0 : sw_e8_series_gfx_mucar_revcheck_mid_original;
}
switch(FEAT_TRAINS, SELF, sw_e8_series_gfx_main,  cargo_subtype) {
0 : sw_e8_series_gfx_cab_original;
}
/*---END OF SECTION---*/
/*---GFX: Livery Menu Switches---*/
/*
switch(FEAT_TRAINS, SELF, sw_e8_series_subtypetext_mucar, cargo_subtype) {
0 : string(LV_E8_SERIES_ORIGINAL);
}
switch(FEAT_TRAINS, SELF, sw_e8_series_subtypetext_main, cargo_subtype) {
0 : string(LV_E8_SERIES_ORIGINAL);
}
*/
/*---END OF SECTION---*/
/*---Coupling Switch---*/
switch(FEAT_TRAINS, SELF, sw_e8_series_attach_vehid, [vehicle_type_id == series_e8 || vehicle_type_id == mu_car]) {
 0: return string(MU_UNIQUE);
}
/*---END OF SECTION---*/

// Cargo Capacity

// Passenger Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e8_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 50 capacity per car (same as JapanSet)
    0: return 40;       // Low Capacity
    2: return 60;       // High Capacity
    3: return 70;       // Very High Capacity
    return 50;          // Normal Capacity 
}

// Loading Speed

// Loading Speeds for each parameter level
switch(FEAT_TRAINS, SELF, sw_e8_series_param_loading_speed, param_basecapacity) {
    // Loading Capacity for a 2 door
    0: return 10;       // Low Capacity
    2: return 30;       // High Capacity
    3: return 40;       // Very High Capacity
    return 20;          // Normal Capacity 
}

item(FEAT_TRAINS, series_e8) {
    property {
        name:                           string(STR_NAME_E8_SERIES);
        introduction_date:              date(2024,01,01);
        model_life:                     VEHICLE_NEVER_EXPIRES;
        vehicle_life:                   38;
        reliability_decay:              21;
        cargo_capacity:                 50;
        loading_speed:                  20;
        cost_factor:                    18;
        running_cost_factor:            48;
        speed:                          300 km/h;
        track_type:                     MINI_SHINKANSEN;
        power:                          2000 kW;
        weight:                         42 ton;
        climates_available:             ALL_CLIMATES;
        ai_special_flag:                AI_FLAG_PASSENGER;
        sprite_id:                      SPRITE_ID_NEW_TRAIN;
        misc_flags:                     bitmask(TRAIN_FLAG_MU);
        refittable_cargo_classes:       bitmask(CC_PASSENGERS);
        non_refittable_cargo_classes:   bitmask();
        refit_cost:                     0;
        dual_headed:                    1;
        ai_engine_rank:                 0;
        running_cost_base:              RUNNING_COST_ELECTRIC;
        engine_class:                   ENGINE_CLASS_ELECTRIC;
        visual_effect_and_powered:      visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 4, ENABLE_WAGON_POWER);
        tractive_effort_coefficient:    0.2;
        air_drag_coefficient:           0.07;
        bitmask_vehicle_info:           0;
        length:                         8;
    }
    /*Graphics and Callbacks*/
      graphics {
        default:                        sw_e8_series_gfx_main;
	    purchase:                       spriteset_e8_series_purchase;
		additional_text:	            return string(STR_DESC_E8_SERIES);
        //cargo_subtype_text:             sw_e8_series_subtypetext_main;
        can_attach_wagon:			    sw_e8_series_attach_vehid;
        //start_stop:                   ;
    }
    /*Multiple Unit Car*/
      livery_override(mu_car){
        default:                        sw_e8_series_gfx_mucar;
        cargo_capacity:                 sw_e8_series_param_cargo_capacity;
        loading_speed:                  sw_e8_series_param_loading_speed;
        //cargo_subtype_text:             sw_e8_series_subtypetext_mucar;
        power:                          400/2;
        weight:                         30;
      }

}

// End e8_series
# 1 "JPplusShinkansen.pnml" 4

# 1 "src/trains/e5e6_series_fixed.pnml" 1
/* Begin e5&e6 Series */

/* CARGO SUBTYPE MENU*/

// From 2013 to 2015 - launch of E6 Series (E5 already launched)
switch(FEAT_TRAINS, SELF, sw_e5e6_series_2013_subtype_text, cargo_subtype) {
	0: return string(LV_E5E6_SERIES_PINK);     
       return CB_RESULT_NO_TEXT;
    }

// From 2016 onwards - launch of H5
switch(FEAT_TRAINS, SELF, sw_e5e6_series_2016_subtype_text, cargo_subtype) {
	0: return string(LV_E5E6_SERIES_PINK);   
    1: return string(LV_E5E6_SERIES_PURPLE);
       return CB_RESULT_NO_TEXT;
    }

switch(FEAT_TRAINS, SELF, sw_e5e6_series_year_dep_subtype_text, current_year) {
    0..2015: sw_e5e6_series_2013_subtype_text;
    sw_e5e6_series_2016_subtype_text;
}

/* SPRITES */

/* Purchase Menu */
spriteset (ss_e5e6_series_purchase,	        	"src/gfx/dummy/purchase.png") {template_purchase(0, 0)}
alternative_sprites(ss_e5e6_series_purchase,    ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/buy_e5e6.png") {template_purchase(0, 0)}

/* EMU Parts */

/* Cab  */
spriteset(ss_e5e6_series_e5_cab_pink_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_cab_rev_pink_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_cab_purple_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_cab_rev_purple_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}


// E5 Series Pink Strip Livery
alternative_sprites(ss_e5e6_series_e5_cab_pink_livery,     		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png")  {template_12_standard(1,1)}
alternative_sprites(ss_e5e6_series_e5_cab_rev_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png")  {template_12_reversed(1,41)}			

// E5 Series Purple Strip Livery
alternative_sprites(ss_e5e6_series_e5_cab_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/e5_series/h5purple.png") {template_12_standard(1,1)}
alternative_sprites(ss_e5e6_series_e5_cab_rev_purple_livery,    	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP,  "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,41)}

// Coach
spriteset(ss_e5e6_series_e5_coach_pink_livery,             		"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_coach_rev_pink_livery,    			"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_coach_purple_livery,             	"src/gfx/dummy/empty.png") {template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_coach_rev_purple_livery,    		"src/gfx/dummy/empty.png") {template_dummy(0,0)}

// E5 Series Pink Strip Livery
alternative_sprites(ss_e5e6_series_e5_coach_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_standard(1,121)}
alternative_sprites(ss_e5e6_series_e5_coach_rev_pink_livery,		ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_reversed(1,121)}

// E5 Series Purple Strip Livery
alternative_sprites(ss_e5e6_series_e5_coach_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_standard(1,121)}
alternative_sprites(ss_e5e6_series_e5_coach_rev_purple_livery,  	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,121)}	

// Coach Panto
spriteset(ss_e5e6_series_e5_panto_pink_livery,          			"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_panto_rev_pink_livery, 				"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_panto_purple_livery,          		"src/gfx/dummy/empty.png")     						{template_dummy(0,0)}
spriteset(ss_e5e6_series_e5_panto_rev_purple_livery, 		    "src/gfx/dummy/empty.png")     						{template_dummy(0,0)}

// E5 Series pink Strip Livery
alternative_sprites(ss_e5e6_series_e5_panto_pink_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_standard(1,81)}
alternative_sprites(ss_e5e6_series_e5_panto_rev_pink_livery, 	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/e5pink.png") {template_12_reversed(1,81)}	

// E5 Series purple Strip Livery
alternative_sprites(ss_e5e6_series_e5_panto_purple_livery,     	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_standard(1,81)}
alternative_sprites(ss_e5e6_series_e5_panto_rev_purple_livery,  	ZOOM_LEVEL_NORMAL, BIT_DEPTH_32BPP, "src/gfx/e5_series/h5purple.png") {template_12_reversed(1,81)}	


/* PICK THE LIVERY */

// CAB

switch(FEAT_TRAINS, SELF, sw_e5e6_series_e5_cab_new_livery, cargo_subtype) {
    1: ss_e5e6_series_e5_cab_purple_livery;
    ss_e5e6_series_e5_cab_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5e6_series_e5_cab, current_year) {
    0..2016: ss_e5e6_series_e5_cab_pink_livery;
    sw_e5e6_series_e5_cab_new_livery;
}

// COACH

switch(FEAT_TRAINS, SELF, sw_e5e6_series_e5_coach_new_livery, cargo_subtype) {
    1: ss_e5e6_series_e5_coach_purple_livery;
    ss_e5e6_series_e5_coach_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5e6_series_e5_coach, current_year) {
    0..2016: ss_e5e6_series_e5_coach_pink_livery;
    sw_e5e6_series_e5_coach_new_livery;
}

// Coach Reversed

switch(FEAT_TRAINS, SELF, sw_e5e6_series_e5_coach_rev_new_livery, cargo_subtype) {
    1: ss_e5e6_series_e5_coach_rev_purple_livery;
    ss_e5e6_series_e5_coach_rev_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5e6_series_e5_coach_rev, current_year) {
    0..2016: ss_e5e6_series_e5_coach_rev_pink_livery;
    sw_e5e6_series_e5_coach_rev_new_livery;
}

// Panto

switch(FEAT_TRAINS, SELF, sw_e5e6_series_e5_panto_new_livery, cargo_subtype) { 
    1: ss_e5e6_series_e5_panto_purple_livery;
    ss_e5e6_series_e5_panto_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5e6_series_e5_panto, current_year) {
    0..2016: ss_e5e6_series_e5_panto_pink_livery;
    sw_e5e6_series_e5_panto_new_livery;
}

// PANTO REVERSED

switch(FEAT_TRAINS, SELF, sw_e5e6_series_e5_panto_rev_new_livery, cargo_subtype) {
    1: ss_e5e6_series_e5_panto_rev_purple_livery;
    ss_e5e6_series_e5_panto_rev_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5e6_series_e5_panto_rev, current_year) {
    0..2016: ss_e5e6_series_e5_panto_rev_pink_livery;
    sw_e5e6_series_e5_panto_rev_new_livery;
}

// CAB REVERSED

switch(FEAT_TRAINS, SELF, sw_e5e6_series_e5_cab_rev_new_livery, cargo_subtype) {
    1: ss_e5e6_series_e5_cab_rev_purple_livery;
    ss_e5e6_series_e5_cab_rev_pink_livery;
}

switch(FEAT_TRAINS, SELF, ss_e5e6_series_e5_cab_rev, current_year) {
    0..2016: ss_e5e6_series_e5_cab_rev_pink_livery;
    sw_e5e6_series_e5_cab_rev_new_livery;
}

/* PUT TOGETHER THE EMU */

/* Select the correct part of the train */

switch (FEAT_TRAINS, SELF, sw_e5e6_series_graphics_forwards, position_in_consist) {
					
	1:  ss_e5e6_series_e5_cab; 		        				// Car 1							
	7:  ss_e5e6_series_e5_coach;		        				// Car 2    							
	13: ss_e5e6_series_e5_panto;                				// Car 3
	19: ss_e5e6_series_e5_coach;                				// Car 4
    25: ss_e5e6_series_e5_coach;                				// Car 5
    31: ss_e5e6_series_e5_coach;                				// Car 6
    37: ss_e5e6_series_e5_panto;                				// Car 7
	43: ss_e5e6_series_e5_coach;                				// Car 8
    49: ss_e5e6_series_e5_coach;                				// Car 9
	55: ss_e5e6_series_e5_cab_rev;                    		// Car 10
    60: spriteset_e6_series_front_std;          		// Car 11
    64: spriteset_e6_series_rev_mid_panto_std;  		// Car 12
    68: spriteset_e6_series_rev_mid_std;				// Car 13
    72: spriteset_e6_series_rev_mid_std;				// Car 14
    76: spriteset_e6_series_rev_mid_std;				// Car 15
    80: spriteset_e6_series_rev_mid_panto_std;			// Car 16
    84: spriteset_e6_series_revflip_front_std;			// Car 17
	dummy_sprites;
}

switch (FEAT_TRAINS, SELF, sw_e5e6_series_graphics_backwards, position_in_consist) {
					
	0:  spriteset_e6_series_front_std; 					// Car 17							
	4:  spriteset_e6_series_revflip_mid_panto_std;		// Car 16   							
	8:  spriteset_e6_series_revflip_mid_std;     		// Car 15
	12: spriteset_e6_series_revflip_mid_std;    		// Car 14
    16: spriteset_e6_series_revflip_mid_std;    		// Car 13
    20: spriteset_e6_series_revflip_mid_panto_std;      // Car 12
    24: spriteset_e6_series_revflip_front_std;     		// Car 11
	29: ss_e5e6_series_e5_cab;                 				// Car 10
    35: ss_e5e6_series_e5_coach_rev;       					// Car 9
	41: ss_e5e6_series_e5_coach_rev;       					// Car 8
    47: ss_e5e6_series_e5_panto_rev;       					// Car 7
    53: ss_e5e6_series_e5_coach_rev;       					// Car 6
    59: ss_e5e6_series_e5_coach_rev;       					// Car 5
    65: ss_e5e6_series_e5_coach_rev;       					// Car 4
    71: ss_e5e6_series_e5_panto_rev;       					// Car 3
    77: ss_e5e6_series_e5_coach_rev;       					// Car 2
    83: ss_e5e6_series_e5_cab_rev;                 			// Car 1
	dummy_sprites;
}

switch (FEAT_TRAINS, PARENT, sw_e5e6_series_graphics, vehicle_is_reversed) {				
	1:  sw_e5e6_series_graphics_backwards; 		            							
	sw_e5e6_series_graphics_forwards;
}

/* Assemble an 17-car articulated vehicle. */
switch (FEAT_TRAINS, SELF, sw_e5e6_series_articulated_part, extra_callback_info1) {
	1 .. 87: return series_e5e6;										// Should be same as range above
	return CB_RESULT_NO_MORE_ARTICULATED_PARTS;
}

switch (FEAT_TRAINS, SELF, sw_e5e6_series_visual_effect_and_powered, ((position_in_articulated_veh == 0) && !func_is_reversed()) || ((position_in_articulated_veh_from_end == 0) && func_is_reversed()) ) {
	1: return visual_effect_and_powered(VISUAL_EFFECT_ELECTRIC, 0, ENABLE_WAGON_POWER);
	return visual_effect_and_powered(VISUAL_EFFECT_DISABLE, 0, DISABLE_WAGON_POWER);
}

// Cargo Capacity

// Base Capacities for each parameter level
switch(FEAT_TRAINS, SELF, sw_e5e6_series_param_cargo_capacity, param_basecapacity) {
    // Assuming 65 capacity per 0.5 tile 
    0: return 52;       // Low Capacity
    2: return 78;       // High Capacity
    3: return 91;       // Very High Capacity
    return 65;          // Normal Capacity 
}

/* Base Capacity x 27 / 100 x 88 = Total Passenger Capacity

 * 27/100 is what adjusts the capacities to give a capacity in line with JapanSet 3
 * 27 was chosen so that 65 x 27 / 100 > 16.25 which is the factor that matches 1430 (the capacity of an 11.0 tile JapanSet E5 Series Shinkansen)
 * 88 is the number of sprites in a joint E5 and E6 Series Shinkansen*/

switch(FEAT_TRAINS, SELF, sw_e5e6_series_cargo_capacity, (sw_e5e6_series_param_cargo_capacity() * 27 ) / 100 )
    {return;}



item(FEAT_TRAINS, series_e5e6) {
	property {
		name: 							string(STR_NAME_E5E6_SERIES);
		climates_available:             ALL_CLIMATES;
		introduction_date:              date(2013,03,16); 
		model_life:                     VEHICLE_NEVER_EXPIRES;		//
		vehicle_life:                   30;							// 
		reliability_decay:              5;
		refittable_cargo_classes:       bitmask(CC_PASSENGERS);
		refit_cost:                     0;
		default_cargo_type:             PASS;
		cargo_capacity:                 1;							// 
		loading_speed:                  50;							
		cargo_age_period:               278; 						
		sprite_id:                      SPRITE_ID_NEW_TRAIN; 		
		speed:                          321 km/h;				
		misc_flags:                     bitmask(TRAIN_FLAG_2CC, TRAIN_FLAG_MU, TRAIN_FLAG_TILT, TRAIN_FLAG_AUTOREFIT, TRAIN_FLAG_SPRITE_STACK);
		track_type:                     SHINKANSEN;
		ai_special_flag:                AI_FLAG_PASSENGER;
		running_cost_base:              RUNNING_COST_STEAM;
		engine_class:                   ENGINE_CLASS_ELECTRIC;
		length:							2;
		power:                          20380 kW;					// Agreed to Wikipedia
		weight:                         302 tons;					// Agreed to Wikipedia 
		tractive_effort_coefficient:    0.3;

	}
	graphics {
		default:                        sw_e5e6_series_graphics;
		purchase:                       ss_e5e6_series_purchase;
		articulated_part:               sw_e5e6_series_articulated_part;
		//length:                         2;
		cargo_capacity:                 sw_e5e6_series_cargo_capacity;
		cargo_subtype_text:             sw_e5e6_series_year_dep_subtype_text;
		cost_factor:                    257;
		running_cost_factor:            func_running_costs(300);
		purchase_running_cost_factor:   300;
		visual_effect_and_powered:      sw_e5e6_series_visual_effect_and_powered;
		additional_text:                string(STR_DESC_E5E6_SERIES);
	}
}

/* End e5&e6 Series */
# 1 "JPplusShinkansen.pnml" 4
